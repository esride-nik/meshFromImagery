import{nG as ne,nH as oe,a5 as s,a6 as o,a9 as k,bA as X,cc as Q,h3 as F,cb as c,cd as le,dr as D,nI as ae,nJ as M,nK as re,kg as W,gk as Y,cf as de,ao as he,an as Z,ce as pe,_ as S}from"./index-b516d057.js";import{i as ge,I as me,n as m,e as G,O as ce,X as ue,r as ye}from"./jsxFactory-92036771.js";import{a2 as _e,a3 as j,a4 as we}from"./SceneView-123ac862.js";import{c as fe}from"./earthUtils-ef4b5643.js";import{l as ve,L as be}from"./Slider-50915901.js";import{t as ee,C as Se}from"./DatePicker-ccc9fd8a.js";import{f as q,l as Te,d as De}from"./TimezonePicker-3b109513.js";import{e as T}from"./globalCss-94006b67.js";import{e as Pe}from"./Heading-92f210ca.js";import"./uuid-709b6c67.js";import"./Viewpoint-f83262d0.js";import"./Cyclical-4c223a04.js";import"./HeightModelInfo-b816d32b.js";import"./ElevationQuery-a3eaf0a0.js";import"./RenderGeometry-5dbc1699.js";import"./vec3f32-bac7ea57.js";import"./DefaultTechniqueConfiguration-b4dbe32f.js";import"./requestImageUtils-b142708c.js";import"./enums-bdecffa2.js";import"./Texture-bcb6d63f.js";import"./contextUtils-81fda295.js";import"./interfaces-8918b36f.js";import"./Material-5f4156ac.js";import"./ViewingMode-5d7d590b.js";import"./FramebufferObject-123b7c8d.js";import"./ShaderTechniqueConfiguration-2502462e.js";import"./ElevationProvider-abb53936.js";import"./dehydratedPoint-5a1dfed5.js";import"./hydratedFeatures-2365c307.js";import"./weather-2eb64924.js";import"./RenderState-1d6218ee.js";import"./NestedMap-1b5db22e.js";import"./frustum-f9d53cdf.js";import"./VertexElementDescriptor-2925c6af.js";import"./VertexArrayObject-d19dab8d.js";import"./Octree-7cea9440.js";import"./InterleavedLayout-d76b0d59.js";import"./types-1305598a.js";import"./OrderIndependentTransparency-755f7dcc.js";import"./floatRGBA-ca990bbb.js";import"./Intersector-2e1d9db3.js";import"./Intersector-fa865806.js";import"./boundedPlane-1da2f094.js";import"./verticalOffsetUtils-e5214af9.js";import"./orientedBoundingBox-67c5cd22.js";import"./glUtil-ce5ee52b.js";import"./Scheduler-ff5943a4.js";import"./signal-51ed66f5.js";import"./debugFlags-9a30f077.js";import"./vec2f32-eaf29605.js";import"./ColorMaterial-bdf1f62a.js";import"./VerticalOffset.glsl-5743f98e.js";import"./dehydratedFeatures-2a3f0608.js";import"./quantizationUtils-17105106.js";import"./featureConversionUtils-09cf00ff.js";import"./OptimizedFeature-e90b69df.js";import"./OptimizedFeatureSet-1d1ac4b9.js";import"./OptimizedGeometry-196224d4.js";import"./edgeUtils-6e4a97fb.js";import"./SnappingCandidate-970faec6.js";import"./objectResourceUtils-003803db.js";import"./devEnvironmentUtils-4eab2a99.js";import"./DefaultMaterial_COLOR_GAMMA-101ea40c.js";import"./Version-1f969b2a.js";import"./resourceUtils-1d03d2fe.js";import"./mat3f32-6c416b1c.js";import"./symbolColorUtils-3ca646c8.js";import"./callExpressionWithFeature-36423058.js";import"./lineStippleUtils-0688e06c.js";import"./projectVectorToDehydratedPoint-e30a7ff8.js";import"./interfaces-1a80c8eb.js";import"./webStyleSymbolUtils-4761c8f2.js";import"./Intersector-a291e778.js";import"./fontUtils-56b88a2f.js";import"./projectVectorToVector-56c29b20.js";import"./coordinateSystem-38339d17.js";import"./scaleUtils-72744379.js";import"./LayerConstants-d3ac1b7a.js";import"./DefaultUI-af7068c2.js";import"./UpdatingHandles-7949a657.js";import"./screenUtils-8dc4a7f9.js";import"./Map-1ad4186f.js";import"./Basemap-8d62c69e.js";import"./loadAll-5e767cfa.js";import"./writeUtils-e226a8aa.js";import"./Ground-ed93a93a.js";import"./CollectionFlattener-193451da.js";import"./editableLayers-856f2cb4.js";import"./basemapUtils-6ec10a55.js";import"./TablesMixin-292d1d89.js";import"./IViewEvents-9a85f53d.js";import"./interfaces-0421c5e6.js";import"./heightModelInfoUtils-0dd2b6e4.js";import"./mat2d-d4af8487.js";import"./mat2df32-fb26a8c9.js";import"./mat2df64-4d1a9198.js";import"./capabilities-9d56a1da.js";import"./themeUtils-7dcf5b71.js";import"./accessibleHandler-e91101b2.js";import"./Compass-b37d7d1d.js";import"./GoTo-4d856ce0.js";import"./NavigationToggle-57c00adb.js";import"./Zoom-73b5f25a.js";import"./resources-d4afed0c.js";import"./viewpointUtils-245ed782.js";import"./projectPointToVectorWithEngine-f608a34a.js";import"./projectVectorToPoint-fbaf5599.js";import"./spatialReferenceSupport-5aeb751c.js";import"./ElevationSamplerData-9f34f589.js";import"./terrainUtils-b6b761ab.js";import"./Environment-91bfea7d.js";import"./projectPointToWGS84ComparableLonLat-1ba40d40.js";import"./projectVectorToWGS84ComparableLonLat-5675a9f4.js";import"./ShadowCastVisualizeTechniqueConfiguration-4fcc4e25.js";import"./ray-8da55042.js";import"./ZoomMomentumEstimator-7437d26a.js";import"./labelFormatUtils-d440367f.js";import"./labelUtils-b29175f3.js";import"./FeatureTileDescriptor3D-27dbeac7.js";import"./geometryServiceUtils-3e048225.js";import"./project-1bd91657.js";import"./RenderCoordsHelper-8f237859.js";import"./intersectorUtilsConversions-d05d75a3.js";import"./LercDecoder-b49c0e9c.js";import"./WorkerHandle-9433ab9a.js";import"./RenderableTile-52f61d09.js";import"./enums-fb086c25.js";import"./config-1337d16e.js";import"./TiledDisplayObject-e7d105ae.js";import"./DisplayObject-9a6e3923.js";import"./TileKey-4b1303ff.js";import"./rasterUtils-15abcc11.js";import"./TileInfoView-ce4d65fb.js";import"./TileStrategy-a729431f.js";import"./QueueProcessor-4b9d43d3.js";import"./StyleDefinition-29c49b98.js";import"./enums-f1a6a48a.js";import"./edgeProcessing-82213448.js";import"./resources-15104e7a.js";import"./EdgeWorkerHandle-7d97defa.js";import"./workerHelper-d1cc0cda.js";import"./testSVGPremultipliedAlpha-f5e92e14.js";import"./DefaultVertexAttributeLayouts-8962d8eb.js";import"./RenderingContext-c0ea7a49.js";import"./ProgramCache-891c4b8d.js";import"./Program-96bc94ed.js";import"./hitTestSelectUtils-d512707e.js";import"./layerViewUtils-6ebe90f4.js";import"./Popover-ca6b0b13.js";const y="esri-daylight",V=`${y}__container`,v="esri-slider",g={base:y,widgetIcon:ge.environmentSettings,datePickerCalendarToggle:"esri-date-picker__calendar-toggle",dayContainer:`${V} ${y}__day-container`,dateContainer:`${V} ${y}__date-container`,containerDisabled:`${V}--disabled`,slider:v,sliderShadowOff:`${v}--shadow-off`,sliderShadowOn:`${v}--shadow-on`,sliderAmPmOn:`${v}--ampm-on`,sliderDateOff:`${v}--date-off`,sliderDateOn:`${v}--date-on`,playPauseButton:`${y}__play-pause-button`,seasonPicker:`${y}__season-picker`,panelError:`${y}__panel--error`,sunLightingCheckbox:`${y}__sun-lighting-checkbox`,shadowsCheckbox:`${y}__shadows-checkbox`};var u;(function(e){e[e.NORTHERN=0]="NORTHERN",e[e.SOUTHERN=1]="SOUTHERN"})(u||(u={}));const ke={spring:{dayOfMonth:20,month:2},summer:{dayOfMonth:21,month:5},fall:{dayOfMonth:23,month:8},winter:{dayOfMonth:21,month:11}},I=["spring","summer","fall","winter"];function P(e,t,i){const n=B(t,i),{dayOfMonth:l,month:r}=ke[n],d=new Date(e.getTime());return d.setMonth(r,l),d}function Oe(e,t){return B(Ce(e),t)}function Ce(e){const t=e.getTime(),i=P(e,"spring",u.NORTHERN).getTime(),n=P(e,"summer",u.NORTHERN).getTime(),l=P(e,"fall",u.NORTHERN).getTime(),r=P(e,"winter",u.NORTHERN).getTime();return t>=i&&t<n?"spring":t>=n&&t<l?"summer":t>=l&&t<r?"fall":"winter"}function B(e,t){return t===u.NORTHERN?e:Le(e)}function Le(e){const t=I.indexOf(e);return I[(t+2)%4]}function Me(e,t){return ne(e,t,"minutes")}function Ee(e){return oe(e,"minutes")}function $e(e,t,i){if(e==null||t==null||isNaN(e.getTime())&&isNaN(t.getTime()))return 3e5;const p=i.getTime(),E=e.getTime(),$=t.getTime(),U=E-72e5/2,N=E+72e5/2,x=$-72e5/3*2,H=$+72e5/3;let O=3e5;return p>=U&&p<=N?O=p-U<=12e5?18e5-(p-U)/12e5*(18e5-2e5):N-p<=12e5/2?3e5-(N-p)/12e5*2*(3e5-2e5):2e5:p>=x&&p<=H?O=p-x<=12e5/2?3e5-(p-x)/12e5*2*(3e5-2e5):H-p<=12e5?18e5-(H-p)/12e5*(18e5-2e5):2e5:(p<E||p>$)&&(O=18e5),O}let f=class extends ve{constructor(){super(...arguments),this.utcOffset=null,this.timezonePickerOpen=!1}};s([o()],f.prototype,"utcOffset",void 0),s([o()],f.prototype,"timezonePickerOpen",void 0),f=s([k("esri.widgets.Daylight.support.SliderWithDropdownViewModel")],f);const te="esri.widgets.Daylight.DaylightViewModel";let a=class extends X{constructor(e){super(e),this.view=null,this.datePickerViewModel=new ee,this.timeSliderViewModel=new f({min:0,max:1439,values:[0],labelFormatFunction:q,inputFormatFunction:q}),this.lightingUpdateInterval=200,this._oldLighting=null,this.playSpeedMultiplier=1,this._lastTime=null,this._sunrise=null,this._sunset=null,this._cachedLightingDateUTC=new Date(0),this._cachedDisplayUTCOffset=0,this._firstInteraction=!0,this._lastLightingUpdate=0,this._lightingUpdateHandle=null}initialize(){this.addHandles([Q(()=>this.view,e=>e.when(()=>this._updateLighting()),F),c(()=>{const e=this._lighting;return(e==null?void 0:e.type)==="sun"?C(e):null},e=>this._scheduleLightingUpdate(e)),le(()=>this._lighting,"timezone-will-change",e=>this._timezoneWillChange(e),{onListenerAdd:()=>this._timezoneWillChange(null)}),c(()=>{var e;return((e=this.view)==null?void 0:e.stationary)===!0},()=>{(this.dayPlaying||this.yearPlaying)&&this._updateSunriseAndSunset()},F),c(()=>{const e=this.timeSliderViewModel;return{vm:e,state:e.state,sliderPosition:this.timeSliderPosition}},({vm:e,state:t,sliderPosition:i})=>{t==="ready"&&e.setValue(0,i)}),c(()=>{var e;return(e=this.timeSliderViewModel)==null?void 0:e.utcOffset},e=>{e!=null&&(this.utcOffset=e)}),c(()=>({utcOffset:this.utcOffset,sliderViewModel:this.timeSliderViewModel}),({utcOffset:e,sliderViewModel:t})=>{t&&(t.utcOffset=e)},D),c(()=>this.timeSliderViewModel.timezonePickerOpen,()=>this.stopPlaying()),c(()=>this.timeSliderViewModel.values,e=>this._setTimeSliderPosition((e==null?void 0:e[0])??0,{forceLightingUpdate:!1})),c(()=>this.datePickerViewModel.value,e=>{this.dayPlaying=!1,this.localDate=e}),c(()=>this.localDate,e=>{this.datePickerViewModel.value.valueOf()!==e.getTime()&&this.datePickerViewModel.set("value",e)})])}destroy(){this._cancelLightingUpdate(),this.view=null}get isSupported(){return this.view==null||this.view.type==="3d"}get utcOffset(){return this._cachedDisplayUTCOffset}set utcOffset(e){e!==this.utcOffset&&this._lighting!=null&&this._lighting.type!=="virtual"&&(this._lighting.displayUTCOffset=e,this._updateLighting())}get localDate(){return ae(this._lightingDateDisplay)}set localDate(e){M(e)&&e.getTime()!==this.localDate.getTime()&&(this._lightingDateDisplay=re(this._lightingDateDisplay,e))}get timeSliderPosition(){return Ee(this._lightingDateDisplay)}set timeSliderPosition(e){this._setTimeSliderPosition(e,{forceLightingUpdate:!0})}_setTimeSliderPosition(e,t){Math.abs(e-this.timeSliderPosition)<=1/60||(this.stopPlaying(),this._enableDirectShadowsIfFirstInteraction(),t.forceLightingUpdate&&(this._cancelLightingUpdate(),this._updateLighting()),this._lightingDateDisplay=Me(this._lightingDateDisplay,e))}_timezoneFromCamera(e,t){if(t==null||!e.cameraTrackingEnabled)return 0;const i=fe([t.longitude,t.latitude]);return i==null?0:Math.round(i.hours+i.minutes/60+i.seconds/3600)}get directShadowsEnabled(){var e;return((e=this._lighting)==null?void 0:e.directShadowsEnabled)??!1}set directShadowsEnabled(e){const t=this._lighting;t&&(t.directShadowsEnabled=e)}get sunLightingEnabled(){return this._lightingType==="sun"}set sunLightingEnabled(e){const t=this._environment;if(e===this._get("sunLightingEnabled")||t==null)return;const i=t.lighting,n=this._oldLighting;this._oldLighting=i;const l={directShadowsEnabled:i.directShadowsEnabled,cameraTrackingEnabled:i.cameraTrackingEnabled},r=e?"sun":"virtual";let d;d=n!=null&&n.type===r?n:e?new j:new we,d.set(l),t.lighting=d,e||(this.stopPlaying(),this.timeSliderViewModel.timezonePickerOpen=!1)}set playingState(e){this.playingState!==e&&(this._set("playingState",e),e!=="none"&&this.sunLightingEnabled&&(this._updateSunriseAndSunset(),this._lastTime=Date.now(),this._play(),this._enableDirectShadowsIfFirstInteraction()))}get dayPlaying(){return this.playingState==="day"}set dayPlaying(e){e?this.playingState="day":this.dayPlaying&&(this.playingState="none")}get yearPlaying(){return this.playingState==="year"}set yearPlaying(e){e?this.playingState="year":this.yearPlaying&&(this.playingState="none")}get currentSeason(){return Oe(this.localDate,this._currentHemisphere)}set currentSeason(e){this.stopPlaying();const t=B(e,this._currentHemisphere);this.localDate=P(this.localDate,t,u.NORTHERN)}get _currentHemisphere(){var t,i,n;const e=(n=(i=(t=this.view)==null?void 0:t.camera)==null?void 0:i.position)==null?void 0:n.latitude;return e==null||e>=0?u.NORTHERN:u.SOUTHERN}get _environment(){var e;return(e=this.view)==null?void 0:e.environment}get _lighting(){var e;return(e=this._environment)==null?void 0:e.lighting}get _lightingType(){var e;return(e=this._lighting)==null?void 0:e.type}get _lightingDateDisplay(){return W(this._cachedLightingDateUTC,this._cachedDisplayUTCOffset,"hours")}set _lightingDateDisplay(e){const t=this._lighting;if(t==null||!this.sunLightingEnabled||t.type==="virtual"||!M(e))return;const i=C(t),n=W(e,-this._cachedDisplayUTCOffset,"hours");n.getTime()!==i.getTime()&&(t.date=n,this._updateLighting())}stopPlaying(){this.playingState="none"}toggleDayPlaying(){this.dayPlaying=!this.dayPlaying}toggleYearPlaying(){this.yearPlaying=!this.yearPlaying}toggleSunLightingEnabled(){this.stopPlaying(),this.sunLightingEnabled=!this.sunLightingEnabled}toggleDirectShadowsEnabled(){this.stopPlaying(),this.directShadowsEnabled=!this.directShadowsEnabled}_enableDirectShadowsIfFirstInteraction(){this._firstInteraction&&(this._firstInteraction=!1,this.directShadowsEnabled=!0)}_updateLighting(e){var d;const t=Date.now();this._lastLightingUpdate=t;const{view:i}=this,n=this._lighting;if(i==null||n==null||n.type==="virtual")return;e??(e=C(n));const l=n.displayUTCOffset,r=l!==null?l:this._timezoneFromCamera(n,(d=i.camera)==null?void 0:d.position);this._cachedLightingDateUTC.getTime()!==e.getTime()&&(this._cachedLightingDateUTC=new Date(e.getTime())),this._cachedDisplayUTCOffset!==r&&(this._cachedDisplayUTCOffset=r)}_timezoneWillChange(e){const t=this._lighting;if(t==null||t.type==="virtual"||!t.cameraTrackingEnabled)return;let i;if(e)i=e.timezoneOffset;else{if(t.displayUTCOffset!=null)return;i=j.calculateTimezoneOffset(t.positionTimezoneInfo)}t.displayUTCOffset=i,this._scheduleLightingUpdate()}_scheduleLightingUpdate(e){if(e&&(this._lightingUpdateHandle=Y(this._lightingUpdateHandle),!M(e))||this._lightingUpdateHandle)return;const t=Date.now()-this._lastLightingUpdate,i=this.lightingUpdateInterval-t;let n=null;const l=()=>{this._updateLighting(e),this._lightingUpdateHandle===n&&(this._lightingUpdateHandle=null)};if(i<=0)this._lightingUpdateHandle=n=de(l);else{const r=setTimeout(l,i);this._lightingUpdateHandle=n=he(()=>clearTimeout(r))}}_cancelLightingUpdate(){this._lightingUpdateHandle=Y(this._lightingUpdateHandle)}_play(){const e=this._lighting;if(e==null||!this.sunLightingEnabled||e.type==="virtual")return;const t=C(e);if(this.dayPlaying||this.yearPlaying){const i=Date.now()-(this._lastTime??0);if(this.dayPlaying){this._lastTime=Date.now();const n=$e(this._sunrise,this._sunset,t)*this.playSpeedMultiplier/100*i;if(n>0){let l=new Date(t.getTime()+n);const r=e.displayUTCOffset??0;((l.getUTCHours()+r)%24+24)%24<((t.getUTCHours()+r)%24+24)%24&&(l=new Date(t.getTime()+n-864e5)),e.date=l}}else if(i>1e3){this._lastTime=Date.now();const n=(t.getUTCMonth()+1)%12,l=new Date(t.getTime());l.setUTCMonth(n),e.date=l}requestAnimationFrame(()=>this._play())}}_updateSunriseAndSunset(){var w,p;const e=this._lighting;if(e==null||e.type==="virtual"||!this.sunLightingEnabled)return;const t=(p=(w=this.view)==null?void 0:w.camera)==null?void 0:p.position;if(t==null)return;const{latitude:i,longitude:n}=t,{date:l,displayUTCOffset:r}=e,d=Te(l,i,n,r??0);d&&(this._sunrise=new Date(d.sunrise),this._sunset=new Date(d.sunset))}};function C(e){return M(e.date)||(Z.getLogger(te).warn("Invalid date. Reverting to the current date/time."),e.date=new Date),e.date}s([o({type:_e})],a.prototype,"view",void 0),s([o({type:ee,nonNullable:!0})],a.prototype,"datePickerViewModel",void 0),s([o({type:f,nonNullable:!0})],a.prototype,"timeSliderViewModel",void 0),s([o()],a.prototype,"isSupported",null),s([o()],a.prototype,"lightingUpdateInterval",void 0),s([o()],a.prototype,"utcOffset",null),s([o()],a.prototype,"localDate",null),s([o()],a.prototype,"timeSliderPosition",null),s([o()],a.prototype,"directShadowsEnabled",null),s([o()],a.prototype,"sunLightingEnabled",null),s([o({type:["none","day","year"],value:"none"})],a.prototype,"playingState",null),s([o()],a.prototype,"dayPlaying",null),s([o()],a.prototype,"yearPlaying",null),s([o()],a.prototype,"playSpeedMultiplier",void 0),s([o()],a.prototype,"currentSeason",null),s([o()],a.prototype,"_lastTime",void 0),s([o()],a.prototype,"_sunrise",void 0),s([o()],a.prototype,"_sunset",void 0),s([o()],a.prototype,"_cachedLightingDateUTC",void 0),s([o()],a.prototype,"_cachedDisplayUTCOffset",void 0),s([o()],a.prototype,"_firstInteraction",void 0),s([o()],a.prototype,"_currentHemisphere",null),s([o()],a.prototype,"_environment",null),s([o()],a.prototype,"_lighting",null),s([o()],a.prototype,"_lightingType",null),s([o()],a.prototype,"_lightingDateDisplay",null),a=s([k(te)],a);const ie=a;let _=class extends X{constructor(e){super(e),this.header=!0,this.playButtons=!0,this.datePicker=!0,this.timezone=!0,this.sunLightingToggle=!0,this.shadowsToggle=!0}};s([o({type:Boolean,nonNullable:!0})],_.prototype,"header",void 0),s([o({type:Boolean,nonNullable:!0})],_.prototype,"playButtons",void 0),s([o({type:Boolean,nonNullable:!0})],_.prototype,"datePicker",void 0),s([o({type:Boolean,nonNullable:!0})],_.prototype,"timezone",void 0),s([o({type:Boolean,nonNullable:!0})],_.prototype,"sunLightingToggle",void 0),s([o({type:Boolean,nonNullable:!0})],_.prototype,"shadowsToggle",void 0),_=s([k("esri.widgets.Daylight.VisibleElements")],_);const se=_,z="esri-slider-with-dropdown",L={label:"esri-slider__label",box:`${z}__box`,boxDropDownOn:`${z}__box--drop-down-on`,boxDropDownOff:`${z}__box--drop-down-off`};let b=class extends be{constructor(e,t){super(e,t),this.viewModel=new f,this.showDropDown=!0,this._labelWidth=0,this._onLabelAfterCreate=i=>{const n="label-size-observer";this.removeHandles(n),this.addHandles(me(i,({contentRect:l})=>{this._labelWidth=l.width}),n)},this._getLabelStyles=()=>{if(!this.trackElement)return;const i=this._trackWidth,n=this._labelWidth/2,l=this.getCurrentPosition(),r=l-n,d=l+n;let w=-n;return r<0?w+=-r:d>i&&(w+=i-d),{left:`${w}px`}},this._onTimezoneChange=i=>{this.viewModel.utcOffset=i},this._onTimezonePickerOpen=()=>{this.viewModel.timezonePickerOpen=!0},this._onTimezonePickerClose=()=>{this.viewModel.timezonePickerOpen=!1}}renderThumbLabel(e){const{showDropDown:t,viewModel:i}=this;return m("div",{afterCreate:this._onLabelAfterCreate,class:this.classes({[L.box]:!0,[L.label]:!0,[L.boxDropDownOn]:t,[L.boxDropDownOff]:!t}),key:"thumb-label",styles:this._getLabelStyles()},super.renderThumbLabel(e),t?m(De,{open:i.timezonePickerOpen,value:i.utcOffset,onChange:this._onTimezoneChange,onClose:this._onTimezonePickerClose,onOpen:this._onTimezonePickerOpen}):null)}};s([o()],b.prototype,"viewModel",void 0),s([o()],b.prototype,"showDropDown",void 0),s([o()],b.prototype,"_labelWidth",void 0),b=s([k("esri.widgets.Daylight.support.SliderWithDropdown")],b);const Ue=b,J=/(.*)\s(.*)/,A="date",K="esri.widgets.Daylight";let h=class extends ce{constructor(e,t){super(e,t),this.headingLevel=3,this.iconClass=g.widgetIcon,this.icon=null,this.viewModel=new ie,this.visibleElements=new se,this.dateOrSeason=A,this._timeSlider=new Ue({viewModel:this.viewModel.timeSliderViewModel,steps:this.timeSliderSteps,labelInputsEnabled:!1,visibleElements:{labels:!0},tickConfigs:[{mode:"position",values:[0,360,720,1080,1439],labelsVisible:!0,tickCreatedFunction:this._onPrimaryTickCreated.bind(this)},{mode:"position",values:[120,240,480,600,840,960,1200,1320],tickCreatedFunction:this._onSecondaryTickCreated.bind(this)}]}),this._datePicker=new Se({viewModel:this.viewModel.datePickerViewModel,commitOnMonthChange:!0}),this._onPlayDayClick=()=>{this.viewModel.toggleDayPlaying()},this._onYearPlayClick=()=>{this.viewModel.toggleYearPlaying()},this._onSeasonChange=i=>{this.viewModel.currentSeason=i.target.value},this._onSunLightingCheckboxChange=()=>{this.viewModel.toggleSunLightingEnabled()},this._onShadowCheckboxChange=()=>{this.viewModel.toggleDirectShadowsEnabled()}}get label(){var e;return((e=this.messages)==null?void 0:e.title)??""}set label(e){this._overrideIfSome("label",e)}get playSpeedMultiplier(){return this.viewModel.playSpeedMultiplier}set playSpeedMultiplier(e){this.viewModel.playSpeedMultiplier=e}get timeSliderSteps(){var e;return((e=this._timeSlider)==null?void 0:e.steps)??5}set timeSliderSteps(e){this._timeSlider.steps=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}get test(){return{datePicker:this._datePicker}}get _useAmPm(){const e=this._timeSlider.viewModel.getLabelForValue(0,"tick");return e!=null&&J.test(e)}postInitialize(){this.viewModel.isSupported&&this.addHandles([c(()=>this.viewModel.datePickerViewModel,e=>this._datePicker.viewModel=e,D),c(()=>this.viewModel.timeSliderViewModel,e=>this._timeSlider.viewModel=e,D),c(()=>{var e;return(e=this.visibleElements)==null?void 0:e.timezone},e=>this._timeSlider.showDropDown=e,D),c(()=>!this.viewModel.sunLightingEnabled,e=>{this._datePicker.disabled=e,this._timeSlider.disabled=e},D),Q(()=>!this.visible,()=>{var e;return(e=this._datePicker)==null?void 0:e.close(!1)},pe)])}destroy(){this._datePicker.destroy(),this._timeSlider.destroy()}render(){const{messages:e,viewModel:t,visibleElements:i}=this,n=t.isSupported;return m("div",{class:this.classes(g.base,T.widget)},n?m(ue,null,i.header?m(Pe,{level:this.headingLevel},e.title):null,this._renderTimeOptions(),i.datePicker?this._renderDateOrSeason():null,i.sunLightingToggle?this._renderSunLightingToggle():null,i.shadowsToggle?this._renderShadowsToggle():null):m("div",{class:g.panelError,key:"unsupported"},m("p",null,e.unsupported)))}loadDependencies(){return ye({button:()=>S(()=>import("./calcite-button-5457cec5.js"),["assets/calcite-button-5457cec5.js","assets/button-27a2f99e.js","assets/jsxFactory-92036771.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/uuid-709b6c67.js","assets/form-60623048.js","assets/interactive-39956fb6.js","assets/label2-0071fcd4.js","assets/loadable-7d42c3de.js","assets/locale-2cb18332.js","assets/key-c2c83cc7.js","assets/observers-9c654f26.js","assets/component-7281ffa6.js","assets/t9n-622f279b.js","assets/icon-c122f720.js","assets/loader-ea663d25.js","assets/guid-2347ca41.js"]),checkbox:()=>S(()=>import("./calcite-checkbox-fef8d84f.js"),["assets/calcite-checkbox-fef8d84f.js","assets/jsxFactory-92036771.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/uuid-709b6c67.js","assets/form-60623048.js","assets/guid-2347ca41.js","assets/interactive-39956fb6.js","assets/key-c2c83cc7.js","assets/label2-0071fcd4.js","assets/loadable-7d42c3de.js"]),label:()=>S(()=>import("./calcite-label-4966fb24.js"),["assets/calcite-label-4966fb24.js","assets/label-fe92b4f9.js","assets/jsxFactory-92036771.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/uuid-709b6c67.js","assets/label2-0071fcd4.js"]),option:()=>S(()=>import("./calcite-option-7b8b2690.js"),["assets/calcite-option-7b8b2690.js","assets/jsxFactory-92036771.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/uuid-709b6c67.js","assets/observers-9c654f26.js"]),select:()=>S(()=>import("./calcite-select-84c557c7.js"),["assets/calcite-select-84c557c7.js","assets/jsxFactory-92036771.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/uuid-709b6c67.js","assets/form-60623048.js","assets/interactive-39956fb6.js","assets/label2-0071fcd4.js","assets/loadable-7d42c3de.js","assets/observers-9c654f26.js","assets/component-7281ffa6.js","assets/icon-c122f720.js"])})}_renderTimeOptions(){const{viewModel:e,visibleElements:t,messages:i}=this,{directShadowsEnabled:n,dayPlaying:l}=e,r=!e.sunLightingEnabled;return m("div",{class:this.classes(g.dayContainer,{[g.sliderShadowOn]:n,[g.sliderShadowOff]:!n,[g.sliderDateOn]:t.datePicker,[g.sliderDateOff]:!t.datePicker,[g.sliderAmPmOn]:this._useAmPm,[g.containerDisabled]:r}),key:"daylight-time-options"},this._timeSlider.render(),t.playButtons?this._renderPlayPauseButton({playing:l,disabled:r,label:i.playDay,onClick:this._onPlayDayClick}):null)}_renderDateOptions(){const{viewModel:e,visibleElements:t,messages:i}=this,{yearPlaying:n}=e,l=!e.sunLightingEnabled;return m("div",{class:this.classes(g.dateContainer,l&&g.containerDisabled),key:"daylight-date"},this._datePicker.render(),t.playButtons?this._renderPlayPauseButton({playing:n,disabled:l,label:i.playYear,onClick:this._onYearPlayClick}):null)}_renderPlayPauseButton({playing:e,disabled:t,label:i,onClick:n}){return m("calcite-button",{appearance:"solid",class:g.playPauseButton,disabled:t,iconStart:e?"pause-f":"play-f",label:i,onclick:n,round:!0,title:i,type:"button"})}_renderSeasonSelect(){const{messages:e,viewModel:t}=this,i=!t.sunLightingEnabled;return m("calcite-select",{class:this.classes(g.seasonPicker),disabled:i,label:e.season,onCalciteSelectChange:this._onSeasonChange},I.map(n=>m("calcite-option",{selected:t.currentSeason===n,value:n},e[n])))}_renderDateOrSeason(){return this.dateOrSeason==="date"?this._renderDateOptions():this._renderSeasonSelect()}_renderSunLightingToggle(){var t;const e=(t=this.messages)==null?void 0:t.sunLightingToggle;return m("calcite-label",{key:"date-time-toggle",layout:"inline",scale:"s",title:e==null?void 0:e.tooltip},m("calcite-checkbox",{checked:this.viewModel.sunLightingEnabled,class:g.sunLightingCheckbox,onCalciteCheckboxChange:this._onSunLightingCheckboxChange}),e==null?void 0:e.label)}_renderShadowsToggle(){const e=this.messages.shadowsToggle;return m("calcite-label",{key:"shadow-toggle",layout:"inline",scale:"s",title:e==null?void 0:e.tooltip},m("calcite-checkbox",{checked:this.viewModel.directShadowsEnabled,class:g.shadowsCheckbox,onCalciteCheckboxChange:this._onShadowCheckboxChange}),e.label)}_onPrimaryTickCreated(e,t,i){t.classList.add(...R,T.primaryTick),i.classList.add(...R,T.primaryTickLabel),i.onclick=t.onclick=this._makeGoToTime(e);const n=i.textContent,l=n!=null&&J.exec(n);l&&(i.innerHTML=`${l[1]}<br><div class=${T.primaryTickAmPm}>${l[2]}</div>`)}_onSecondaryTickCreated(e,t){t.classList.add(...R,T.secondaryTick),t.onclick=this._makeGoToTime(e)}_makeGoToTime(e){return()=>{this.viewModel.timeSliderPosition=e}}};s([o(),G("esri/widgets/Daylight/t9n/Daylight")],h.prototype,"messages",void 0),s([o(),G("esri/widgets/support/t9n/timezone")],h.prototype,"timezoneMessages",void 0),s([o()],h.prototype,"headingLevel",void 0),s([o()],h.prototype,"iconClass",void 0),s([o()],h.prototype,"icon",void 0),s([o()],h.prototype,"label",null),s([o()],h.prototype,"playSpeedMultiplier",null),s([o()],h.prototype,"timeSliderSteps",null),s([o()],h.prototype,"view",null),s([o({type:ie})],h.prototype,"viewModel",void 0),s([o({type:se,nonNullable:!0})],h.prototype,"visibleElements",void 0),s([o({cast:e=>e==="season"||e==="date"?e:(Z.getLogger(K).warn(`"${e}" is not a valid option. Acceptable values are only "date" or "season". Defaulting to "${A}".`),A)})],h.prototype,"dateOrSeason",void 0),s([o()],h.prototype,"_timeSlider",void 0),s([o()],h.prototype,"_useAmPm",null),s([o()],h.prototype,"_datePicker",void 0),h=s([k(K)],h);const R=["esri-interactive","esri-widget__anchor"],bs=h;export{bs as default};
