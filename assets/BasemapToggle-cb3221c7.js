import{a5 as t,a6 as i,eU as R,a9 as $,bA as T,cb as E,h3 as L,gs as M,bm as B,eI as O,eh as I,eJ as P,_ as f}from"./index-b516d057.js";import{b as u,m as C,U as j,O as k}from"./basemapUtils-6ec10a55.js";import{e as V,O as A,r as D,n as o}from"./jsxFactory-92036771.js";import{e as v}from"./globalCss-94006b67.js";import{t as U}from"./accessibleHandler-e91101b2.js";import"./Basemap-8d62c69e.js";import"./loadAll-5e767cfa.js";import"./writeUtils-e226a8aa.js";import"./uuid-709b6c67.js";let l=class extends T{constructor(e){super(e),this._basemapCache={},this._loadingProjectionEngine=!1,this.nextBasemap=u("hybrid",this._basemapCache),this.view=null}initialize(){E(()=>this.nextBasemap,e=>{e&&!e.loaded&&e.load().catch(()=>{})},L)}destroy(){this.view=null,C(this._basemapCache),this._basemapCache=null}get _nextBasemapSpatialReferenceTask(){return j(this.view,this.nextBasemap)}get _viewSpatialReferenceLocked(){const{view:e}=this;return!e||!("spatialReferenceLocked"in e)||e.spatialReferenceLocked}get activeBasemap(){var e,s;return u(((s=(e=this.view)==null?void 0:e.map)==null?void 0:s.basemap)??"topo-vector",this._basemapCache)}castNextBasemap(e){return u(e,this._basemapCache)}get state(){const{view:e}=this;if(!(e!=null&&e.ready)||this._nextBasemapSpatialReferenceTask.updating)return"disabled";const{spatialReference:s}=this._nextBasemapSpatialReferenceTask;return this._viewSpatialReferenceLocked&&s!=null&&!e.spatialReference.equals(s)?"incompatible-next-basemap":this._loadingProjectionEngine?"loading":"ready"}async toggle(){const{activeBasemap:e,nextBasemap:s,state:h,view:r}=this;if(!r||h==="disabled"||h==="incompatible-next-basemap")return;const m=this._viewSpatialReferenceLocked;if(!m){if(await M(()=>!this._nextBasemapSpatialReferenceTask.updating),s!==this.nextBasemap||e!==this.activeBasemap)return;const{spatialReference:d}=this._nextBasemapSpatialReferenceTask;if(d==null||B(r.spatialReference,d)||O()||I(r.spatialReference,d)||(this._loadingProjectionEngine=!0,await P(),this._loadingProjectionEngine=!1),s!==this.nextBasemap||e!==this.activeBasemap)return}r.map.basemap=s,m||this._nextBasemapSpatialReferenceTask.spatialReference==null||B(r.spatialReference,this._nextBasemapSpatialReferenceTask.spatialReference)||(r.spatialReference=this._nextBasemapSpatialReferenceTask.spatialReference),this.nextBasemap=e}static getThumbnailUrl(e){return k(e)}};t([i()],l.prototype,"_loadingProjectionEngine",void 0),t([i({readOnly:!0})],l.prototype,"_nextBasemapSpatialReferenceTask",null),t([i({readOnly:!0})],l.prototype,"_viewSpatialReferenceLocked",null),t([i({readOnly:!0})],l.prototype,"activeBasemap",null),t([i()],l.prototype,"nextBasemap",void 0),t([R("nextBasemap")],l.prototype,"castNextBasemap",null),t([i({readOnly:!0})],l.prototype,"state",null),t([i()],l.prototype,"view",void 0),t([i()],l.prototype,"toggle",null),l=t([$("esri.widgets.BasemapToggle.BasemapToggleViewModel")],l);const S=l,c="esri-basemap-toggle",g="esri-basemap-thumbnail",p={base:c,secondaryBasemapImage:`${c}__image--secondary`,container:`${g} ${c}__container`,image:`${g}__image ${c}__image`,imageLoading:`${c}__image--loading`,overlay:`${g}__overlay ${c}__image-overlay`,title:`${g}__title ${c}__title`,overlayScrim:`${g}__overlay-scrim`};function w(a){const e=k(a);return e?{backgroundImage:"url("+e+")"}:{backgroundImage:""}}const x={title:!1};let n=class extends A{constructor(a,e){super(a,e),this.messages=null,this.viewModel=new S,this.visibleElements={...x}}loadDependencies(){return D({icon:()=>f(()=>import("./calcite-icon-39deb8ae.js"),["assets/calcite-icon-39deb8ae.js","assets/icon-c122f720.js","assets/jsxFactory-92036771.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/uuid-709b6c67.js","assets/observers-9c654f26.js"]),scrim:()=>f(()=>import("./calcite-scrim-5ea722f7.js"),["assets/calcite-scrim-5ea722f7.js","assets/scrim-41a5f26e.js","assets/jsxFactory-92036771.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/uuid-709b6c67.js","assets/locale-2cb18332.js","assets/key-c2c83cc7.js","assets/observers-9c654f26.js","assets/t9n-622f279b.js","assets/loader-ea663d25.js","assets/guid-2347ca41.js"])})}get activeBasemap(){return this.viewModel.activeBasemap}get label(){var a;return((a=this.messages)==null?void 0:a.widgetLabel)??""}set label(a){this._overrideIfSome("label",a)}get nextBasemap(){return this.viewModel.nextBasemap}set nextBasemap(a){this.viewModel.nextBasemap=a}get view(){return this.viewModel.view}set view(a){this.viewModel.view=a}castVisibleElements(a){return{...x,...a}}toggle(){return this.viewModel.toggle()}render(){const a=this.viewModel,e=a.state==="disabled"?null:a.activeBasemap,s=a.state==="disabled"?null:a.nextBasemap,h=a.state==="loading",r=a.state==="incompatible-next-basemap",m=(s==null?void 0:s.title)??"",d=s&&s.loadStatus!=="loaded";let _;const b=this.visibleElements.title&&m,y=r;return(b||y)&&(_=o("div",{class:p.overlay,key:"overlay"},b?o("span",{class:p.title,title:m},m):null,y?o("calcite-scrim",{class:p.overlayScrim,title:this.messages.incompatibleSpatialReference},o("calcite-icon",{icon:"exclamation-mark-triangle"})):null)),o("div",{bind:this,class:this.classes(p.base,v.widget,r?v.disabled:null),"data-basemap-id":s?s.id:"",onclick:this._toggle,onkeydown:this._toggle,role:"button",tabIndex:r?-1:0,title:this.label},o("div",{class:this.classes(p.container,p.secondaryBasemapImage)},o("div",{class:p.image,styles:w(e)})),o("div",{class:p.container},o("div",{class:this.classes(p.image,d?p.imageLoading:null),styles:w(s)},d||h?o("calcite-scrim",null,o("span",{"aria-hidden":"true",class:v.loaderAnimation,role:"presentation"})):null),_))}_toggle(){this.toggle()}};t([i({readOnly:!0})],n.prototype,"activeBasemap",null),t([i()],n.prototype,"label",null),t([i(),V("esri/widgets/BasemapToggle/t9n/BasemapToggle")],n.prototype,"messages",void 0),t([i()],n.prototype,"nextBasemap",null),t([i()],n.prototype,"view",null),t([i({type:S})],n.prototype,"viewModel",void 0),t([i()],n.prototype,"visibleElements",void 0),t([R("visibleElements")],n.prototype,"castVisibleElements",null),t([U()],n.prototype,"_toggle",null),n=t([$("esri.widgets.BasemapToggle")],n);const X=n;export{X as default};
