import{a5 as d,a6 as p,a9 as q,bA as ut,B as G,ah as T,nA as Z,nB as E,nC as pt,nD as X,nE as it,s as $,nF as ft,bm as yt,eI as Pt,di as Ct,cD as $t,aP as tt,bg as St,V as U,e2 as xt,j5 as Mt,cb as K,kl as Et,eJ as Tt,an as W,h3 as It,eH as kt,cc as Dt,eU as ht,km as Rt,h7 as Ft}from"./index-b516d057.js";import{e as nt,O as Lt,n as a,i as x,S as Bt,Q as Gt}from"./jsxFactory-92036771.js";import{r as vt,s as Vt,p as At}from"./number-2ab18aee.js";import{t as Ot}from"./GoTo-4d856ce0.js";import{e as f}from"./globalCss-94006b67.js";import{e as st}from"./Heading-92f210ca.js";import{t as L}from"./accessibleHandler-e91101b2.js";import"./uuid-709b6c67.js";let O=class extends ut{constructor(e){super(e),this.format=null,this.position={coordinate:null,location:null}}get displayCoordinate(){var e,t;return(t=this.format)==null?void 0:t.getDisplayCoordinate((e=this.position)==null?void 0:e.coordinate)}};d([p({readOnly:!0})],O.prototype,"displayCoordinate",null),d([p()],O.prototype,"format",void 0),d([p()],O.prototype,"position",void 0),O=d([q("esri.widgets.CoordinateConversion.support.Conversion")],O);const Y=O;function Wt(i,e){const t=mt(e);return[i[0].toFixed(t),i[1].toFixed(t)]}function mt(i){return i>=500?6:i<500&&i>=50?7:i<50&&i>=5?8:9}function Yt(i,e){const t=i.includes(",")?",":" ",[n,s,o]=i.split(t).map(c=>{const h=c.trim();return h?Number(h):null});if(!J(n)||!J(s))return null;const l=new G({x:n,y:s,spatialReference:e||T.WGS84});return o&&(l.z=o,l.hasZ=!0),l}function J(i){return typeof i=="number"&&isFinite(i)}function et(i){return!!i&&J(i.x)&&J(i.y)}function ot(i,e){if(i.spatialReference.isGeographic&&e){const[t,n]=Wt([i.x,i.y],e);return`${t}, ${n}`}return`${i.x.toFixed(3)}, ${i.y.toFixed(3)}`}const Nt=["dd","dms","ddm","mgrs","usng","utm"];function Xt(i){return Nt.includes(i)}function Ut(i,e){const t=[];i=(i=(i=i.replaceAll(/[\u00B0\u00BA]/g,"^")).replaceAll("′","'")).replaceAll("″",'"');const n=R(e);return Z.dmsToGeog(n,1,[i],t)?new G(t[0][0],t[0][1],e||T.WGS84):null}function Ht(i,e,t){const n=[],s=gt(t);if(s===-1)return console.warn(`invalid conversionMode: ${t}`),null;const o=R(e);return E.mgrsToGeogExtended(o,1,[i],s,n)?new G(n[0][0],n[0][1],e||T.WGS84):null}function zt(i,e){const t=[];!e&&/\(.+27/.test(i)&&(e=T.GCS_NAD_1927);const n=R(e);return pt.usngToGeog(n,1,[i],t)?new G(t[0][0],t[0][1],e||T.WGS84):null}function jt(i,e,t){const n=[],s=_t(t);if(s===-1)return console.warn(`invalid conversionMode: ${t}`),null;const o=R(e);return X.utmToGeog(o,1,[i],s,n)?new G(n[0][0],n[0][1],e||T.WGS84):null}function Zt(i,e,t=0){const n=[[i.x,i.y]],s=[],o=R(i.spatialReference);let l=0;switch(e){case"dd":l=Z.geogToDd(o,1,n,t,s);break;case"ddm":l=Z.geogToDdm(o,1,n,t,s);break;case"dms":l=Z.geogToDms(o,1,n,t,s);break;default:return console.warn(`invalid format: ${e}`),null}return l?s[0]:null}function Jt(i,e,t=0,n=!1){const s=[[i.x,i.y]],o=[],l=R(i.spatialReference);let c=gt(e);return c===-1?(console.warn(`invalid conversionMode: ${e}`),null):(n&&(c|=E.PE_MGRS_ADD_SPACES),E.geogToMgrsExtended(l,1,s,t,!1,c,o)?o[0]:null)}function qt(i,e=0,t=!1){const n=[[i.x,i.y]],s=[],o=R(i.spatialReference);return pt.geogToUsng(o,1,n,e,!1,t,s)?s[0]:null}function Qt(i,e,t=!1){const n=[[i.x,i.y]],s=[],o=R(i.spatialReference);let l=_t(e);return l===-1?(console.warn(`invalid conversionMode: ${e}`),null):(t&&(l|=X.PE_UTM_OPTS_ADD_SPACES),X.geogToUtm(o,1,n,l,s)?s[0]:null)}function R(i){let e=null;if(i||(i=T.WGS84),i.wkid){if(e=it.geogcs(i.wkid),!e)throw new $("coordinate-formatter:invalid-spatial-reference","wkid is not valid")}else{if(!i.wkt2&&!i.wkt)throw new $("coordinate-formatter:invalid-spatial-reference","wkid and wkt are missing");if(e=it.fromString(ft.PE_TYPE_GEOGCS,i.wkt2||i.wkt),!e)throw new $("coordinate-formatter:invalid-spatial-reference","wkt is not valid")}return e}function gt(i){let e=-1;switch(i){case"automatic":e=E.PE_MGRS_STYLE_AUTO;break;case"new-180-in-zone-01":e=E.PE_MGRS_STYLE_NEW|E.PE_MGRS_180_ZONE_1_PLUS;break;case"new-180-in-zone-60":e=E.PE_MGRS_STYLE_NEW;break;case"old-180-in-zone-01":e=E.PE_MGRS_STYLE_OLD|E.PE_MGRS_180_ZONE_1_PLUS;break;case"old-180-in-zone-60":e=E.PE_MGRS_STYLE_OLD}return e}function _t(i){let e=-1;switch(i){case"latitude-band-indicators":e=X.PE_UTM_OPTS_NONE;break;case"north-south-indicators":e=X.PE_UTM_OPTS_NS}return e}let C=class extends ut{constructor(e){super(e),this.conversionInfo=null,this.coordinateSegments=null,this._currentPattern=void 0,this.defaultPattern=null,this.name=null,this.viewModel=null}get currentPattern(){return(this._currentPattern||this.defaultPattern)??""}set currentPattern(e){this._currentPattern=e}get label(){return this.name??""}set label(e){this._overrideIfSome("label",e)}get hasDisplayProperties(){return!(!this.defaultPattern||!this.coordinateSegments)}get spatialReference(){var e;return this.name==="basemap"?this._viewSpatialReference:((e=this.conversionInfo)==null?void 0:e.spatialReference)??T.WGS84}set spatialReference(e){this._overrideIfSome("spatialReference",e)}get _viewSpatialReference(){var e,t;return((t=(e=this.viewModel)==null?void 0:e.view)==null?void 0:t.spatialReference)??T.WGS84}get _additionalCharactersPattern(){const e=this.coordinateSegments;if(!e)return null;const t=e.map(s=>s.alias),n=this.currentPattern.replaceAll(new RegExp(`["nsew${t.join()}]`,"gi"),"").replaceAll(" ","");return new RegExp(`[${n}]`,"g")}get test(){return{additionalCharactersPattern:this._additionalCharactersPattern}}async convert(e){var s;if(!et(e))throw new $("format:invalid-point","Could not convert invalid point.",{point:e});const t=(s=this.conversionInfo)==null?void 0:s.convert;if(t)return Promise.resolve().then(()=>t(e));const n=await this._project(e,this.spatialReference);return{location:n,coordinate:await this._getCoordinate(n)}}getConversionStrategy(){var t,n;const e=this._viewSpatialReference;return(t=this.conversionInfo)!=null&&t.convert||(n=this.viewModel)!=null&&n.formatterAvailable||this.name==="xy"&&(e.isWebMercator||e.isWGS84)||this.name==="basemap"?"client":"server"}getDisplayCoordinate(e){if(!e)return null;if(!this.coordinateSegments||!this.currentPattern)return e;let t=this.currentPattern;const n=this._getSegmentMatches(e,!1);for(let s=this.coordinateSegments.length-1;s>=0;s--){const o=this.coordinateSegments[s];t=t.replace(o.alias,n[s])}return t}parseUserInput(e){const{defaultPattern:t,_additionalCharactersPattern:n,coordinateSegments:s}=this;if(!t||!n)return"";let o=t.replace(n,"");e=e.replace(n,"");const l=this._getSegmentMatches(e,!0);if(s)for(let c=s.length-1;c>=0;c--){const h=s[c];o=o.replace(h.alias,l[c])}return o}_getSegmentMatches(e,t){const n=new Array,{coordinateSegments:s}=this;if(!s)return n;for(let o=0;o<s.length;o++){const l=s[o],c=e.match(l.searchPattern);if(!c){n.push("");continue}let h=c[0];if(e=e.replace(h,"").trim(),l.substitution){const v=t?l.substitution.input(h):l.substitution.output(h);v&&(h=`${v}`)}n.push(h)}return n}async reverseConvert(e){var o,l;const t=this.parseUserInput(e),n=(o=this.conversionInfo)==null?void 0:o.reverseConvert;let s;if(n)s=n(t);else if(this.name==="xy"||this.name==="basemap")s=Yt(t,this.spatialReference);else if((l=this.viewModel)!=null&&l.formatterAvailable)switch(this.name){case"dd":case"ddm":case"dms":s=Ut(t,this.spatialReference);break;case"mgrs":{const c="automatic";s=Ht(t,this.spatialReference,c);break}case"utm":{const c="latitude-band-indicators";s=jt(t,this.spatialReference,c);break}case"usng":s=zt(t,this.spatialReference);break;default:s=null}if(!s)throw new $("format:invalid-input","Could not parse input into point.",{userInput:e});return this._project(s,this._viewSpatialReference)}async _getCoordinate(e){var n,s,o;const t=((s=(n=this.viewModel)==null?void 0:n.view)==null?void 0:s.scale)??0;if(!et(e))throw new $("format:invalid-point","Could not transform invalid point into coordinate.",{point:e});if((o=this.viewModel)!=null&&o.formatterAvailable||this.name==="basemap"||this.name==="xy")switch(this.name){case"dd":case"ddm":case"dms":{const l=mt(t);return Zt(e,this.name,l)}case"mgrs":return Jt(e,"automatic",5,!1);case"usng":return qt(e,5,!1);case"utm":return Qt(e,"latitude-band-indicators",!0);default:return ot(e,t)}return ot(e,t)}async _project(e,t){var n,s;if(yt(e.spatialReference,t)||!t)return e;if((n=this.viewModel)!=null&&n.formatterAvailable&&Pt())return Ct(e,t);if(!((s=this.viewModel)!=null&&s.formatterAvailable)){const o=$t(e,t);if(o!=null)return o}return null}};d([p()],C.prototype,"conversionInfo",void 0),d([p()],C.prototype,"coordinateSegments",void 0),d([p()],C.prototype,"currentPattern",null),d([p()],C.prototype,"_currentPattern",void 0),d([p()],C.prototype,"label",null),d([p()],C.prototype,"defaultPattern",void 0),d([p({readOnly:!0})],C.prototype,"hasDisplayProperties",null),d([p()],C.prototype,"name",void 0),d([p({type:T})],C.prototype,"spatialReference",null),d([p()],C.prototype,"viewModel",void 0),d([p({readOnly:!0})],C.prototype,"_viewSpatialReference",null),d([p({readOnly:!0})],C.prototype,"_additionalCharactersPattern",null),C=d([q("esri.widgets.CoordinateConversion.support.Format")],C);const D=C,B=vt().decimal,A={N:"north",S:"south",E:"east",W:"west"},w="°‎",H=new RegExp(`-?\\d+[\\.|\\${B}]?\\d*`),Kt=/^[\\0]+(?=\d)/;function rt(i,e){const t=tt()==="ar",n=i.abbreviatedDirections.north,s=i.abbreviatedDirections.south,o=i.abbreviatedDirections.east,l=i.abbreviatedDirections.west,c=vt().decimal,h={[n]:"N",[s]:"S",[o]:"E",[l]:"W"},v=new RegExp(`-?\\d+[\\.|\\${c}]?\\d*`),y=new RegExp(`N|S|${n}|${s}`,"i"),I=new RegExp(`E|W|${o}|${l}`,"i"),F={ddm:`Y${w} A'${i.abbreviatedDirections.north}, X${w} B'${i.abbreviatedDirections.east}`,dms:`Y${w} A' B"${i.abbreviatedDirections.north}, X${w} C' D"${i.abbreviatedDirections.east}`,dd:`Y${w}${i.abbreviatedDirections.north}, X${w}${i.abbreviatedDirections.east}`,xy:`X${w}, Y${w}`,basemap:"X, Y"},N={ddm:`${i.abbreviatedDirections.north}${w}Y 'A ,${i.abbreviatedDirections.east}${w}X 'B`,dms:`${i.abbreviatedDirections.north}${w}Y 'A "B ,${i.abbreviatedDirections.east}${w}X 'C "D`,dd:`${i.abbreviatedDirections.north}${w}Y ,${i.abbreviatedDirections.east}${w}X`,xy:`X${w} ,Y${w}`,basemap:"X ,Y"},wt=S=>S!=null&&Object.keys(F).includes(S),k=new RegExp(`\\d{1,2}[\\.|\\${c}]?\\d*`,"i"),Q=new RegExp(`\\d{1,3}[\\.|\\${c}]?\\d*`,"i");e.forEach(S=>{const{name:V}=S;if(V==="dd"?S.coordinateSegments=[{alias:"Y",description:"degrees latitude",searchPattern:k,substitution:{input:r=>_(r),output:r=>g(r)}},{alias:i.abbreviatedDirections.north,description:"north/south indicator",searchPattern:y,substitution:{input:r=>h[r],output:r=>i.abbreviatedDirections[A[r]]}},{alias:"X",description:"degrees longitude",searchPattern:Q,substitution:{input:r=>_(r),output:r=>g(r)}},{alias:i.abbreviatedDirections.east,description:"east/west indicator",searchPattern:I,substitution:{input:r=>h[r],output:r=>i.abbreviatedDirections[A[r]]}}]:V==="ddm"?S.coordinateSegments=[{alias:"Y",description:"degrees latitude",searchPattern:k,substitution:{input:r=>_(r),output:r=>g(r)}},{alias:"A",description:"minutes latitude",searchPattern:k,substitution:{input:r=>_(r),output:r=>g(r)}},{alias:i.abbreviatedDirections.north,description:"north/south indicator",searchPattern:y,substitution:{input:r=>h[r],output:r=>i.abbreviatedDirections[A[r]]}},{alias:"X",description:"degrees longitude",searchPattern:Q,substitution:{input:r=>_(r),output:r=>g(r)}},{alias:"B",description:"minutes longitude",searchPattern:k,substitution:{input:r=>_(r),output:r=>g(r)}},{alias:i.abbreviatedDirections.east,description:"east/west indicator",searchPattern:I,substitution:{input:r=>h[r],output:r=>i.abbreviatedDirections[A[r]]}}]:V==="dms"?S.coordinateSegments=[{alias:"Y",description:"degrees latitude",searchPattern:k,substitution:{input:r=>_(r),output:r=>g(r)}},{alias:"A",description:"minutes latitude",searchPattern:k,substitution:{input:r=>_(r),output:r=>g(r)}},{alias:"B",description:"seconds latitude",searchPattern:k,substitution:{input:r=>_(r),output:r=>g(r)}},{alias:i.abbreviatedDirections.north,description:"north/south indicator",searchPattern:y,substitution:{input:r=>h[r],output:r=>i.abbreviatedDirections[A[r]]}},{alias:"X",description:"degrees longitude",searchPattern:Q,substitution:{input:r=>_(r),output:r=>g(r)}},{alias:"C",description:"minutes longitude",searchPattern:k,substitution:{input:r=>_(r),output:r=>g(r)}},{alias:"D",description:"seconds longitude",searchPattern:k,substitution:{input:r=>_(r),output:r=>g(r)}},{alias:i.abbreviatedDirections.east,description:"east/west indicator",searchPattern:I,substitution:{input:r=>h[r],output:r=>i.abbreviatedDirections[A[r]]}}]:(S.name==="xy"||S.name==="basemap")&&(S.coordinateSegments=[{alias:"X",description:"easting",searchPattern:v,substitution:{input:r=>_(r),output:r=>g(r)}},{alias:"Y",description:"northing",searchPattern:v,substitution:{input:r=>_(r),output:r=>g(r)}}]),wt(V)){const r=t?N[V]:F[V];S.defaultPattern=r,S.currentPattern=r}})}function te(){const i=new RegExp("N|S","i"),e=new RegExp("E|W","i");return[new D({name:"basemap",coordinateSegments:[{alias:"X",description:"easting",searchPattern:H,substitution:{input:t=>_(t),output:t=>g(t)}},{alias:"Y",description:"northing",searchPattern:H,substitution:{input:t=>_(t),output:t=>g(t)}}],defaultPattern:"X, Y",viewModel:null}),new D({name:"dd",coordinateSegments:[{alias:"Y",description:"degrees latitude",searchPattern:new RegExp(`\\d{1,2}[\\.|\\${B}]?\\d*(?=\\D*?[N|S])`,"i"),substitution:{input:t=>_(t),output:t=>g(t)}},{alias:"N",description:"north/south indicator",searchPattern:i},{alias:"X",description:"degrees longitude",searchPattern:new RegExp(`\\d{1,3}[\\.|\\${B}]?\\d*(?=\\D*?[E|W|])`,"i"),substitution:{input:t=>_(t),output:t=>g(t)}},{alias:"E",description:"east/west indicator",searchPattern:e}],defaultPattern:`Y${w}N, X${w}E`,viewModel:null}),new D({name:"ddm",coordinateSegments:[{alias:"Y",description:"degrees latitude",searchPattern:new RegExp("\\d{1,2}(?=.*?\\s+.*?[N|S])","i"),substitution:{input:t=>_(t),output:t=>g(t)}},{alias:"A",description:"minutes latitude",searchPattern:new RegExp(`\\d{1,2}[\\.\\${B}]?\\d*(?=.*?[N|S])`,"i"),substitution:{input:t=>_(t),output:t=>g(t)}},{alias:"N",description:"north/south indicator",searchPattern:i},{alias:"X",description:"degrees longitude",searchPattern:new RegExp("\\d{1,3}(?=\\D*?\\s+.*?[E|W])","i"),substitution:{input:t=>_(t),output:t=>g(t)}},{alias:"B",description:"minutes longitude",searchPattern:new RegExp(`\\d{1,2}[\\.|\\|${B}]?\\d*(?=.*?[E|W])`,"i"),substitution:{input:t=>_(t),output:t=>g(t)}},{alias:"E",description:"east/west indicator",searchPattern:e}],defaultPattern:`Y${w} A'N, X${w} B'E`,viewModel:null}),new D({name:"dms",coordinateSegments:[{alias:"Y",description:"degrees latitude",searchPattern:new RegExp("\\d{1,2}(?=.*?\\s+.*?[N|S])","i"),substitution:{input:t=>_(t),output:t=>g(t)}},{alias:"A",description:"minutes latitude",searchPattern:new RegExp("\\d{1,2}(?=.*?[N|S])","i"),substitution:{input:t=>_(t),output:t=>g(t)}},{alias:"B",description:"seconds latitude",searchPattern:new RegExp(`\\d{1,2}[\\.|\\${B}]?\\d*(?=.*?[N|S])`,"i"),substitution:{input:t=>_(t),output:t=>g(t)}},{alias:"N",description:"north/south indicator",searchPattern:i},{alias:"X",description:"degrees longitude",searchPattern:new RegExp("\\d{1,3}(?=.*?\\s+.*?[E|W])","i"),substitution:{input:t=>_(t),output:t=>g(t)}},{alias:"C",description:"minutes longitude",searchPattern:new RegExp("\\d{1,2}(?=.*?[E|W])","i"),substitution:{input:t=>_(t),output:t=>g(t)}},{alias:"D",description:"seconds longitude",searchPattern:new RegExp(`\\d{1,2}[\\.|\\${B}]?\\d*(?=.*?[E|W])`,"i"),substitution:{input:t=>_(t),output:t=>g(t)}},{alias:"E",description:"east/west indicator",searchPattern:e}],defaultPattern:`Y${w} A' B"N, X${w} C' D"E`,viewModel:null}),new D({name:"xy",coordinateSegments:[{alias:"X",description:"longitude",searchPattern:H,substitution:{input:t=>_(t),output:t=>g(t)}},{alias:"Y",description:"latitude",searchPattern:H,substitution:{input:t=>_(t),output:t=>g(t)}}],defaultPattern:`X${w}, Y${w}`,viewModel:null}),new D({name:"mgrs",coordinateSegments:[{alias:"Z",description:"grid zone",searchPattern:/\d{1,2}\w|[abyz]/i},{alias:"S",description:"grid square",searchPattern:/\w{2}/},{alias:"X",description:"easting",searchPattern:/^\d{5}(?=.?\d{5}$)|^\d{4}(?=.?\d{4}$)|^\d{3}(?=.?\d{3}$)|^\d{2}(?=.?\d{2}$)|^\d(?=.?\d$)/},{alias:"Y",description:"northing",searchPattern:/^\d{1,5}/}],defaultPattern:"Z S X Y",viewModel:null}),new D({name:"usng",coordinateSegments:[{alias:"Z",description:"grid zone",searchPattern:/\d{1,2}\w|[abyz]/i},{alias:"S",description:"grid square",searchPattern:/\w{2}/},{alias:"X",description:"easting",searchPattern:/^\d{5}(?=.?\d{5}$)|^\d{4}(?=.?\d{4}$)|^\d{3}(?=.?\d{3}$)|^\d{2}(?=.?\d{2}$)|^\d(?=.?\d$)/},{alias:"Y",description:"northing",searchPattern:/^\d{1,5}/}],defaultPattern:"Z S X Y",viewModel:null}),new D({name:"utm",coordinateSegments:[{alias:"Z",description:"zone number",searchPattern:/\d{1,2}|[abyz]/i},{alias:"B",description:"latitude band",searchPattern:/^\D/},{alias:"X",description:"easting",searchPattern:/\d{1,7}(?=\s*\d{7}$)/},{alias:"Y",description:"northing",searchPattern:/\d{1,7}/}],defaultPattern:"ZB X Y",viewModel:null})]}function g(i){const e=i.match(Kt),t=e?e[0]:"",n=i.includes(".")?i.split(".")[1].length:0;return t+Vt(Number(i),{pattern:"###0.###",places:n,round:-1})}function _(i){return At(i)}const z={default:"default",crosshair:"crosshair"},ee=new G([0,0,500]),ie="xy",ne=["mgrs","utm","usng","dd","dms","ddm"],at="esri__coordinateConversionWidgetState",M={conversions:"conversions",formats:"formats",view:"view",viewChange:"view-change"},se="esri/images/search/search-symbol-32.png";let P=class extends Ot(St.EventedAccessor){constructor(e){super(e),this._conversionPromise=null,this._locationGraphic=null,this._pointerCount=0,this.conversions=new U,this.formats=new U,this.formatterAvailable=!1,this.messages=null,this.filteredFormats=new U,this.locationSymbol=new xt({url:Mt(se),width:24,height:24}),this.storageEnabled=!0,this.storageType="session",this.view=null,this._saveWidgetState=this._saveWidgetState.bind(this),this._handleFormatChange=this._handleFormatChange.bind(this),this._handleConversionChange=this._handleConversionChange.bind(this),this._handleViewChange=this._handleViewChange.bind(this),this._onClick=this._onClick.bind(this),this._onPointerMove=this._onPointerMove.bind(this),this._onPointerDown=this._onPointerDown.bind(this),this._onPointerUp=this._onPointerUp.bind(this)}initialize(){const e=async()=>this.messages=await Rt("esri/widgets/CoordinateConversion/t9n/CoordinateConversion");this.formats.addMany(te()),e().then(()=>{if(!this.destroyed&&(rt(this.messages,this.formats),this.storageEnabled&&this._loadWidgetState(),this.formats.forEach(t=>{t.viewModel=this,this.addHandles(K(()=>t.currentPattern,this._saveWidgetState),t.name??"unnamed-format")}),this.addHandles(this.conversions.on("change",this._handleConversionChange),M.conversions),this.addHandles(this.formats.on("change",this._handleFormatChange),M.formats),this.addHandles(Et(()=>{e().then(()=>{rt(this.messages,this.formats)})})),Tt().then(()=>{this.formatterAvailable=!0}).catch(t=>{W.getLogger(this).error(new $("coordinate-conversion:projection-load-failed","Failed to load the projection module.",{error:t})),this.formatterAvailable=!1,this._filterFormatsAndConversions()}).then(()=>this.addHandles(K(()=>this.view,this._handleViewChange,It),M.viewChange)),this.conversions.length===0)){const t=this.formats.find(n=>n.name===ie)||this.formats.at(0);this.conversions.add(new Y({format:t}))}})}destroy(){this.removeHandles(),this._cleanUpView(this.view),this.view=null}castConversions(e){return this._castToConversions(e)}set currentLocation(e){this._set("currentLocation",e),this._updateConversions()}get currentLocation(){return this._get("currentLocation")||null}set mode(e){switch(e){case"capture":this.currentLocation=null,this._startCaptureMode(),this._set("mode",e);break;case"live":this._startLiveMode(),this._set("mode",e)}}get mode(){return this._get("mode")||"live"}get state(){const{messages:e,view:t}=this,n=t==null?void 0:t.ready;return e?n?"ready":t?"loading":"disabled":"disabled"}get storage(){const{storageType:e}=this;return e==="session"?sessionStorage:localStorage}get waitingForConversions(){return this._conversionPromise!=null}setLocation(e){var n,s;if(this._locationGraphic&&((n=this.view)==null||n.graphics.remove(this._locationGraphic)),!e)return;const t=e.clone();t.hasZ&&(t.z=void 0),this._locationGraphic=new kt({geometry:t,symbol:this.locationSymbol}),(s=this.view)==null||s.graphics.add(this._locationGraphic)}async convert(e,t){if(!et(t))throw new $("coordinate-conversion:invalid-point","Invalid point cannot be converted.",{point:t});return Promise.resolve().then(()=>e.convert(t))}async goToLocation(e){var o,l,c;const{view:t}=this;if(!t)throw new $("coordinate-conversion:go-to-failed","no view");const n=t.type==="3d"?t.clippingArea:null,s=(l=(o=t.map)==null?void 0:o.basemap)==null?void 0:l.baseLayers;if(n||(s==null?void 0:s.length)>0){const h=n??((c=s.at(0))==null?void 0:c.fullExtent);if(h!=null&&!h.contains(e))throw new $("coordinate-conversion:go-to-failed","Point outside basemap extent.",{point:e})}return this.callGoTo({target:e})}pause(){this.currentLocation=null,this.removeHandles(M.view),this.view&&(this.view.cursor=z.default,this._locationGraphic&&this.view.graphics.remove(this._locationGraphic))}async previewConversion(e,t=this.currentLocation||ee){return(await lt(e,t)).displayCoordinate}resume(){this.mode==="capture"?this._startCaptureMode():this._startLiveMode()}reverseConvert(e,t){return t.reverseConvert(e)}async updateConversions(e,t){if((t==null?void 0:t.type)!=="point")throw this._clearConversions(this.conversions),new $("coordinate-conversion:invalid-input-point","Point is invalid, conversions cannot be updated.",{point:t});return this._convertMany(e,t)}_castToConversions(e){const t=new U;return e.forEach(n=>{let s=null;if(n instanceof Y)s=n;else if(typeof n=="string"){const o=this.formats.find(l=>l.name===n);o&&(s=new Y({format:o}))}s&&t.add(s)}),t}_cleanUpView(e){e&&(this._locationGraphic&&e.graphics.remove(this._locationGraphic),this.removeHandles(M.view),e.cursor=z.default)}_clearConversions(e){e.forEach(t=>{t.position={location:null,coordinate:null}})}async _convertMany(e,t){return Promise.all(e.map(n=>lt(n,t)))}_handleConversionChange(e){for(const t of e.added){const{format:n}=t;n&&(n.viewModel=this,this.currentLocation&&(this._set("waitingForConversions",!0),this.convert(n,this.currentLocation).then(s=>{t.position=s,this._set("waitingForConversions",!1)})))}this._saveWidgetState()}_handleFormatChange(e){e.added.forEach(t=>{this.addHandles(K(()=>t.currentPattern,this._saveWidgetState),t.name??"unnamed-format"),t.viewModel=this}),e.removed.forEach(t=>{t.viewModel=null;const n=this.conversions.filter(s=>s.format===t);this.conversions.removeMany(n),t.name&&this.removeHandles(t.name)})}_loadWidgetState(){try{const e=JSON.parse(this.storage.getItem(at));e&&this._setWidgetState(e)}catch(e){W.getLogger(this).error(new $("coordinate-conversion:invalid-session-storage-json","Could not read from storage.",{error:e}))}}_startCaptureMode(){this.removeHandles(M.view),this.view&&(this.view.cursor=z.crosshair,this.currentLocation&&this.setLocation(this.currentLocation),this.addHandles(this.view.on("click",this._onClick),M.view))}_startLiveMode(){this._pointerCount=0,this.removeHandles(M.view),this.view&&(this.view.cursor=z.default,this._locationGraphic&&this.view.graphics.remove(this._locationGraphic),this.addHandles([this.view.on("pointer-down",this._onPointerDown),this.view.on("pointer-up",this._onPointerUp),this.view.on("pointer-move",this._onPointerMove)],M.view))}_handleViewChange(e,t){t&&t!==e&&this._cleanUpView(t),e&&(this.mode==="capture"?this._startCaptureMode():this._startLiveMode(),t&&this._filterFormatsAndConversions())}_onClick(e){var t;if(e.button===0){const n=(t=this.view)==null?void 0:t.toMap(e),s=n==null?void 0:n.normalize();this.setLocation(s),this.currentLocation=s}}_onPointerDown(e){var n;const{pointerType:t}=e;if(this._pointerCount++,(t==="touch"||t==="pen")&&this._pointerCount===1){const s=(n=this.view)==null?void 0:n.toMap(e);this.currentLocation=s==null?void 0:s.normalize()}}_onPointerMove(e){var n;const{pointerType:t}=e;if(t==="mouse"||this._pointerCount===1){const s=(n=this.view)==null?void 0:n.toMap(e);this.currentLocation=s==null?void 0:s.normalize()}}_onPointerUp(){this._pointerCount--}_setWidgetState(e){try{e.formats.forEach(t=>{const n=this.formats.find(s=>s.name===t.name);n&&e.locale===tt()&&t.currentPattern&&(n.currentPattern=t.currentPattern),n&&t.index>=0&&this.conversions.add(new Y({format:n}))})}catch(t){W.getLogger(this).warn(new $("coordinate-conversion:session-storage-read-error","Could not get widget state from stored JSON.",{error:t}))}}_saveWidgetState(){if(!this.storageEnabled)return;const e=this._toJSON();try{this.storage.setItem(at,JSON.stringify({formats:e,locale:tt()}))}catch(t){W.getLogger(this).error(new $("coordinate-conversion:local-storage-write-error","Could not write to localStorage.",{error:t}))}}async _updateConversions(){try{await this.updateConversions(this.conversions.toArray(),this.currentLocation)}catch{}}_toJSON(){return this.formats.filter(e=>{const t=e.name;return t==="xy"||t==="basemap"||Xt(t)}).map(e=>({name:e.name,currentPattern:e.currentPattern,defaultPattern:e.defaultPattern,index:this.conversions.findIndex(t=>t.format===e)})).sort((e,t)=>e.index-t.index).toArray()}_filterFormatsAndConversions(){const{formatterAvailable:e,conversions:t,formats:n}=this;e||this.addHandles(Dt(()=>{var s;return(s=this.view)==null?void 0:s.spatialReference},s=>{const o=s.isWebMercator||s.isWGS84,l=n.filter(v=>{const{name:y}=v;return!!oe(y)||y==="xy"&&!o}),c=this.filteredFormats.filter(v=>v.name==="xy"&&o&&!this.formats.includes(v)),h=t.filter(v=>l.includes(v.format));n.removeMany(l),t.removeMany(h),this.filteredFormats.addMany(l.filter(v=>!this.filteredFormats.includes(v))),n.addMany(c)},{once:!0,initial:!0}),M.view)}};async function lt(i,e){var t;try{i.position=await((t=i.format)==null?void 0:t.convert(e))}catch{i.position=null}return i}function oe(i){return ne.includes(i)}d([p()],P.prototype,"conversions",void 0),d([ht("conversions")],P.prototype,"castConversions",null),d([p({type:G})],P.prototype,"currentLocation",null),d([p()],P.prototype,"formats",void 0),d([p()],P.prototype,"messages",void 0),d([p()],P.prototype,"mode",null),d([p()],P.prototype,"filteredFormats",void 0),d([p({readOnly:!0})],P.prototype,"state",null),d([p()],P.prototype,"locationSymbol",void 0),d([p({readOnly:!0,dependsOn:["storageType"]})],P.prototype,"storage",null),d([p()],P.prototype,"storageEnabled",void 0),d([p()],P.prototype,"storageType",void 0),d([p({readOnly:!0})],P.prototype,"waitingForConversions",null),d([p()],P.prototype,"view",void 0),P=d([q("esri.widgets.CoordinateConversion.CoordinateConversionViewModel")],P);const bt=P,m="esri-coordinate-conversion",u={base:m,captureMode:`${m}--capture-mode`,noBasemap:`${m}--no-basemap`,popup:`${m}__popup`,clipboardPopup:`${m}__clipboard-popup`,conversionList:`${m}__conversion-list`,conversionRow:`${m}__row`,coordDisplay:`${m}__display`,expanded:`${m}__conversions-view--expanded`,expandDown:`${m}__conversions-view--expand-down`,expandUp:`${m}__conversions-view--expand-up`,conversionsView:`${m}__conversions-view`,primarySelect:`${m}__select-primary`,rowSelect:`${m}__select-row`,toolDisplay:`${m}__tools`,modeToggle:`${m}__mode-toggle`,rowButton:`${m}__row-button`,backButton:`${m}__back-button`,convertButton:`${m}__button`,convertButtonSpan:`${m}__convert-button-span`,coordinateInput:`${m}__input-coordinate`,inputForm:`${m}__input-form`,inputFormGroup:`${m}__input-group`,rejectInput:`${m}__input-coordinate--rejected`,sectionHeading:`${m}__heading`,patternInput:`${m}__pattern-input`,settings:`${m}__settings`,settingsFormGroup:`${m}__settings-group`,settingsFormGroupHorizontal:`${m}__settings-group-horizontal`,previewCoordinate:`${m}__preview-coordinate`},dt={settingsButton:!0,inputButton:!0,captureButton:!0,expandButton:!0},re=750,ae=2500;let b=class extends Lt{constructor(i,e){super(i,e),this._popupMessage=null,this._popupTimeoutId=void 0,this._clipboardPopupTimeoutId=void 0,this._coordinateInput=null,this._badInput=!1,this._goToEnabled=!1,this._conversionFormat=null,this._settingsFormat=null,this._previewConversion=null,this._expanded=!1,this._clipboardPopupVisible=!1,this._popupVisible=!1,this._settingsVisible=!1,this._inputVisible=!1,this.headingLevel=4,this.messages=null,this.messagesCommon=null,this.orientation="auto",this.viewModel=new bt,this.visibleElements={...dt}}get conversions(){return this.viewModel.conversions}set conversions(i){this.viewModel.conversions=i}get currentLocation(){return this.viewModel.currentLocation}set currentLocation(i){this.viewModel.currentLocation=i}get formats(){return this.viewModel.formats}set formats(i){this.viewModel.formats=i}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(i){this.viewModel.goToOverride=i}get label(){var i;return((i=this.messages)==null?void 0:i.widgetLabel)??""}set label(i){this._overrideIfSome("label",i)}get mode(){return this.viewModel.mode}set mode(i){this.viewModel.mode=i}set multipleConversions(i){i===!1&&(this._expanded=!1,this.conversions.splice(1,this.conversions.length-1)),this._set("multipleConversions",i)}get multipleConversions(){const i=this._get("multipleConversions");return typeof i!="boolean"||i}get locationSymbol(){return this.viewModel.locationSymbol}set locationSymbol(i){this.viewModel.locationSymbol=i}get storageEnabled(){return this.viewModel.storageEnabled}set storageEnabled(i){this.viewModel.storageEnabled=i}get storageType(){return this.viewModel.storageType}set storageType(i){this.viewModel.storageType=i}get view(){return this.viewModel.view}set view(i){this.viewModel.view=i}castVisibleElements(i){return{...dt,...i}}reverseConvert(i,e){return this.viewModel.reverseConvert(i,e)}render(){var c,h;const i=(c=this.viewModel)==null?void 0:c.state,e=i==="disabled"?a("div",{key:"esri-coordinate__no-basemap"},(h=this.messages)==null?void 0:h.noBasemap):null,t=!e&&this._inputVisible?this._renderInputForm():null,n=!e&&this._settingsVisible?this._renderSettings():null,s=e||t||n?null:this._renderConversionsView(),o=this._popupVisible?this._renderPopup():null,l={[u.captureMode]:this.mode==="capture",[f.disabled]:i==="loading",[u.noBasemap]:i==="disabled"};return a("div",{class:this.classes(u.base,f.widget,l)},o,e,s,n,t)}_addConversion(i){const e=i.target,t=j(e.options[e.options.selectedIndex]),n=ct(e);if(t==null||n==null)return;const s=new Y({format:t});e.options.selectedIndex=0,n>=0?(this.conversions.removeAt(n),this.conversions.add(s,n)):this.conversions.add(s)}_findSettingsFormat(){return this._settingsFormat||this.conversions.reduceRight((i,e)=>{const t=e.format;return t!=null&&t.hasDisplayProperties?t:i},null)||this.formats.find(i=>i.hasDisplayProperties)}_hidePopup(){this._popupTimeoutId&&(clearTimeout(this._popupTimeoutId),this._popupTimeoutId=void 0),this._popupVisible=!1,this._popupMessage=null,this.scheduleRender()}_hideClipboardPopup(){this._clipboardPopupTimeoutId&&(clearTimeout(this._clipboardPopupTimeoutId),this._clipboardPopupTimeoutId=void 0),this._clipboardPopupVisible=!1,this.scheduleRender()}_onConvertComplete(){this._inputVisible=!1,this._coordinateInput.value=""}_onCopy(i){var t,n;const e=(t=le(i.currentTarget))==null?void 0:t.displayCoordinate;e!=null&&((n=i.clipboardData)==null||n.setData("text/plain",e),this._showClipboardPopup(),i.preventDefault())}_processUserInput(i){const e=Ft(i),t=this.viewModel;if(e!=="Enter"&&e)this._badInput&&(this._badInput=!1);else{const n=j(this._coordinateInput);if(!n)return;const s=this._coordinateInput.value;this._reverseConvert(s,n).then(o=>{this.mode==="capture"?t.resume():this.mode="capture",this.currentLocation=o,t.setLocation(o),this._onConvertComplete()}).catch(o=>{var l;W.getLogger(this).error(o),this._showPopup((l=this.messages)==null?void 0:l.invalidCoordinate),this._badInput=!0})}}async _reverseConvert(i,e){const t=this.viewModel,n=await e.reverseConvert(i);return this._goToEnabled&&n&&t.goToLocation(n).catch(s=>{var o;W.getLogger(this).warn(s),this._showPopup((o=this.messages)==null?void 0:o.locationOffBasemap)}),n}_setInputFormat(i){const e=i.target,t=j(e[e.options.selectedIndex]);t!=null&&(this._conversionFormat=t)}_setPreviewConversion(){var t,n;const i=this._findSettingsFormat(),e=this.viewModel;if(i){const s=this.conversions.find(o=>o.format===i);this._previewConversion=new Y({format:i,position:{location:this.currentLocation,coordinate:(t=s==null?void 0:s.position)==null?void 0:t.coordinate}}),(n=this._previewConversion.position)!=null&&n.coordinate||e.previewConversion(this._previewConversion)}}_setSettingsFormat(i){const e=i.target,t=j(e[e.options.selectedIndex]);t!=null&&(this._settingsFormat=t,this._setPreviewConversion())}_showClipboardPopup(){this._clipboardPopupVisible?clearTimeout(this._clipboardPopupTimeoutId):this._clipboardPopupVisible=!0,this.scheduleRender(),this._popupTimeoutId=setTimeout(()=>{this._popupTimeoutId=void 0,this._hideClipboardPopup()},re)}_showPopup(i,e=ae){this._popupMessage=i,this._popupVisible?clearTimeout(this._popupTimeoutId):this._popupVisible=!0,this.scheduleRender(),this._popupTimeoutId=setTimeout(()=>{this._popupTimeoutId=void 0,this._hidePopup()},e)}_toggleGoTo(){this._goToEnabled=!this._goToEnabled}_updateCurrentPattern(i){i.stopPropagation();const e=i.target,t=this._findSettingsFormat();t&&(t.currentPattern=e.value)}_renderConversion(i,e){const{messages:t}=this;if(!t)return a("li",null);const{format:n}=i,s=(n==null?void 0:n.label)??"",o=`${this.id}__list-item-${e}`,l=`${s} ${t.conversionOutputSuffix}`,c=e===0,h=c||this._expanded,v=c?this._renderFirstConversion(i):this._renderTools(e,i,o),y=c&&!i.displayCoordinate?t.noLocation:i.displayCoordinate,I=a("div",{"aria-label":y,class:u.coordDisplay,"data-conversion":i,role:"listitem",tabIndex:0,title:y??""},y),F=this._renderOptions(this.formats.filter(N=>N!==n));return h?a("li",{"aria-label":l,class:u.conversionRow,id:o,key:i,role:"group",tabIndex:0,title:l},a("select",{"aria-controls":o,"aria-label":t.selectFormat,bind:this,class:this.classes(f.select,u.rowSelect),"data-index":e,onchange:this._addConversion,title:t.selectFormat},a("option",{"aria-label":s,selected:!0,title:s},s.toUpperCase()),F),I,v):null}_renderCopyButton(i){const e=this._clipboardPopupVisible&&this._renderClipboardPopup(),{messagesCommon:t}=this;return t?a("li",{"aria-label":t.copy,bind:this,class:this.classes(f.widgetButton,u.rowButton),"data-conversion":i,onclick:this._copyCoordinateOutput,oncopy:this._onCopy,onkeydown:this._copyCoordinateOutput,role:"button",tabIndex:0,title:t.copy},e,a("span",{"aria-hidden":"true",class:x.duplicate})):a("li",null)}_renderFirstConversion(i){const e=this.id,t={[x.down]:!this._expanded,[x.up]:this._expanded},{messages:n,messagesCommon:s,multipleConversions:o,visibleElements:l}=this;if(!s||!n)return a("ul",null);const c=this.mode==="live"?n.captureMode:n.liveMode,h=this._expanded?s.collapse:s.expand,v=i.displayCoordinate&&this.mode==="capture"?this._renderCopyButton(i):null,y=o&&l.expandButton&&a("li",{"aria-controls":`${e}__${u.conversionList}`,"aria-label":h,bind:this,class:f.widgetButton,key:"esri-coordinate-conversion__expand-button",onclick:this._toggleExpand,onkeydown:this._toggleExpand,role:"button",tabIndex:0,title:h},a("span",{"aria-hidden":"true",class:this.classes(t)})),I=!o&&l.captureButton&&a("li",{"aria-label":c,bind:this,class:this.classes(f.widgetButton,u.modeToggle),key:"esri-coordinate-conversion__mode-toggle",onclick:this._toggleMode,onkeydown:this._toggleMode,role:"button",tabIndex:0,title:c},a("span",{"aria-hidden":"true",class:x.mapPin}));return a("ul",{class:u.toolDisplay},v,y,I)}_renderInputForm(){const i=this._conversionFormat||this.conversions.at(0).format,e=this.formats.findIndex(y=>y.name===(i==null?void 0:i.name)),t=this.id,n=`${t}__${u.coordinateInput}`,s=`${t}__${u.coordinateInput}__header`,o=this._renderOptions(this.formats,!0,e),l={[u.rejectInput]:this._badInput},{messages:c,messagesCommon:h,headingLevel:v}=this;return h&&c?a("div",{"aria-labelledby":s,class:u.inputForm,key:"esri-coordinate-conversion__input-form",role:"search"},a("div",{class:u.sectionHeading},a("div",{"aria-label":h.back,bind:this,class:this.classes(f.widgetButton,u.backButton),onclick:this._toggleInputVisibility,onkeydown:this._toggleInputVisibility,role:"button",tabIndex:0,title:h.back},this._renderBackIcon()),a(st,{class:f.heading,id:s,level:v},c.inputCoordTitle)),a("div",{class:u.inputFormGroup},a("select",{"aria-controls":n,"aria-label":c.selectFormat,bind:this,class:this.classes(f.select,u.rowSelect),onchange:this._setInputFormat,title:c.selectFormat},o),a("input",{afterCreate:Bt,"aria-labelledby":s,"aria-required":"true",bind:this,class:this.classes(u.coordinateInput,f.input,l),"data-format":i,"data-node-ref":"_coordinateInput",id:n,onkeydown:this._processUserInput,placeholder:c.inputCoordTitle,role:"textbox",spellcheck:!1,title:c.inputCoordTitle,type:"text"})),a("div",{class:u.inputFormGroup},a("label",{"aria-label":c.goTo},a("input",{bind:this,checked:this._goToEnabled,onclick:this._toggleGoTo,title:c.goTo,type:"checkbox"}),c.goTo),a("button",{"aria-label":c.convert,bind:this,class:this.classes(u.convertButton,f.button),onclick:this._processUserInput,title:c.convert,type:"button"},a("span",{class:u.convertButtonSpan},c.convert)))):a("div",null)}_renderConversionsView(){const{messages:i}=this;if(!i)return a("div",null);const e=`${this.id}__${u.conversionList}`,t=this._renderPrimaryTools(),n=this._renderOptions(this.formats),s=this.conversions.map((c,h)=>this._renderConversion(c,h)).toArray(),o=this._expanded?a("div",{class:u.conversionRow},a("select",{"aria-controls":e,"aria-label":i.addConversion,bind:this,class:this.classes(f.select,u.primarySelect),"data-index":-1,onchange:this._addConversion,title:i.addConversion},a("option",{disabled:!0,selected:!0,value:""},i.addConversion),n),t):null,l={[u.expanded]:this._expanded,[u.expandUp]:this.orientation==="expand-up",[u.expandDown]:this.orientation==="expand-down"};return a("div",{class:this.classes(u.conversionsView,l),key:"esri-coordinate-conversion__main-view"},a("ul",{"aria-expanded":this._expanded?"true":"false",class:u.conversionList,id:e},s),o)}_renderOptions(i,e,t){var o;const n=this.conversions.at(0),s=(o=n.format)==null?void 0:o.name;return i.map((l,c)=>{const h=!(e||!n)&&(s===l.name||this.conversions.map(v=>{var y;return(y=v.format)==null?void 0:y.name}).includes(l.name));return a("option",{"aria-label":l.label,"data-format":l,disabled:h,key:l.name??"unnamed-format",selected:c===t,value:l.label},l.label.toUpperCase())}).toArray()}_renderPopup(){return a("div",{class:u.popup,role:"alert"},this._popupMessage)}_renderClipboardPopup(){const{messages:i}=this;return i?a("div",{class:this.classes(u.popup,u.clipboardPopup),role:"alert"},i.copySuccessMessage):a("div",null)}_renderPrimaryTools(){const{messages:i,visibleElements:e}=this;if(!i)return a("ul",null);const t=this.mode==="live"?i.captureMode:i.liveMode,n=e.inputButton&&a("li",{bind:this,class:f.widgetButton,onclick:this._toggleInputVisibility,onkeydown:this._toggleInputVisibility,role:"button",tabIndex:0,title:i.inputCoordTitle},a("span",{"aria-hidden":"true",class:x.edit})),s=e.captureButton&&a("li",{bind:this,class:this.classes(f.widgetButton,u.modeToggle),onclick:this._toggleMode,onkeydown:this._toggleMode,role:"button",tabIndex:0,title:t},a("span",{"aria-hidden":"true",class:x.mapPin})),o=e.settingsButton&&a("li",{bind:this,class:f.widgetButton,onclick:this._toggleSettingsVisibility,onkeydown:this._toggleSettingsVisibility,role:"button",tabIndex:0,title:i.settingsTitle},a("span",{"aria-hidden":"true",class:x.settings2}));return a("ul",{class:u.toolDisplay},n,s,o)}_renderSettings(){var F;const i=this.id,e=`${i}__${u.patternInput}`,t=`${i}__${u.patternInput}__header`,n=`${i}__${u.previewCoordinate}`,s=this.formats.filter(N=>N.hasDisplayProperties),o=this._findSettingsFormat(),l=o?s.indexOf(o):-1,c=this._renderOptions(s,!0,l),h=o==null?void 0:o.currentPattern,{messages:v,messagesCommon:y,headingLevel:I}=this;return y&&v?a("div",{"aria-labelledby":t,class:u.settings,key:u.settings},a("div",{class:u.sectionHeading},a("div",{bind:this,class:this.classes(f.widgetButton,u.backButton),onclick:this._toggleSettingsVisibility,onkeydown:this._toggleSettingsVisibility,role:"button",tabIndex:0,title:y.back},this._renderBackIcon()),a(st,{class:f.heading,id:t,level:I},v.settingsTitle)),a("div",{class:u.settingsFormGroup},a("label",{for:e},v.changeCoordinateDisplay),a("select",{"aria-label":v.selectFormat,bind:this,class:f.select,onchange:this._setSettingsFormat,title:v.selectFormat},c),a("div",{class:u.settingsFormGroupHorizontal},a("input",{"aria-controls":n,bind:this,class:this.classes(u.patternInput,f.input),id:e,oninput:this._updateCurrentPattern,spellcheck:!1,title:v.changeCoordinateDisplay,type:"text",value:h}),a("div",{"aria-controls":e,bind:this,class:f.widgetButton,onclick:this._setDefaultPattern,onkeydown:this._setDefaultPattern,role:"button",tabIndex:0,title:v.defaultPattern},a("span",{"aria-hidden":"true",class:x.refresh})))),a("div",{class:u.settingsFormGroup},a("label",null,y.preview,a("div",{class:u.previewCoordinate,id:n,tabIndex:0},(F=this._previewConversion)==null?void 0:F.displayCoordinate)))):a("div",null)}_renderBackIcon(){return a("span",{"aria-hidden":"true",class:Gt(this.container)?x.rightArrow:x.leftArrows})}_renderTools(i,e,t){const n=e.displayCoordinate&&this.mode==="capture"?this._renderCopyButton(e):null,{messages:s}=this;return s?a("ul",{class:u.toolDisplay,role:"listitem"},n,a("li",{"aria-controls":t,"aria-label":s.removeConversion,bind:this,class:this.classes(f.widgetButton,u.rowButton),"data-index":i,key:`${t}__${f.widgetButton}`,onclick:this._removeConversion,onkeydown:this._removeConversion,role:"button",tabIndex:0,title:s.removeConversion},a("span",{"aria-hidden":"true",class:x.close}))):a("ul",null)}_copyCoordinateOutput(i){const e=i.target;if(!("createTextRange"in document.body)){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t==null||t.removeAllRanges(),t==null||t.addRange(n)}document.execCommand("copy")}_removeConversion(i){const e=ct(i.currentTarget);e!=null&&this.conversions.removeAt(e)}_setDefaultPattern(i){i.stopPropagation();const e=this._findSettingsFormat();e&&(e.currentPattern=e.defaultPattern)}_toggleExpand(){this._expanded=!this._expanded}_toggleInputVisibility(){this._inputVisible=!this._inputVisible,this._popupVisible&&this._hidePopup(),this._inputVisible?this.viewModel.pause():this.viewModel.resume()}_toggleMode(){this.mode=this.mode==="live"?"capture":"live"}_toggleSettingsVisibility(){this._settingsVisible=!this._settingsVisible,this._popupVisible&&this._hidePopup(),this._settingsVisible?(this._setPreviewConversion(),this.viewModel.pause()):this.viewModel.resume()}};function ct(i){return i["data-index"]}function j(i){return i["data-format"]}function le(i){return i["data-conversion"]}d([p()],b.prototype,"conversions",null),d([p()],b.prototype,"currentLocation",null),d([p()],b.prototype,"formats",null),d([p()],b.prototype,"goToOverride",null),d([p()],b.prototype,"headingLevel",void 0),d([p()],b.prototype,"label",null),d([p(),nt("esri/widgets/CoordinateConversion/t9n/CoordinateConversion")],b.prototype,"messages",void 0),d([p(),nt("esri/t9n/common")],b.prototype,"messagesCommon",void 0),d([p()],b.prototype,"mode",null),d([p()],b.prototype,"orientation",void 0),d([p()],b.prototype,"multipleConversions",null),d([p()],b.prototype,"locationSymbol",null),d([p()],b.prototype,"storageEnabled",null),d([p()],b.prototype,"storageType",null),d([p()],b.prototype,"view",null),d([p({type:bt})],b.prototype,"viewModel",void 0),d([p()],b.prototype,"visibleElements",void 0),d([ht("visibleElements")],b.prototype,"castVisibleElements",null),d([L()],b.prototype,"_copyCoordinateOutput",null),d([L()],b.prototype,"_removeConversion",null),d([L()],b.prototype,"_setDefaultPattern",null),d([L()],b.prototype,"_toggleExpand",null),d([L()],b.prototype,"_toggleInputVisibility",null),d([L()],b.prototype,"_toggleMode",null),d([L()],b.prototype,"_toggleSettingsVisibility",null),b=d([q("esri.widgets.CoordinateConversion")],b);const fe=b;export{fe as default};
