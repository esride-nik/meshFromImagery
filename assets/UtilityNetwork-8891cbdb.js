import{a5 as t,a6 as o,a9 as b,ae as M,ab as ve,dx as fe,v as Q,iL as be,e3 as je,S as pe,s as oe,_ as j,a2 as Ne,U as Te,al as _e,an as Ee,I as ke,p as ce,ah as Ie,eH as Oe,fP as Re,M as Ce,ch as ie,dY as Ue,a7 as $e,io as Ae,bA as Ve,D as Pe,E as Le,C as Fe}from"./index-b516d057.js";import xe from"./FeatureLayer-c4c5819f.js";import{r as Se}from"./featureQueryAll-40af0622.js";import{g as ye,a as le,l as Je,b as De,r as me,c as he}from"./EditBusLayer-caf9fed8.js";import{b as Ge}from"./Query-071039d7.js";let A=class extends M{constructor(r){super(r),this.moment=null,this.fullUpdate=!1,this.validateErrorsCreated=!1,this.dirtyAreaCount=null,this.exceededTransferLimit=null,this.serviceEdits=null,this.discoveredSubnetworks=null}};t([o({type:Date,json:{type:Number,write:{writer:(e,r)=>{r.moment=e?e.getTime():null}}}})],A.prototype,"moment",void 0),t([o({type:Boolean,json:{write:!0}})],A.prototype,"fullUpdate",void 0),t([o({type:Boolean,json:{write:!0}})],A.prototype,"validateErrorsCreated",void 0),t([o({type:Number,json:{write:!0}})],A.prototype,"dirtyAreaCount",void 0),t([o({type:Boolean,json:{write:!0}})],A.prototype,"exceededTransferLimit",void 0),t([o({type:[Object],json:{write:!0}})],A.prototype,"serviceEdits",void 0),t([o({type:[Object],json:{write:!0}})],A.prototype,"discoveredSubnetworks",void 0),A=t([b("esri.rest.networks.support.ValidateNetworkTopologyResult")],A);const Be=A,Me=ve()({Pending:"job-waiting",InProgress:"job-executing",Completed:"job-succeeded"});let G=class extends Be{constructor(r){super(r),this.statusUrl=null,this.status=null,this.submissionTime=null,this.lastUpdatedTime=null,this._timer=void 0}destroy(){clearInterval(this._timer)}async checkJobStatus(r){const i={...r,query:{f:"json"}},{data:s}=await Q(this.statusUrl,i);return this.read(s),this.editsResolver&&this.editsResolver.resolve({edits:null,addedFeatures:[],updatedFeatures:[],deletedFeatures:[],addedAttachments:[],updatedAttachments:[],deletedAttachments:[],exceededTransferLimit:!0,historicMoment:null}),this}async waitForJobCompletion(r={}){const{interval:i=1e3,statusCallback:s}=r;return new Promise((n,l)=>{this._clearTimer();const a=setInterval(()=>{this._timer||l(be()),this.checkJobStatus().then(u=>{const{status:d}=u;switch(this.status=d,d){case"job-succeeded":this._clearTimer(),n(this);break;case"job-waiting":case"job-executing":s&&s(this)}},u=>{this._clearTimer(),l(u)})},i);this._timer=a})}_clearTimer(){clearInterval(this._timer),this._timer=void 0}};t([o()],G.prototype,"editsResolver",void 0),t([o({type:String,json:{write:!0}})],G.prototype,"statusUrl",void 0),t([fe(Me)],G.prototype,"status",void 0),t([o({type:Date,json:{type:Number,write:{writer:(e,r)=>{r.submissionTime=e?e.getTime():null}}}})],G.prototype,"submissionTime",void 0),t([o({type:Date,json:{type:Number,write:{writer:(e,r)=>{r.lastUpdatedTime=e?e.getTime():null}}}})],G.prototype,"lastUpdatedTime",void 0),G=t([b("esri.networks.support.TopologyValidationJobInfo")],G);const qe=G;function mt(e,r){const i=[],s=new Map;for(const l of r){const a=e.getLayerIdBySourceId(l.networkSourceId);if(a==null)continue;let u=s.get(a);u===void 0&&(u=[]),u.push(l.objectId),s.set(a,u)}const n=e.featureServiceUrl;return s.forEach((l,a)=>i.push({layerUrl:`${n}/${a}`,objectIds:l})),i}async function ht(e,r){const i=e.layers,s=e.layerInfos,n=e.returnGeometry||!1,l=e.outSpatialReference;return await Promise.all(i.map(async a=>{await a.load()})),(await Promise.all(i.map(async a=>{var v;const u=s.find(I=>{var m;return I.layerUrl===((m=a.parsedUrl)==null?void 0:m.path)});if(!((v=u==null?void 0:u.objectIds)!=null&&v.length))return{layer:a,featureSet:void 0};const d=a.createQuery();d.returnGeometry=n,d.outFields=u.outFields||["*"],d.outSpatialReference=l,d.gdbVersion=a.gdbVersion,d.objectIds=u.objectIds,r&&(d.where="1=1");const T=je.fromJSON(await Se(a,d));return{layer:a,featureSet:T}}))).filter(a=>a.featureSet!==void 0)}async function ge(e,r){if(e==="Utility Network Layer"){const{default:i}=await j(()=>Promise.resolve().then(()=>nt),void 0);return new i({layerUrl:r})}return null}async function He(e){var a;let r="portalItem"in e?e:{portalItem:e};!r.portalItem||r.portalItem instanceof pe||(r={...r,portalItem:new pe(r.portalItem)});const i=r.portalItem;if(await i.load(),i.type!=="Feature Service")throw new oe("portal:unknown-item-type","Unknown item type '${type}'",{type:i.type});const s=i.url,n=await Q(s,{responseType:"json",query:{f:"json"}}),l="Network Layer";if((a=n.data.type)!=null&&a.includes(l))return ge(n.data.type,s);if(n.data.layers){const u=n.data.layers.find(d=>d.type.includes(l));if(u){const d=`${s}/${u.id}`;return ge(u.type,d)}}return null}let h=class extends Ne(Te){static fromPortalItem(e){return He(e)}constructor(e){super(e),this.id=null,this.title=null,this.layerUrl=null,this.dataElement=null,this.fullExtent=null,this.spatialReference=null,this.type=null,this.sourceJSON=null,this.gdbVersion=null,this.historicMoment=null,this._applyEditsHandler=r=>{const{serviceUrl:i,gdbVersion:s,result:n}=r,l=i===this.featureServiceUrl,a=ye(i,s,this.gdbVersion);l&&a&&n.then(u=>{le(i,s)&&(this.historicMoment=u.historicMoment)})},this._updateMomentHandler=r=>{const{serviceUrl:i,gdbVersion:s,moment:n}=r,l=i===this.featureServiceUrl,a=ye(i,s,this.gdbVersion);l&&a&&(this.historicMoment=n)},this.when().then(()=>{this.addHandles([Je(this._applyEditsHandler),De(this._updateMomentHandler)])},()=>{})}initialize(){this.when().catch(e=>{_e(e)||Ee.getLogger(this).error("#load()",`Failed to load layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}')`,{error:e})})}get datasetName(){var e;return((e=this.dataElement)==null?void 0:e.name)??null}get owner(){var e;return((e=this.dataElement)==null?void 0:e.userIdentity)??null}get schemaGeneration(){var e;return((e=this.dataElement)==null?void 0:e.schemaGeneration)??null}get parsedUrl(){return ke(this.layerUrl)}get featureServiceUrl(){return ce(this.parsedUrl.path).url.path}get networkServiceUrl(){return this.featureServiceUrl.replace(/\/FeatureServer/i,"/UtilityNetworkServer")}get layerId(){return ce(this.parsedUrl.path).sublayer}get networkSystemLayers(){return null}async load(e){return this.addResolvingPromise(this._fetchDataElement(this.featureServiceUrl,this.layerId.toString(),e)),this.addResolvingPromise(this._fetchLayerMetaData(this.layerUrl,e)),this}getLayerIdBySourceId(e){if(this.dataElement){const r=this.dataElement.domainNetworks;for(const i of r){for(const s of i.edgeSources??[])if(s.sourceId===e)return s.layerId;for(const s of i.junctionSources??[])if(s.sourceId===e)return s.layerId}return null}return null}async queryNamedTraceConfigurations(e,r){var a;const[{queryNamedTraceConfigurations:i},{default:s}]=await Promise.all([j(()=>import("./queryNamedTraceConfigurations-f57be739.js"),["assets/queryNamedTraceConfigurations-f57be739.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/FeatureLayer-c4c5819f.js","assets/jsonUtils-52514725.js","assets/DictionaryLoader-e327eff9.js","assets/Version-1f969b2a.js","assets/FieldsIndex-e8db657f.js","assets/UnknownTimeZone-a05df022.js","assets/HeatmapColorStop-3fff4333.js","assets/heatmapUtils-7f42325f.js","assets/FeatureLayerBase-0746b503.js","assets/HeightModelInfo-b816d32b.js","assets/featureLayerUtils-16361d1f.js","assets/featureQueryAll-40af0622.js","assets/Query-071039d7.js","assets/FullTextSearch-12e0754c.js","assets/QuantizationParameters-f983cf8d.js","assets/AttachmentQuery-bede5a71.js","assets/RelationshipQuery-2c9e4485.js","assets/LayerFloorInfo-4234db4d.js","assets/serviceCapabilitiesUtils-42d4d20c.js","assets/editsZScale-e45bb69c.js","assets/queryZScale-d7a48772.js","assets/APIKeyMixin-bfb00271.js","assets/EditBusLayer-caf9fed8.js","assets/uuid-709b6c67.js","assets/FeatureEffectLayer-1948d1a0.js","assets/FeatureEffect-c80bb16d.js","assets/FeatureFilter-55dd341e.js","assets/FeatureReductionLayer-443167bc.js","assets/clusterUtils-50a66940.js","assets/MD5-715f37cd.js","assets/FeatureReductionSelection-d84c375a.js","assets/LabelClass-c3c309a8.js","assets/labelUtils-b29175f3.js","assets/defaults-4faa92e6.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-32293fe1.js","assets/FeatureTemplate-d1d1c7be.js","assets/FeatureType-f30c4b8b.js","assets/fieldProperties-8c831c84.js","assets/labelingInfo-aae625ac.js","assets/versionUtils-5892620e.js","assets/styleUtils-a3d96bf6.js","assets/TopFeaturesQuery-6d0bf5f5.js"]),j(()=>import("./QueryNamedTraceConfigurationsParameters-2d4c4188.js"),["assets/QueryNamedTraceConfigurationsParameters-2d4c4188.js","assets/index-b516d057.js","assets/index-b252abd2.css"])]),n=this.networkServiceUrl,l=s.from(e);return(a=await i(n,l,{...r}))==null?void 0:a.namedTraceConfigurations}async validateTopology(e,r){var T,v,I;if(!e.validateArea)throw new oe("network:undefined-validateArea","the network must have validateArea defined in the validate network topology parameters.");const[{validateNetworkTopology:i},{default:s}]=await Promise.all([j(()=>import("./validateNetworkTopology-cd46602b.js"),["assets/validateNetworkTopology-cd46602b.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/FeatureLayer-c4c5819f.js","assets/jsonUtils-52514725.js","assets/DictionaryLoader-e327eff9.js","assets/Version-1f969b2a.js","assets/FieldsIndex-e8db657f.js","assets/UnknownTimeZone-a05df022.js","assets/HeatmapColorStop-3fff4333.js","assets/heatmapUtils-7f42325f.js","assets/FeatureLayerBase-0746b503.js","assets/HeightModelInfo-b816d32b.js","assets/featureLayerUtils-16361d1f.js","assets/featureQueryAll-40af0622.js","assets/Query-071039d7.js","assets/FullTextSearch-12e0754c.js","assets/QuantizationParameters-f983cf8d.js","assets/AttachmentQuery-bede5a71.js","assets/RelationshipQuery-2c9e4485.js","assets/LayerFloorInfo-4234db4d.js","assets/serviceCapabilitiesUtils-42d4d20c.js","assets/editsZScale-e45bb69c.js","assets/queryZScale-d7a48772.js","assets/APIKeyMixin-bfb00271.js","assets/EditBusLayer-caf9fed8.js","assets/uuid-709b6c67.js","assets/FeatureEffectLayer-1948d1a0.js","assets/FeatureEffect-c80bb16d.js","assets/FeatureFilter-55dd341e.js","assets/FeatureReductionLayer-443167bc.js","assets/clusterUtils-50a66940.js","assets/MD5-715f37cd.js","assets/FeatureReductionSelection-d84c375a.js","assets/LabelClass-c3c309a8.js","assets/labelUtils-b29175f3.js","assets/defaults-4faa92e6.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-32293fe1.js","assets/FeatureTemplate-d1d1c7be.js","assets/FeatureType-f30c4b8b.js","assets/fieldProperties-8c831c84.js","assets/labelingInfo-aae625ac.js","assets/versionUtils-5892620e.js","assets/styleUtils-a3d96bf6.js","assets/TopFeaturesQuery-6d0bf5f5.js"]),j(()=>import("./ValidateNetworkTopologyParameters-4cfdfa18.js"),["assets/ValidateNetworkTopologyParameters-4cfdfa18.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/FeatureLayer-c4c5819f.js","assets/jsonUtils-52514725.js","assets/DictionaryLoader-e327eff9.js","assets/Version-1f969b2a.js","assets/FieldsIndex-e8db657f.js","assets/UnknownTimeZone-a05df022.js","assets/HeatmapColorStop-3fff4333.js","assets/heatmapUtils-7f42325f.js","assets/FeatureLayerBase-0746b503.js","assets/HeightModelInfo-b816d32b.js","assets/featureLayerUtils-16361d1f.js","assets/featureQueryAll-40af0622.js","assets/Query-071039d7.js","assets/FullTextSearch-12e0754c.js","assets/QuantizationParameters-f983cf8d.js","assets/AttachmentQuery-bede5a71.js","assets/RelationshipQuery-2c9e4485.js","assets/LayerFloorInfo-4234db4d.js","assets/serviceCapabilitiesUtils-42d4d20c.js","assets/editsZScale-e45bb69c.js","assets/queryZScale-d7a48772.js","assets/APIKeyMixin-bfb00271.js","assets/EditBusLayer-caf9fed8.js","assets/uuid-709b6c67.js","assets/FeatureEffectLayer-1948d1a0.js","assets/FeatureEffect-c80bb16d.js","assets/FeatureFilter-55dd341e.js","assets/FeatureReductionLayer-443167bc.js","assets/clusterUtils-50a66940.js","assets/MD5-715f37cd.js","assets/FeatureReductionSelection-d84c375a.js","assets/LabelClass-c3c309a8.js","assets/labelUtils-b29175f3.js","assets/defaults-4faa92e6.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-32293fe1.js","assets/FeatureTemplate-d1d1c7be.js","assets/FeatureType-f30c4b8b.js","assets/fieldProperties-8c831c84.js","assets/labelingInfo-aae625ac.js","assets/versionUtils-5892620e.js","assets/styleUtils-a3d96bf6.js","assets/TopFeaturesQuery-6d0bf5f5.js"])]),n=s.from(e);le(this.featureServiceUrl,this.gdbVersion||null)&&(n.sessionID=me),n.gdbVersion=this.gdbVersion;const l=this.networkServiceUrl,a=this.featureServiceUrl,u=he(a,null,this.gdbVersion,!0),d=await i(l,n,{...r});if(d!=null&&d.serviceEdits){const m=[];for(const _ of d.serviceEdits){const{editedFeatures:c}=_,p=c!=null&&c.spatialReference?new Ie(c.spatialReference):null;m.push({layerId:_.layerId,editedFeatures:{adds:((T=c==null?void 0:c.adds)==null?void 0:T.map(E=>this._createEditedFeature(E,p)))||[],updates:((v=c==null?void 0:c.updates)==null?void 0:v.map(E=>({original:this._createEditedFeature(E[0],p),current:this._createEditedFeature(E[1],p)})))||[],deletes:((I=c==null?void 0:c.deletes)==null?void 0:I.map(E=>this._createEditedFeature(E,p)))||[],spatialReference:p}})}u.resolve({edits:null,addedFeatures:[],updatedFeatures:[],deletedFeatures:[],addedAttachments:[],updatedAttachments:[],deletedAttachments:[],editedFeatures:m,exceededTransferLimit:!1,historicMoment:d.moment})}return d}async submitTopologyValidationJob(e,r){if(!e.validateArea)throw new oe("network:undefined-validateArea","the network must have validateArea defined in the validate network topology parameters.");if(!this.gdbVersion)throw new oe("network:undefined-gdb-version","version must be defined");const[{submitValidateNetworkTopologyJob:i},{default:s}]=await Promise.all([j(()=>import("./validateNetworkTopology-cd46602b.js"),["assets/validateNetworkTopology-cd46602b.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/FeatureLayer-c4c5819f.js","assets/jsonUtils-52514725.js","assets/DictionaryLoader-e327eff9.js","assets/Version-1f969b2a.js","assets/FieldsIndex-e8db657f.js","assets/UnknownTimeZone-a05df022.js","assets/HeatmapColorStop-3fff4333.js","assets/heatmapUtils-7f42325f.js","assets/FeatureLayerBase-0746b503.js","assets/HeightModelInfo-b816d32b.js","assets/featureLayerUtils-16361d1f.js","assets/featureQueryAll-40af0622.js","assets/Query-071039d7.js","assets/FullTextSearch-12e0754c.js","assets/QuantizationParameters-f983cf8d.js","assets/AttachmentQuery-bede5a71.js","assets/RelationshipQuery-2c9e4485.js","assets/LayerFloorInfo-4234db4d.js","assets/serviceCapabilitiesUtils-42d4d20c.js","assets/editsZScale-e45bb69c.js","assets/queryZScale-d7a48772.js","assets/APIKeyMixin-bfb00271.js","assets/EditBusLayer-caf9fed8.js","assets/uuid-709b6c67.js","assets/FeatureEffectLayer-1948d1a0.js","assets/FeatureEffect-c80bb16d.js","assets/FeatureFilter-55dd341e.js","assets/FeatureReductionLayer-443167bc.js","assets/clusterUtils-50a66940.js","assets/MD5-715f37cd.js","assets/FeatureReductionSelection-d84c375a.js","assets/LabelClass-c3c309a8.js","assets/labelUtils-b29175f3.js","assets/defaults-4faa92e6.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-32293fe1.js","assets/FeatureTemplate-d1d1c7be.js","assets/FeatureType-f30c4b8b.js","assets/fieldProperties-8c831c84.js","assets/labelingInfo-aae625ac.js","assets/versionUtils-5892620e.js","assets/styleUtils-a3d96bf6.js","assets/TopFeaturesQuery-6d0bf5f5.js"]),j(()=>import("./ValidateNetworkTopologyParameters-4cfdfa18.js"),["assets/ValidateNetworkTopologyParameters-4cfdfa18.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/FeatureLayer-c4c5819f.js","assets/jsonUtils-52514725.js","assets/DictionaryLoader-e327eff9.js","assets/Version-1f969b2a.js","assets/FieldsIndex-e8db657f.js","assets/UnknownTimeZone-a05df022.js","assets/HeatmapColorStop-3fff4333.js","assets/heatmapUtils-7f42325f.js","assets/FeatureLayerBase-0746b503.js","assets/HeightModelInfo-b816d32b.js","assets/featureLayerUtils-16361d1f.js","assets/featureQueryAll-40af0622.js","assets/Query-071039d7.js","assets/FullTextSearch-12e0754c.js","assets/QuantizationParameters-f983cf8d.js","assets/AttachmentQuery-bede5a71.js","assets/RelationshipQuery-2c9e4485.js","assets/LayerFloorInfo-4234db4d.js","assets/serviceCapabilitiesUtils-42d4d20c.js","assets/editsZScale-e45bb69c.js","assets/queryZScale-d7a48772.js","assets/APIKeyMixin-bfb00271.js","assets/EditBusLayer-caf9fed8.js","assets/uuid-709b6c67.js","assets/FeatureEffectLayer-1948d1a0.js","assets/FeatureEffect-c80bb16d.js","assets/FeatureFilter-55dd341e.js","assets/FeatureReductionLayer-443167bc.js","assets/clusterUtils-50a66940.js","assets/MD5-715f37cd.js","assets/FeatureReductionSelection-d84c375a.js","assets/LabelClass-c3c309a8.js","assets/labelUtils-b29175f3.js","assets/defaults-4faa92e6.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-32293fe1.js","assets/FeatureTemplate-d1d1c7be.js","assets/FeatureType-f30c4b8b.js","assets/fieldProperties-8c831c84.js","assets/labelingInfo-aae625ac.js","assets/versionUtils-5892620e.js","assets/styleUtils-a3d96bf6.js","assets/TopFeaturesQuery-6d0bf5f5.js"])]),n=s.from(e);le(this.featureServiceUrl,this.gdbVersion||null)&&(n.sessionID=me),n.gdbVersion=this.gdbVersion;const l=this.networkServiceUrl,a=this.featureServiceUrl?he(this.featureServiceUrl,null,this.gdbVersion,!0):void 0,u=await i(l,n,{...r});return new qe({statusUrl:u,editsResolver:a})}_createEditedFeature(e,r){return new Oe({attributes:e.attributes,geometry:Re({...e.geometry,spatialReference:r})})}async _fetchLayerMetaData(e,r){const i=await Q(e,{responseType:"json",query:{f:"json"},...r});this.sourceJSON=i.data,this.read(i.data,{origin:"service"})}async _fetchDataElement(e,r,i){if(this.dataElement)return;const s=await Q(`${e}/queryDataElements`,{responseType:"json",query:{layers:JSON.stringify([r]),f:"json"},...i}).then(n=>{var l;return(l=n.data.layerDataElements)==null?void 0:l[0]});s&&this.read(s,{origin:"service"})}};t([o({type:String,nonNullable:!0,json:{origins:{"web-map":{read:!0,write:{isRequired:!0}},service:{read:!0}},read:!1}})],h.prototype,"id",void 0),t([o({type:String,nonNullable:!0,json:{origins:{"web-map":{read:!0,write:{isRequired:!0}},service:{read:{source:"name"}}},read:!1}})],h.prototype,"title",void 0),t([o({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"url"},write:{target:"url",isRequired:!0}}},read:!1}})],h.prototype,"layerUrl",void 0),t([o({type:Object,json:{origins:{service:{read:!0}},read:!1}})],h.prototype,"dataElement",void 0),t([o({type:Ce,json:{origins:{service:{read:{source:"extent"}}},read:!1}})],h.prototype,"fullExtent",void 0),t([o({type:Ie,json:{origins:{service:{read:{source:"extent.spatialReference"}}},read:!1}})],h.prototype,"spatialReference",void 0),t([o({type:["utility","trace"],readOnly:!0,json:{read:!1,write:!1}})],h.prototype,"type",void 0),t([o({readOnly:!0})],h.prototype,"datasetName",null),t([o({readOnly:!0})],h.prototype,"owner",null),t([o({readOnly:!0})],h.prototype,"schemaGeneration",null),t([o({readOnly:!0})],h.prototype,"parsedUrl",null),t([o({readOnly:!0})],h.prototype,"featureServiceUrl",null),t([o({readOnly:!0})],h.prototype,"networkServiceUrl",null),t([o({readOnly:!0})],h.prototype,"layerId",null),t([o()],h.prototype,"sourceJSON",void 0),t([o({readOnly:!0})],h.prototype,"networkSystemLayers",null),t([o()],h.prototype,"gdbVersion",void 0),t([o({type:Date})],h.prototype,"historicMoment",void 0),h=t([b("esri.networks.Network")],h);const ze=h;var O;(function(e){e[e.RTJunctionJunctionConnectivity=1]="RTJunctionJunctionConnectivity",e[e.RTContainment=2]="RTContainment",e[e.RTAttachment=3]="RTAttachment",e[e.RTJunctionEdgeConnectivity=4]="RTJunctionEdgeConnectivity",e[e.RTEdgeJunctionEdgeConnectivity=5]="RTEdgeJunctionEdgeConnectivity"})(O||(O={}));const te=new ie({connected:"connected",upstream:"upstream",downstream:"downstream",shortestPath:"shortest-path",subnetwork:"subnetwork",subnetworkController:"subnetwork-controller",loops:"loops",isolation:"isolation"}),gt=new ie({connectivity:"connectivity",attachment:"attachment",containment:"containment",junctionEdgeFromConnectivity:"junction-edge-from-connectivity",junctionMidspanConnectivity:"junction-midspan-connectivity",junctionEdgeToConnectivity:"junction-edge-to-connectivity"}),wt=new ie({normal:"normal",rebuild:"rebuild",forceRebuild:"force-rebuild"});let H=class extends Ue(Te){constructor(r){super(r),this.request=Q}initialize(){}async load(r){const i=this.layer.load(r).then(()=>this._initializeRulesTable());return this.addResolvingPromise(i),this}getFeatureSQL(r,i){var T,v;const s=r.layerId.toString(),n=(T=r.fieldsIndex)==null?void 0:T.normalizeFieldName("assetGroup"),l=(v=r.fieldsIndex)==null?void 0:v.normalizeFieldName("assetType"),a=n?i.attributes[n]:null,u=l?i.attributes[l]:null,d=this.rulesHash[s];if(d){const I=d.assetGroupHash[a];if(I)return I.assetTypeHash[u]||null}return null}async _initializeRulesTable(){var n,l,a,u,d,T,v,I,m,_,c;const r={};let i;(function(p){p[p.from=0]="from",p[p.to=1]="to",p[p.via=2]="via"})(i||(i={}));const s=[{networkSourceId:"fromNetworkSource",assetGroupId:"fromAssetGroup",assetTypeId:"fromAssetType"},{networkSourceId:"toNetworkSource",assetGroupId:"toAssetGroup",assetTypeId:"toAssetType"},{networkSourceId:"viaNetworkSource",assetGroupId:"viaAssetGroup",assetTypeId:"viaAssetType"}];for(const p of this.rules){if(p.ruleType!==O.RTJunctionJunctionConnectivity&&p.ruleType!==O.RTJunctionEdgeConnectivity&&p.ruleType!==O.RTEdgeJunctionEdgeConnectivity)continue;let E=[[i.from,i.to],[i.to,i.from]];p.ruleType===O.RTEdgeJunctionEdgeConnectivity&&(E=[[i.from,i.via],[i.via,i.from],[i.to,i.via],[i.via,i.to]]);for(const X of E){const $=X.shift(),se=X.shift();let Z=!1;switch(p.ruleType){case O.RTEdgeJunctionEdgeConnectivity:Z=$===i.from||$===i.to;break;case O.RTJunctionEdgeConnectivity:Z=$===i.to}const k=s[$],f=((n=p[k.networkSourceId])==null?void 0:n.layerId.toString())??"",S=(a=(l=p[k.assetGroupId])==null?void 0:l.assetGroupCode)==null?void 0:a.toString(),x=p[k.assetTypeId],V=(u=x==null?void 0:x.assetTypeCode)==null?void 0:u.toString(),J=s[se],C=((d=p[J.networkSourceId])==null?void 0:d.layerId.toString())??"",q=(v=(T=p[J.assetGroupId])==null?void 0:T.assetGroupCode)==null?void 0:v.toString(),g=p[J.assetTypeId],D=(I=g==null?void 0:g.assetTypeCode)==null?void 0:I.toString(),ne=r[f]??{assetGroupHash:{}};if(!(S&&V&&q&&D))continue;const ae=ne.assetGroupHash[S]??{assetTypeHash:{}},w=ae.assetTypeHash[V]??{};if(w[C]=w[C]??{},Z){w[f]=w[f]??{};const de=`(assetgroup = ${S} AND assettype = ${V})`;w[f].anyVertex=w[f].anyVertex?`${w[f].anyVertex}`:`${de}`,(g==null?void 0:g.connectivityPolicy)==="esriNECPEndVertex"&&(w[f].endVertex=(m=w[f])!=null&&m.endVertex?`${w[f].endVertex}`:`${de}`)}const ee=`(assetgroup = ${q} AND assettype = ${D})`;w[C].anyVertex=(_=w[C])!=null&&_.anyVertex?`${w[C].anyVertex} OR ${ee}`:`${ee}`,(g==null?void 0:g.connectivityPolicy)==="esriNECPEndVertex"&&(w[C].endVertex=(c=w[C])!=null&&c.endVertex?`${w[C].endVertex} OR ${ee}`:`${ee}`),ae.assetTypeHash[V]=w,ne.assetGroupHash[S]=ae,r[f]=ne}}this.rulesHash=r}};t([o({constructOnly:!0})],H.prototype,"layer",void 0),t([o({constructOnly:!0})],H.prototype,"rules",void 0),t([o()],H.prototype,"rulesHash",void 0),t([o({constructOnly:!0})],H.prototype,"request",void 0),H=t([b("esri.networks.RulesTable")],H);const Ye=H;let R=class extends M{constructor(r){super(r),this.conditionBarriers=[],this.outputConditions=[],this.functions=[],this.functionBarriers=[],this.traversabilityScope=null,this.shortestPathNetworkAttributeName=null,this.includeBarriers=null,this.validateConsistency=null,this.ignoreBarriersAtStartingPoints=null}};t([o({type:[Object],json:{write:!0}})],R.prototype,"conditionBarriers",void 0),t([o({type:[Object],json:{write:!0}})],R.prototype,"outputConditions",void 0),t([o({type:[Object],json:{write:!0}})],R.prototype,"functions",void 0),t([o({type:[Object],json:{write:!0}})],R.prototype,"functionBarriers",void 0),t([o({type:["junctions","edges","junctionsAndEdges"],json:{write:!0}})],R.prototype,"traversabilityScope",void 0),t([o({type:String,json:{write:!0}})],R.prototype,"shortestPathNetworkAttributeName",void 0),t([o({type:Boolean,json:{write:!0}})],R.prototype,"includeBarriers",void 0),t([o({type:Boolean,json:{write:!0}})],R.prototype,"validateConsistency",void 0),t([o({type:Boolean,json:{write:!0}})],R.prototype,"ignoreBarriersAtStartingPoints",void 0),R=t([b("esri.networks.support.TraceConfiguration")],R);const ue=R;let y=class extends ue{constructor(r){super(r),this.filterBarriers=[],this.arcadeExpressionBarrier=null,this.domainNetworkName=null,this.filterBitsetNetworkAttributeName=null,this.filterFunctionBarriers=[],this.filterScope=null,this.includeContainers=null,this.includeContent=null,this.includeIsolated=null,this.includeStructures=null,this.allowIndeterminateFlow=null,this.includeUpToFirstSpatialContainer=null,this.nearestNeighbor=null,this.outputFilterCategories=[],this.outputFilters=[],this.propagators=[],this.subnetworkName=null,this.targetTierName=null,this.diagramTemplateName=null,this.tierName=null,this.validateLocatability=null}};t([o({type:[Object],json:{write:!0}})],y.prototype,"filterBarriers",void 0),t([o({type:String,json:{write:!0}})],y.prototype,"arcadeExpressionBarrier",void 0),t([o({type:String,json:{write:!0}})],y.prototype,"domainNetworkName",void 0),t([o({type:String,json:{write:!0}})],y.prototype,"filterBitsetNetworkAttributeName",void 0),t([o({type:[Object],json:{write:!0}})],y.prototype,"filterFunctionBarriers",void 0),t([o({type:["junctions","edges","junctionsAndEdges"],json:{write:!0}})],y.prototype,"filterScope",void 0),t([o({type:Boolean,json:{write:!0}})],y.prototype,"includeContainers",void 0),t([o({type:Boolean,json:{write:!0}})],y.prototype,"includeContent",void 0),t([o({type:Boolean,json:{write:!0}})],y.prototype,"includeIsolated",void 0),t([o({type:Boolean,json:{write:!0}})],y.prototype,"includeStructures",void 0),t([o({type:Boolean,json:{write:!0}})],y.prototype,"allowIndeterminateFlow",void 0),t([o({type:Boolean,json:{write:!0}})],y.prototype,"includeUpToFirstSpatialContainer",void 0),t([o({type:Object,json:{write:!0}})],y.prototype,"nearestNeighbor",void 0),t([o({type:[Object],json:{write:!0}})],y.prototype,"outputFilterCategories",void 0),t([o({type:[Object],json:{write:!0}})],y.prototype,"outputFilters",void 0),t([o({type:[Object],json:{write:!0}})],y.prototype,"propagators",void 0),t([o({type:String,json:{write:!0}})],y.prototype,"subnetworkName",void 0),t([o({type:String,json:{write:!0}})],y.prototype,"targetTierName",void 0),t([o({type:String,json:{write:!0}})],y.prototype,"diagramTemplateName",void 0),t([o({type:String,json:{write:!0}})],y.prototype,"tierName",void 0),t([o({type:Boolean,json:{write:!0}})],y.prototype,"validateLocatability",void 0),y=t([b("esri.networks.support.UNTraceConfiguration")],y);const Ke=y;let N=class extends Ae{constructor(r){super(r),this.globalId=null,this.title=null,this.traceConfiguration=null,this.creationDate=null,this.creator=null,this.description=null,this.minStartingPoints=null,this.resultTypes=[],this.tags=[],this.traceType=null}readTraceConfiguration(r,i){return r.tierName!==void 0?Ke.fromJSON(r):ue.fromJSON(r)}};t([o({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"id"},write:{target:"id",isRequired:!0}},service:{read:{source:"globalId"},write:{target:"globalId",isRequired:!0}}},read:!1}})],N.prototype,"globalId",void 0),t([o({type:String,nonNullable:!0,json:{origins:{"web-map":{read:{source:"title"},write:{target:"title",isRequired:!0}},service:{read:{source:"name"},write:{target:"name",isRequired:!0}}},read:!1}})],N.prototype,"title",void 0),t([o({type:ue,json:{origins:{service:{read:!0,write:!0}},read:!1}})],N.prototype,"traceConfiguration",void 0),t([$e("service","traceConfiguration")],N.prototype,"readTraceConfiguration",null),t([o({type:Date,json:{origins:{service:{read:!0,write:!0}},read:!1}})],N.prototype,"creationDate",void 0),t([o({type:String,json:{origins:{service:{read:!0,write:!0}},read:!1}})],N.prototype,"creator",void 0),t([o({type:String,json:{origins:{service:{read:!0,write:!0}},read:!1}})],N.prototype,"description",void 0),t([o({type:["none","one","many"],json:{origins:{service:{read:{source:"minNumStartingPoints"},write:{target:"minNumStartingPoints"}}},read:!1}})],N.prototype,"minStartingPoints",void 0),t([o({json:{origins:{service:{read:!0,write:!0}},read:!1}})],N.prototype,"resultTypes",void 0),t([o({type:[String],json:{origins:{service:{read:!0,write:!0}},read:!1}})],N.prototype,"tags",void 0),t([o({type:te.apiValues,json:{type:te.jsonValues,origins:{service:{read:te.read,write:te.write}},read:!1}})],N.prototype,"traceType",void 0),N=t([b("esri.networks.support.NamedTraceConfiguration")],N);const We=N;let P=class extends Ve{constructor(e){super(e),this.rulesTableId=null,this.rulesTableUrl=null,this.subnetworksTableId=null,this.subnetworksTableUrl=null,this.dirtyAreasLayerId=null,this.dirtyAreasLayerUrl=null}};t([o({constructOnly:!0})],P.prototype,"rulesTableId",void 0),t([o({constructOnly:!0})],P.prototype,"rulesTableUrl",void 0),t([o({constructOnly:!0})],P.prototype,"subnetworksTableId",void 0),t([o({constructOnly:!0})],P.prototype,"subnetworksTableUrl",void 0),t([o({constructOnly:!0})],P.prototype,"dirtyAreasLayerId",void 0),t([o({constructOnly:!0})],P.prototype,"dirtyAreasLayerUrl",void 0),P=t([b("esri.networks.support.NetworkSystemLayers")],P);const Qe=P;let Y=class extends M{constructor(r){super(r),this.id=null,this.name=null}};t([o({type:Number,json:{read:{source:"terminalId"},write:{target:"terminalId"}}})],Y.prototype,"id",void 0),t([o({type:String,json:{read:{source:"terminalName"},write:{target:"terminalName"}}})],Y.prototype,"name",void 0),t([o({type:Boolean,json:{write:!0}})],Y.prototype,"isUpstreamTerminal",void 0),Y=t([b("esri.networks.support.Terminal")],Y);const Ze=Y,re=new ie({esriUNTMBidirectional:"bidirectional",esriUNTMDirectional:"directional"});let B=class extends M{constructor(r){super(r),this.defaultConfiguration=null,this.id=null,this.name=null,this.terminals=[],this.traversabilityModel=null}};t([o({type:String,json:{write:!0}})],B.prototype,"defaultConfiguration",void 0),t([o({type:Number,json:{read:{source:"terminalConfigurationId"},write:{target:"terminalConfigurationId"}}})],B.prototype,"id",void 0),t([o({type:String,json:{read:{source:"terminalConfigurationName"},write:{target:"terminalConfigurationName"}}})],B.prototype,"name",void 0),t([o({type:[Ze],json:{write:!0}})],B.prototype,"terminals",void 0),t([o({type:re.apiValues,json:{type:re.jsonValues,read:re.read,write:re.write}})],B.prototype,"traversabilityModel",void 0),B=t([b("esri.networks.support.TerminalConfiguration")],B);const we=B;let K=class extends M{constructor(r){super(r),this.line=null,this.multipoint=null,this.polygon=null}};t([o({type:Pe,json:{write:!0},readOnly:!0})],K.prototype,"line",void 0),t([o({type:Le,json:{read:{source:"point"},write:{target:"point"}},readOnly:!0})],K.prototype,"multipoint",void 0),t([o({type:Fe,json:{write:!0},readOnly:!0})],K.prototype,"polygon",void 0),K=t([b("esri.rest.networks.support.AggregatedGeometry")],K);const Xe=K;let W=class extends M{constructor(r){super(r),this.functionType=null,this.networkAttributeName=null,this.result=null}};t([o({type:["add","subtract","average","count","min","max"],json:{write:!0},readOnly:!0})],W.prototype,"functionType",void 0),t([o({type:String,json:{write:!0},readOnly:!0})],W.prototype,"networkAttributeName",void 0),t([o({type:Number,json:{write:!0},readOnly:!0})],W.prototype,"result",void 0),W=t([b("esri.rest.networks.support.FunctionResult")],W);const et=W;let U=class extends M{constructor(e){super(e),this.assetGroupCode=null,this.assetTypeCode=null,this.globalId=null,this.networkSourceId=null,this.objectId=null,this.positionFrom=null,this.positionTo=null,this.terminalId=null}};t([o({type:Number,json:{write:!0}})],U.prototype,"assetGroupCode",void 0),t([o({type:Number,json:{write:!0}})],U.prototype,"assetTypeCode",void 0),t([o({type:String,json:{write:!0}})],U.prototype,"globalId",void 0),t([o({type:Number,json:{write:!0}})],U.prototype,"networkSourceId",void 0),t([o({type:Number,json:{write:!0}})],U.prototype,"objectId",void 0),t([o({type:Number,json:{write:!0}})],U.prototype,"positionFrom",void 0),t([o({type:Number,json:{write:!0}})],U.prototype,"positionTo",void 0),t([o({type:Number,json:{write:!0}})],U.prototype,"terminalId",void 0),U=t([b("esri.rest.networks.support.NetworkElement")],U);const tt=U;let L=class extends M{constructor(e){super(e),this.aggregatedGeometry=null,this.elements=null,this.globalFunctionResults=null,this.kFeaturesForKNNFound=!1,this.startingPointsIgnored=!1,this.warnings=null}};t([o({type:Xe,json:{write:!0},readOnly:!0})],L.prototype,"aggregatedGeometry",void 0),t([o({type:[tt],json:{write:!0},readOnly:!0})],L.prototype,"elements",void 0),t([o({type:[et],json:{write:!0},readOnly:!0})],L.prototype,"globalFunctionResults",void 0),t([o({type:Boolean,json:{write:!0},readOnly:!0})],L.prototype,"kFeaturesForKNNFound",void 0),t([o({type:Boolean,json:{write:!0},readOnly:!0})],L.prototype,"startingPointsIgnored",void 0),t([o({type:[String],json:{write:!0},readOnly:!0})],L.prototype,"warnings",void 0),L=t([b("esri.rest.networks.support.TraceResult")],L);const rt=L,ot=ve()({Pending:"job-waiting",InProgress:"job-executing",Completed:"job-succeeded"});let z=class extends rt{constructor(r){super(r),this.statusUrl=null,this.status=null,this.submissionTime=null,this.lastUpdatedTime=null,this._timer=void 0}destroy(){clearInterval(this._timer)}async checkJobStatus(r){const i={...r,query:{f:"json"}},{data:s}=await Q(this.statusUrl,i),n=s.traceResults?{...s.traceResults,...s}:s;return this.read(n),this}async waitForJobCompletion(r={}){const{interval:i=1e3,statusCallback:s}=r;return new Promise((n,l)=>{this._clearTimer();const a=setInterval(()=>{this._timer||l(be()),this.checkJobStatus().then(u=>{const{status:d}=u;switch(this.status=d,d){case"job-succeeded":this._clearTimer(),n(this);break;case"job-waiting":case"job-executing":s&&s(this)}},u=>{this._clearTimer(),l(u)})},i);this._timer=a})}_clearTimer(){clearInterval(this._timer),this._timer=void 0}};t([o({type:String,json:{write:!0}})],z.prototype,"statusUrl",void 0),t([fe(ot)],z.prototype,"status",void 0),t([o({type:Date,json:{type:Number,write:{writer:(e,r)=>{r.submissionTime=e?e.getTime():null}}}})],z.prototype,"submissionTime",void 0),t([o({type:Date,json:{type:Number,write:{writer:(e,r)=>{r.lastUpdatedTime=e?e.getTime():null}}}})],z.prototype,"lastUpdatedTime",void 0),z=t([b("esri.networks.support.TraceJobInfo")],z);const it=z;let F=class extends ze{constructor(e){super(e),this.sharedNamedTraceConfigurations=[],this.type="utility"}get serviceTerritoryFeatureLayerId(){var e;return((e=this.dataElement)==null?void 0:e.serviceTerritoryFeatureLayerId)??null}get networkSystemLayers(){var e,r,i,s,n,l;return new Qe({rulesTableId:(e=this.sourceJSON)==null?void 0:e.systemLayers.rulesTableId,rulesTableUrl:this.sourceJSON?`${this.featureServiceUrl}/${(r=this.sourceJSON)==null?void 0:r.systemLayers.rulesTableId}`:null,subnetworksTableId:(i=this.sourceJSON)==null?void 0:i.systemLayers.subnetworksTableId,subnetworksTableUrl:this.sourceJSON?`${this.featureServiceUrl}/${(s=this.sourceJSON)==null?void 0:s.systemLayers.subnetworksTableId}`:null,dirtyAreasLayerId:(n=this.sourceJSON)==null?void 0:n.systemLayers.dirtyAreasLayerId,dirtyAreasLayerUrl:this.sourceJSON?`${this.featureServiceUrl}/${(l=this.sourceJSON)==null?void 0:l.systemLayers.dirtyAreasLayerId}`:null})}get terminalConfigurations(){var e;return((e=this.dataElement)==null?void 0:e.terminalConfigurations.map(r=>we.fromJSON(r)))||[]}get domainNetworkNames(){var e;return((e=this.dataElement)==null?void 0:e.domainNetworks.map(r=>r.domainNetworkName))||[]}get _utilityLayerList(){var r,i;const e=new Set;return(i=(r=this.dataElement)==null?void 0:r.domainNetworks)==null||i.map(s=>{s.edgeSources.map(n=>{e.add(n.layerId)}),s.junctionSources.map(n=>{e.add(n.layerId)})}),e}async load(e){return this.addResolvingPromise(super.load(e)),this.addResolvingPromise(this._loadNamedTraceConfigurationsFromNetwork(e)),this}getTerminalConfiguration(e){var d,T,v,I;let r=null,i=null;const s=e.layer;let n=null;if((s==null?void 0:s.type)==="feature"){if(n=s.layerId,n===null)return null}else if((s==null?void 0:s.type)!=="subtype-sublayer"||(n=((d=s==null?void 0:s.parent)==null?void 0:d.layerId)??null,n===null))return null;const l=e.attributes;if(l==null)return null;for(const m of Object.keys(l))m.toUpperCase()==="ASSETGROUP"&&(r=e.getAttribute(m)),m.toUpperCase()==="ASSETTYPE"&&(i=e.getAttribute(m));if(!this.dataElement)return null;let a=null;const u=this.dataElement.domainNetworks;for(const m of u){const _=(T=m.junctionSources)==null?void 0:T.find(c=>c.layerId===n);if(_){const c=(v=_.assetGroups)==null?void 0:v.find(p=>p.assetGroupCode===r);if(c){const p=(I=c.assetTypes)==null?void 0:I.find(E=>E.assetTypeCode===i);if(p){a=p.terminalConfigurationId;break}}}}if(a!=null){const m=this.dataElement.terminalConfigurations,_=m==null?void 0:m.find(c=>c.terminalConfigurationId===a);return _?we.fromJSON(_):null}return null}getTierNames(e){var i;const r=(i=this.dataElement)==null?void 0:i.domainNetworks.find(s=>s.domainNetworkName===e);return(r==null?void 0:r.tiers.map(s=>s.name))||[]}async getRulesTable(){return this._sharedRulesTable||(this._sharedRulesTable=this._createRulesTable()),await this._sharedRulesTable}isUtilityLayer(e){return this._utilityLayerList.has(e.layerId)}async queryAssociations(e){const[{queryAssociations:r},{default:i}]=await Promise.all([j(()=>import("./queryAssociations-077a2888.js"),["assets/queryAssociations-077a2888.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/Association-ad31be1b.js","assets/FeatureLayer-c4c5819f.js","assets/jsonUtils-52514725.js","assets/DictionaryLoader-e327eff9.js","assets/Version-1f969b2a.js","assets/FieldsIndex-e8db657f.js","assets/UnknownTimeZone-a05df022.js","assets/HeatmapColorStop-3fff4333.js","assets/heatmapUtils-7f42325f.js","assets/FeatureLayerBase-0746b503.js","assets/HeightModelInfo-b816d32b.js","assets/featureLayerUtils-16361d1f.js","assets/featureQueryAll-40af0622.js","assets/Query-071039d7.js","assets/FullTextSearch-12e0754c.js","assets/QuantizationParameters-f983cf8d.js","assets/AttachmentQuery-bede5a71.js","assets/RelationshipQuery-2c9e4485.js","assets/LayerFloorInfo-4234db4d.js","assets/serviceCapabilitiesUtils-42d4d20c.js","assets/editsZScale-e45bb69c.js","assets/queryZScale-d7a48772.js","assets/APIKeyMixin-bfb00271.js","assets/EditBusLayer-caf9fed8.js","assets/uuid-709b6c67.js","assets/FeatureEffectLayer-1948d1a0.js","assets/FeatureEffect-c80bb16d.js","assets/FeatureFilter-55dd341e.js","assets/FeatureReductionLayer-443167bc.js","assets/clusterUtils-50a66940.js","assets/MD5-715f37cd.js","assets/FeatureReductionSelection-d84c375a.js","assets/LabelClass-c3c309a8.js","assets/labelUtils-b29175f3.js","assets/defaults-4faa92e6.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-32293fe1.js","assets/FeatureTemplate-d1d1c7be.js","assets/FeatureType-f30c4b8b.js","assets/fieldProperties-8c831c84.js","assets/labelingInfo-aae625ac.js","assets/versionUtils-5892620e.js","assets/styleUtils-a3d96bf6.js","assets/TopFeaturesQuery-6d0bf5f5.js"]),j(()=>import("./QueryAssociationsParameters-705d7522.js"),["assets/QueryAssociationsParameters-705d7522.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/FeatureLayer-c4c5819f.js","assets/jsonUtils-52514725.js","assets/DictionaryLoader-e327eff9.js","assets/Version-1f969b2a.js","assets/FieldsIndex-e8db657f.js","assets/UnknownTimeZone-a05df022.js","assets/HeatmapColorStop-3fff4333.js","assets/heatmapUtils-7f42325f.js","assets/FeatureLayerBase-0746b503.js","assets/HeightModelInfo-b816d32b.js","assets/featureLayerUtils-16361d1f.js","assets/featureQueryAll-40af0622.js","assets/Query-071039d7.js","assets/FullTextSearch-12e0754c.js","assets/QuantizationParameters-f983cf8d.js","assets/AttachmentQuery-bede5a71.js","assets/RelationshipQuery-2c9e4485.js","assets/LayerFloorInfo-4234db4d.js","assets/serviceCapabilitiesUtils-42d4d20c.js","assets/editsZScale-e45bb69c.js","assets/queryZScale-d7a48772.js","assets/APIKeyMixin-bfb00271.js","assets/EditBusLayer-caf9fed8.js","assets/uuid-709b6c67.js","assets/FeatureEffectLayer-1948d1a0.js","assets/FeatureEffect-c80bb16d.js","assets/FeatureFilter-55dd341e.js","assets/FeatureReductionLayer-443167bc.js","assets/clusterUtils-50a66940.js","assets/MD5-715f37cd.js","assets/FeatureReductionSelection-d84c375a.js","assets/LabelClass-c3c309a8.js","assets/labelUtils-b29175f3.js","assets/defaults-4faa92e6.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-32293fe1.js","assets/FeatureTemplate-d1d1c7be.js","assets/FeatureType-f30c4b8b.js","assets/fieldProperties-8c831c84.js","assets/labelingInfo-aae625ac.js","assets/versionUtils-5892620e.js","assets/styleUtils-a3d96bf6.js","assets/TopFeaturesQuery-6d0bf5f5.js"])]),s=i.from(e);return s.gdbVersion=this.gdbVersion,s.moment=this.historicMoment,(await r(this.networkServiceUrl,s)).associations}async synthesizeAssociationGeometries(e){const[{synthesizeAssociationGeometries:r},{default:i}]=await Promise.all([j(()=>import("./synthesizeAssociationGeometries-5af6690e.js"),["assets/synthesizeAssociationGeometries-5af6690e.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/Association-ad31be1b.js","assets/FeatureLayer-c4c5819f.js","assets/jsonUtils-52514725.js","assets/DictionaryLoader-e327eff9.js","assets/Version-1f969b2a.js","assets/FieldsIndex-e8db657f.js","assets/UnknownTimeZone-a05df022.js","assets/HeatmapColorStop-3fff4333.js","assets/heatmapUtils-7f42325f.js","assets/FeatureLayerBase-0746b503.js","assets/HeightModelInfo-b816d32b.js","assets/featureLayerUtils-16361d1f.js","assets/featureQueryAll-40af0622.js","assets/Query-071039d7.js","assets/FullTextSearch-12e0754c.js","assets/QuantizationParameters-f983cf8d.js","assets/AttachmentQuery-bede5a71.js","assets/RelationshipQuery-2c9e4485.js","assets/LayerFloorInfo-4234db4d.js","assets/serviceCapabilitiesUtils-42d4d20c.js","assets/editsZScale-e45bb69c.js","assets/queryZScale-d7a48772.js","assets/APIKeyMixin-bfb00271.js","assets/EditBusLayer-caf9fed8.js","assets/uuid-709b6c67.js","assets/FeatureEffectLayer-1948d1a0.js","assets/FeatureEffect-c80bb16d.js","assets/FeatureFilter-55dd341e.js","assets/FeatureReductionLayer-443167bc.js","assets/clusterUtils-50a66940.js","assets/MD5-715f37cd.js","assets/FeatureReductionSelection-d84c375a.js","assets/LabelClass-c3c309a8.js","assets/labelUtils-b29175f3.js","assets/defaults-4faa92e6.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-32293fe1.js","assets/FeatureTemplate-d1d1c7be.js","assets/FeatureType-f30c4b8b.js","assets/fieldProperties-8c831c84.js","assets/labelingInfo-aae625ac.js","assets/versionUtils-5892620e.js","assets/styleUtils-a3d96bf6.js","assets/TopFeaturesQuery-6d0bf5f5.js"]),j(()=>import("./SynthesizeAssociationGeometriesParameters-25d5ea90.js"),["assets/SynthesizeAssociationGeometriesParameters-25d5ea90.js","assets/index-b516d057.js","assets/index-b252abd2.css"])]),s=i.from(e);return s.gdbVersion=this.gdbVersion,s.moment=this.historicMoment,r(this.networkServiceUrl,s)}async trace(e){const[{trace:r},{default:i}]=await Promise.all([j(()=>import("./trace-2db83606.js"),["assets/trace-2db83606.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/FeatureLayer-c4c5819f.js","assets/jsonUtils-52514725.js","assets/DictionaryLoader-e327eff9.js","assets/Version-1f969b2a.js","assets/FieldsIndex-e8db657f.js","assets/UnknownTimeZone-a05df022.js","assets/HeatmapColorStop-3fff4333.js","assets/heatmapUtils-7f42325f.js","assets/FeatureLayerBase-0746b503.js","assets/HeightModelInfo-b816d32b.js","assets/featureLayerUtils-16361d1f.js","assets/featureQueryAll-40af0622.js","assets/Query-071039d7.js","assets/FullTextSearch-12e0754c.js","assets/QuantizationParameters-f983cf8d.js","assets/AttachmentQuery-bede5a71.js","assets/RelationshipQuery-2c9e4485.js","assets/LayerFloorInfo-4234db4d.js","assets/serviceCapabilitiesUtils-42d4d20c.js","assets/editsZScale-e45bb69c.js","assets/queryZScale-d7a48772.js","assets/APIKeyMixin-bfb00271.js","assets/EditBusLayer-caf9fed8.js","assets/uuid-709b6c67.js","assets/FeatureEffectLayer-1948d1a0.js","assets/FeatureEffect-c80bb16d.js","assets/FeatureFilter-55dd341e.js","assets/FeatureReductionLayer-443167bc.js","assets/clusterUtils-50a66940.js","assets/MD5-715f37cd.js","assets/FeatureReductionSelection-d84c375a.js","assets/LabelClass-c3c309a8.js","assets/labelUtils-b29175f3.js","assets/defaults-4faa92e6.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-32293fe1.js","assets/FeatureTemplate-d1d1c7be.js","assets/FeatureType-f30c4b8b.js","assets/fieldProperties-8c831c84.js","assets/labelingInfo-aae625ac.js","assets/versionUtils-5892620e.js","assets/styleUtils-a3d96bf6.js","assets/TopFeaturesQuery-6d0bf5f5.js"]),j(()=>import("./TraceParameters-7784f5d1.js").then(n=>n.T),["assets/TraceParameters-7784f5d1.js","assets/index-b516d057.js","assets/index-b252abd2.css"])]),s=i.from(e);return s.gdbVersion=this.gdbVersion,s.moment=this.historicMoment,r(this.networkServiceUrl,s)}async submitTraceJob(e){const[{submitTraceJob:r},{default:i}]=await Promise.all([j(()=>import("./trace-2db83606.js"),["assets/trace-2db83606.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/FeatureLayer-c4c5819f.js","assets/jsonUtils-52514725.js","assets/DictionaryLoader-e327eff9.js","assets/Version-1f969b2a.js","assets/FieldsIndex-e8db657f.js","assets/UnknownTimeZone-a05df022.js","assets/HeatmapColorStop-3fff4333.js","assets/heatmapUtils-7f42325f.js","assets/FeatureLayerBase-0746b503.js","assets/HeightModelInfo-b816d32b.js","assets/featureLayerUtils-16361d1f.js","assets/featureQueryAll-40af0622.js","assets/Query-071039d7.js","assets/FullTextSearch-12e0754c.js","assets/QuantizationParameters-f983cf8d.js","assets/AttachmentQuery-bede5a71.js","assets/RelationshipQuery-2c9e4485.js","assets/LayerFloorInfo-4234db4d.js","assets/serviceCapabilitiesUtils-42d4d20c.js","assets/editsZScale-e45bb69c.js","assets/queryZScale-d7a48772.js","assets/APIKeyMixin-bfb00271.js","assets/EditBusLayer-caf9fed8.js","assets/uuid-709b6c67.js","assets/FeatureEffectLayer-1948d1a0.js","assets/FeatureEffect-c80bb16d.js","assets/FeatureFilter-55dd341e.js","assets/FeatureReductionLayer-443167bc.js","assets/clusterUtils-50a66940.js","assets/MD5-715f37cd.js","assets/FeatureReductionSelection-d84c375a.js","assets/LabelClass-c3c309a8.js","assets/labelUtils-b29175f3.js","assets/defaults-4faa92e6.js","assets/defaultsJSON-59981e75.js","assets/OrderedLayer-32293fe1.js","assets/FeatureTemplate-d1d1c7be.js","assets/FeatureType-f30c4b8b.js","assets/fieldProperties-8c831c84.js","assets/labelingInfo-aae625ac.js","assets/versionUtils-5892620e.js","assets/styleUtils-a3d96bf6.js","assets/TopFeaturesQuery-6d0bf5f5.js"]),j(()=>import("./TraceParameters-7784f5d1.js").then(l=>l.T),["assets/TraceParameters-7784f5d1.js","assets/index-b516d057.js","assets/index-b252abd2.css"])]),s=i.from(e);s.gdbVersion=this.gdbVersion,s.moment=this.historicMoment;const n=await r(this.networkServiceUrl,s);return new it({statusUrl:n})}async _loadNamedTraceConfigurationsFromNetwork(e){var s;if(((s=this.sharedNamedTraceConfigurations)==null?void 0:s.length)===0)return;const r=this.sharedNamedTraceConfigurations.map(n=>n.globalId),i=await this.queryNamedTraceConfigurations({globalIds:r},e);for(const n of this.sharedNamedTraceConfigurations){const l=i==null?void 0:i.find(a=>a.globalId===n.globalId);if(l){const a=l.write({},{origin:"service"});n.read(a,{origin:"service"})}}}async _createRulesTable(){var l;const e=this.networkSystemLayers.rulesTableUrl,r=new xe({url:e});await r.load();const i=(l=this.dataElement)==null?void 0:l.domainNetworks;if(!i)return null;const s=i.flatMap(a=>[...a.edgeSources,...a.junctionSources]),n=(await this._queryRulesTable(r)).map(a=>this._hydrateRuleInfo(r,s,a));return new Ye({layer:r,rules:n})}async _queryRulesTable(e){const r=new Ge({where:"1=1",outFields:["*"]});return(await Se(e,r)).features}_hydrateRuleInfo(e,r,i){const s=e.fieldsIndex,n=s.get("RULETYPE"),l=s.get("CREATIONDATE"),a=s.get("FROMNETWORKSOURCEID"),u=s.get("FROMASSETGROUP"),d=s.get("FROMASSETTYPE"),T=s.get("FROMTERMINALID"),v=s.get("TONETWORKSOURCEID"),I=s.get("TOASSETGROUP"),m=s.get("TOASSETTYPE"),_=s.get("TOTERMINALID"),c=s.get("VIANETWORKSOURCEID"),p=s.get("VIAASSETGROUP"),E=s.get("VIAASSETTYPE"),X=s.get("VIATERMINALID"),$=i.attributes[n.name],se=new Date(i.attributes[l.name]),Z=[{networkSourceId:i.attributes[a.name],assetGroupId:i.attributes[u.name],assetTypeId:i.attributes[d.name],terminalId:i.attributes[T.name]},{networkSourceId:i.attributes[v.name],assetGroupId:i.attributes[I.name],assetTypeId:i.attributes[m.name],terminalId:i.attributes[_.name]},{networkSourceId:i.attributes[c.name],assetGroupId:i.attributes[p.name],assetTypeId:i.attributes[E.name],terminalId:i.attributes[X.name]}];let k;(function(S){S[S.from=0]="from",S[S.to=1]="to",S[S.via=2]="via"})(k||(k={}));const f={ruleType:$,creationDate:se};for(const S of[k.from,k.to,k.via]){if($!==O.RTEdgeJunctionEdgeConnectivity&&S===k.via)continue;const x=Z[S],V=r.find(D=>D.sourceId===x.networkSourceId),J=V==null?void 0:V.assetGroups.find(D=>D.assetGroupCode===x.assetGroupId),C=J==null?void 0:J.assetTypes.find(D=>D.assetTypeCode===x.assetTypeId);let q=this._getTerminal($,C,x);$!==O.RTContainment&&$!==O.RTAttachment||(q=null);let g="";switch(S){case k.from:g="from";break;case k.to:g="to";break;case k.via:g="via"}f[`${g}NetworkSource`]=V,f[`${g}AssetGroup`]=J,f[`${g}AssetType`]=C,f[`${g}Terminal`]=q==null?void 0:q.toJSON()}return f}_getTerminal(e,r,i){var l,a;if(e===O.RTAttachment||e===O.RTContainment)return null;const s=r==null?void 0:r.terminalConfigurationId,n=(l=this.terminalConfigurations)==null?void 0:l.find(u=>u.id===s);return((a=n==null?void 0:n.terminals)==null?void 0:a.find(u=>u.id===i.terminalId))??null}};t([o({type:[We],json:{origins:{"web-map":{read:{source:"traceConfigurations"},write:{target:"traceConfigurations"}},service:{read:{source:"traceConfigurations"}}},read:!1}})],F.prototype,"sharedNamedTraceConfigurations",void 0),t([o({type:["utility"],readOnly:!0,json:{read:!1,write:!1}})],F.prototype,"type",void 0),t([o({readOnly:!0})],F.prototype,"serviceTerritoryFeatureLayerId",null),t([o({readOnly:!0})],F.prototype,"networkSystemLayers",null),t([o({readOnly:!0})],F.prototype,"terminalConfigurations",null),t([o({readOnly:!0})],F.prototype,"domainNetworkNames",null),F=t([b("esri.networks.UtilityNetwork")],F);const st=F,nt=Object.freeze(Object.defineProperty({__proto__:null,default:st},Symbol.toStringTag,{value:"Module"}));export{rt as a,wt as b,We as c,st as d,gt as e,ht as f,Be as i,mt as n,te as o,tt as p,Ke as s};
