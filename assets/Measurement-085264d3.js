import{a5 as i,a6 as s,ko as h,kp as w,a9 as v,bA as p,cb as u,gl as _,_ as d}from"./index-b516d057.js";import{e as y,O as M,n as U,i as m}from"./jsxFactory-92036771.js";import{e as f}from"./defaultUnit-414db021.js";import"./uuid-709b6c67.js";import"./getDefaultUnitForView-d1ffbf16.js";let o=class extends p{constructor(e){super(e),this.activeTool=null,this.activeViewModel=null,this.view=null}get areaUnit(){return this.defaultUnit}set areaUnit(e){this._overrideIfSome("areaUnit",e)}get linearUnit(){return this.defaultUnit}set linearUnit(e){this._overrideIfSome("linearUnit",e)}get state(){const{activeViewModel:e}=this;return e?e.state:"disabled"}};i([s({type:["area","distance","direct-line"]})],o.prototype,"activeTool",void 0),i([s()],o.prototype,"activeViewModel",void 0),i([s({type:h})],o.prototype,"areaUnit",null),i([s(f)],o.prototype,"defaultUnit",void 0),i([s({type:w})],o.prototype,"linearUnit",null),i([s({readOnly:!0})],o.prototype,"state",null),i([s()],o.prototype,"view",void 0),o=i([v("esri.widgets.Measurement.MeasurementViewModel")],o);const g=o,c={base:"esri-measurement",widgetIcon:m.measure};function W(t){return(t==null?void 0:t.declaredClass)==="esri.widgets.AreaMeasurement2D"||(t==null?void 0:t.declaredClass)==="esri.widgets.AreaMeasurement3D"}let a=class extends M{constructor(t,e){super(t,e),this._widgets=new Map,this.activeWidget=null,this.iconClass=c.widgetIcon,this.icon=null,this.messages=null,this.viewModel=new g}initialize(){this.activeWidget&&this.viewModel.set("activeViewModel",this.activeWidget.viewModel),this.view&&this.activeTool&&this._getActiveWidget().then(t=>{this._set("activeWidget",t)}),this.addHandles([u(()=>[this.view,this.activeTool],async()=>{this._set("activeWidget",await this._getActiveWidget())}),u(()=>this.activeWidget,(t,e)=>{this.viewModel.set("activeViewModel",t?t.viewModel:null),e&&(e.visible=!1)}),u(()=>[this.areaUnit,this.linearUnit,this.uiStrings],()=>this._updateSubWidgetProperties())])}destroy(){this._destroyWidgets()}get activeTool(){return this.viewModel.activeTool}set activeTool(t){this.viewModel.activeTool=t}get areaUnit(){return this.viewModel.areaUnit}set areaUnit(t){this.viewModel.areaUnit=t}get label(){var t;return((t=this.messages)==null?void 0:t.widgetLabel)??""}set label(t){this._overrideIfSome("label",t)}get linearUnit(){return this.viewModel.linearUnit}set linearUnit(t){this.viewModel.linearUnit=t}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}render(){const{activeWidget:t}=this,e=t&&!t.destroyed?t.render():null;return U("div",{class:c.base},e)}clear(){this.activeTool=null,this._destroyWidgets()}startMeasurement(){const{activeViewModel:t}=this.viewModel;t&&_(t.start())}async _createWidget(t){const{areaUnit:e,linearUnit:r,view:n}=this;if(!n)return null;switch(t){case"area":{const{type:l}=n;switch(l){case"2d":return new(await d(()=>import("./AreaMeasurement2D-519124f0.js"),["assets/AreaMeasurement2D-519124f0.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/jsxFactory-92036771.js","assets/uuid-709b6c67.js","assets/defaultUnit-414db021.js","assets/getDefaultUnitForView-d1ffbf16.js","assets/unitFormatUtils-67047561.js","assets/Cyclical-4c223a04.js","assets/geometryEngine-656a968c.js","assets/geometryEngineBase-dfbd3a67.js","assets/hydrated-40effdd0.js","assets/geodesicUtils-822c19ca.js","assets/ViewingMode-5d7d590b.js","assets/Draw-ee21c93a.js","assets/dehydratedPoint-5a1dfed5.js","assets/SnappingVisualizer2D-4547907b.js","assets/enums-f1a6a48a.js","assets/snappingUtils-93e84fbe.js","assets/Query-071039d7.js","assets/FullTextSearch-12e0754c.js","assets/QuantizationParameters-f983cf8d.js","assets/screenUtils-8dc4a7f9.js","assets/signal-51ed66f5.js","assets/elevationInfoUtils-be36d866.js","assets/SnappingContext-90969376.js","assets/PointSnappingHint-671c9f09.js","assets/EditGeometryOperations-c2e73f2d.js","assets/geometry2dUtils-a99dcf3d.js","assets/SnappingOperation-4a4ee09b.js","assets/Scheduler-ff5943a4.js","assets/debugFlags-9a30f077.js","assets/RenderState-1d6218ee.js","assets/surfaceCoordinateSystems-1cfad4a3.js","assets/UpdatingHandles-7949a657.js","assets/dehydratedFeatureComparison-7855b188.js","assets/InteractiveToolBase-ddd44c70.js","assets/hydratedFeatures-2365c307.js","assets/interfaces-1a80c8eb.js","assets/drawUtils-bd7471ac.js","assets/interfaces-0421c5e6.js","assets/SketchTooltipOptions-cc43c059.js","assets/SnappingDragPipelineStep-e275580d.js","assets/mat2d-d4af8487.js","assets/mat2df64-4d1a9198.js","assets/GraphicManipulator-bf7f8b04.js","assets/defaults-4faa92e6.js","assets/defaultsJSON-59981e75.js","assets/drapedUtils-5cffceb9.js","assets/MeasurementWidgetContent-60198b21.js","assets/UnitSelect-52961079.js","assets/globalCss-94006b67.js"])).default({view:n,unit:e,uiStrings:this._createUIStringsForWidget(t)});case"3d":return new(await d(()=>import("./AreaMeasurement3D-da95a724.js"),["assets/AreaMeasurement3D-da95a724.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/jsxFactory-92036771.js","assets/uuid-709b6c67.js","assets/Analysis-bb7abb72.js","assets/defaultUnit-414db021.js","assets/getDefaultUnitForView-d1ffbf16.js","assets/memoize-3e55df82.js","assets/UpdatingHandles-7949a657.js","assets/hydratedFeatures-2365c307.js","assets/dehydratedPoint-5a1dfed5.js","assets/measurementUtils-2ddcde49.js","assets/geometryEngine-656a968c.js","assets/geometryEngineBase-dfbd3a67.js","assets/hydrated-40effdd0.js","assets/projectPointToWGS84ComparableLonLat-1ba40d40.js","assets/projectVectorToWGS84ComparableLonLat-5675a9f4.js","assets/geodesicUtils-822c19ca.js","assets/SnappingVisualizer3D-493bdb16.js","assets/projectVectorToVector-56c29b20.js","assets/elevationInfoUtils-be36d866.js","assets/ExtendedLineVisualElement-451ab04d.js","assets/vec4f32-0d1b2306.js","assets/frustum-f9d53cdf.js","assets/EngineVisualElement-43f3e8cb.js","assets/RenderGeometry-5dbc1699.js","assets/vec3f32-bac7ea57.js","assets/DefaultTechniqueConfiguration-b4dbe32f.js","assets/requestImageUtils-b142708c.js","assets/enums-bdecffa2.js","assets/Texture-bcb6d63f.js","assets/contextUtils-81fda295.js","assets/interfaces-8918b36f.js","assets/Material-5f4156ac.js","assets/ViewingMode-5d7d590b.js","assets/FramebufferObject-123b7c8d.js","assets/ShaderTechniqueConfiguration-2502462e.js","assets/ElevationProvider-abb53936.js","assets/weather-2eb64924.js","assets/RenderState-1d6218ee.js","assets/NestedMap-1b5db22e.js","assets/VertexElementDescriptor-2925c6af.js","assets/VertexArrayObject-d19dab8d.js","assets/Octree-7cea9440.js","assets/InterleavedLayout-d76b0d59.js","assets/types-1305598a.js","assets/OrderIndependentTransparency-755f7dcc.js","assets/floatRGBA-ca990bbb.js","assets/Intersector-2e1d9db3.js","assets/Intersector-fa865806.js","assets/boundedPlane-1da2f094.js","assets/verticalOffsetUtils-e5214af9.js","assets/orientedBoundingBox-67c5cd22.js","assets/glUtil-ce5ee52b.js","assets/Scheduler-ff5943a4.js","assets/signal-51ed66f5.js","assets/debugFlags-9a30f077.js","assets/VisualElement-187372ae.js","assets/LaserlineVisualElement-c0026af2.js","assets/PointVisualElement-11117df9.js","assets/Object3DVisualElement-459b9b9c.js","assets/ColorMaterial-bdf1f62a.js","assets/VerticalOffset.glsl-5743f98e.js","assets/RightAngleQuadVisualElement-95156bc2.js","assets/snappingUtils-93e84fbe.js","assets/Query-071039d7.js","assets/FullTextSearch-12e0754c.js","assets/QuantizationParameters-f983cf8d.js","assets/screenUtils-8dc4a7f9.js","assets/SnappingContext-90969376.js","assets/PointSnappingHint-671c9f09.js","assets/viewUtils-9f810d02.js","assets/dragEventPipeline3D-4663cd2c.js","assets/ray-8da55042.js","assets/InteractiveToolBase-ddd44c70.js","assets/interfaces-1a80c8eb.js","assets/drawUtils-bd7471ac.js","assets/interfaces-0421c5e6.js","assets/manipulatorUtils-9334c98f.js","assets/AnalysisToolBase-71ee6ca9.js","assets/EditGeometryOperations-c2e73f2d.js","assets/geometry2dUtils-a99dcf3d.js","assets/SceneSnappingManagerPool-2ede5e56.js","assets/SnappingManager-aa70fdd4.js","assets/FeatureFilter-55dd341e.js","assets/floorFilterUtils-080a7cd2.js","assets/SnappingDragPipelineStep-e275580d.js","assets/dehydratedFeatureComparison-7855b188.js","assets/SnappingOperation-4a4ee09b.js","assets/InteractiveAnalysisViewModel-3c9c7b62.js","assets/MeasurementWidgetContent-60198b21.js","assets/UnitSelect-52961079.js","assets/globalCss-94006b67.js"])).default({view:n,unit:e,uiStrings:this._createUIStringsForWidget(t)});default:return null}}case"distance":{const{type:l}=n;return l==="2d"?new(await d(()=>import("./DistanceMeasurement2D-34f7891e.js"),["assets/DistanceMeasurement2D-34f7891e.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/jsxFactory-92036771.js","assets/uuid-709b6c67.js","assets/defaultUnit-414db021.js","assets/getDefaultUnitForView-d1ffbf16.js","assets/unitFormatUtils-67047561.js","assets/Cyclical-4c223a04.js","assets/geometryEngine-656a968c.js","assets/geometryEngineBase-dfbd3a67.js","assets/hydrated-40effdd0.js","assets/geodesicUtils-822c19ca.js","assets/ViewingMode-5d7d590b.js","assets/Draw-ee21c93a.js","assets/dehydratedPoint-5a1dfed5.js","assets/SnappingVisualizer2D-4547907b.js","assets/enums-f1a6a48a.js","assets/snappingUtils-93e84fbe.js","assets/Query-071039d7.js","assets/FullTextSearch-12e0754c.js","assets/QuantizationParameters-f983cf8d.js","assets/screenUtils-8dc4a7f9.js","assets/signal-51ed66f5.js","assets/elevationInfoUtils-be36d866.js","assets/SnappingContext-90969376.js","assets/PointSnappingHint-671c9f09.js","assets/EditGeometryOperations-c2e73f2d.js","assets/geometry2dUtils-a99dcf3d.js","assets/SnappingOperation-4a4ee09b.js","assets/Scheduler-ff5943a4.js","assets/debugFlags-9a30f077.js","assets/RenderState-1d6218ee.js","assets/surfaceCoordinateSystems-1cfad4a3.js","assets/UpdatingHandles-7949a657.js","assets/dehydratedFeatureComparison-7855b188.js","assets/InteractiveToolBase-ddd44c70.js","assets/hydratedFeatures-2365c307.js","assets/interfaces-1a80c8eb.js","assets/drawUtils-bd7471ac.js","assets/interfaces-0421c5e6.js","assets/SketchTooltipOptions-cc43c059.js","assets/SnappingDragPipelineStep-e275580d.js","assets/mat2d-d4af8487.js","assets/mat2df64-4d1a9198.js","assets/GraphicManipulator-bf7f8b04.js","assets/defaults-4faa92e6.js","assets/defaultsJSON-59981e75.js","assets/drapedUtils-5cffceb9.js","assets/MeasurementWidgetContent-60198b21.js","assets/UnitSelect-52961079.js","assets/globalCss-94006b67.js"])).default({view:n,unit:r,uiStrings:this._createUIStringsForWidget(t)}):null}case"direct-line":{const{type:l}=n;return l==="3d"?new(await d(()=>import("./DirectLineMeasurement3D-f77dc299.js"),["assets/DirectLineMeasurement3D-f77dc299.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/jsxFactory-92036771.js","assets/uuid-709b6c67.js","assets/Analysis-bb7abb72.js","assets/defaultUnit-414db021.js","assets/getDefaultUnitForView-d1ffbf16.js","assets/memoize-3e55df82.js","assets/UpdatingHandles-7949a657.js","assets/hydratedFeatures-2365c307.js","assets/dehydratedPoint-5a1dfed5.js","assets/measurementUtils-2ddcde49.js","assets/geometryEngine-656a968c.js","assets/geometryEngineBase-dfbd3a67.js","assets/hydrated-40effdd0.js","assets/projectPointToWGS84ComparableLonLat-1ba40d40.js","assets/projectVectorToWGS84ComparableLonLat-5675a9f4.js","assets/geodesicUtils-822c19ca.js","assets/SnappingVisualizer3D-493bdb16.js","assets/projectVectorToVector-56c29b20.js","assets/elevationInfoUtils-be36d866.js","assets/ExtendedLineVisualElement-451ab04d.js","assets/vec4f32-0d1b2306.js","assets/frustum-f9d53cdf.js","assets/EngineVisualElement-43f3e8cb.js","assets/RenderGeometry-5dbc1699.js","assets/vec3f32-bac7ea57.js","assets/DefaultTechniqueConfiguration-b4dbe32f.js","assets/requestImageUtils-b142708c.js","assets/enums-bdecffa2.js","assets/Texture-bcb6d63f.js","assets/contextUtils-81fda295.js","assets/interfaces-8918b36f.js","assets/Material-5f4156ac.js","assets/ViewingMode-5d7d590b.js","assets/FramebufferObject-123b7c8d.js","assets/ShaderTechniqueConfiguration-2502462e.js","assets/ElevationProvider-abb53936.js","assets/weather-2eb64924.js","assets/RenderState-1d6218ee.js","assets/NestedMap-1b5db22e.js","assets/VertexElementDescriptor-2925c6af.js","assets/VertexArrayObject-d19dab8d.js","assets/Octree-7cea9440.js","assets/InterleavedLayout-d76b0d59.js","assets/types-1305598a.js","assets/OrderIndependentTransparency-755f7dcc.js","assets/floatRGBA-ca990bbb.js","assets/Intersector-2e1d9db3.js","assets/Intersector-fa865806.js","assets/boundedPlane-1da2f094.js","assets/verticalOffsetUtils-e5214af9.js","assets/orientedBoundingBox-67c5cd22.js","assets/glUtil-ce5ee52b.js","assets/Scheduler-ff5943a4.js","assets/signal-51ed66f5.js","assets/debugFlags-9a30f077.js","assets/VisualElement-187372ae.js","assets/LaserlineVisualElement-c0026af2.js","assets/PointVisualElement-11117df9.js","assets/Object3DVisualElement-459b9b9c.js","assets/ColorMaterial-bdf1f62a.js","assets/VerticalOffset.glsl-5743f98e.js","assets/RightAngleQuadVisualElement-95156bc2.js","assets/snappingUtils-93e84fbe.js","assets/Query-071039d7.js","assets/FullTextSearch-12e0754c.js","assets/QuantizationParameters-f983cf8d.js","assets/screenUtils-8dc4a7f9.js","assets/SnappingContext-90969376.js","assets/PointSnappingHint-671c9f09.js","assets/viewUtils-9f810d02.js","assets/dragEventPipeline3D-4663cd2c.js","assets/ray-8da55042.js","assets/InteractiveToolBase-ddd44c70.js","assets/interfaces-1a80c8eb.js","assets/drawUtils-bd7471ac.js","assets/interfaces-0421c5e6.js","assets/interfaces-b9217804.js","assets/interfaces-1d0b1e46.js","assets/manipulatorUtils-9334c98f.js","assets/AnalysisToolBase-71ee6ca9.js","assets/EditGeometryOperations-c2e73f2d.js","assets/geometry2dUtils-a99dcf3d.js","assets/SceneSnappingManagerPool-2ede5e56.js","assets/SnappingManager-aa70fdd4.js","assets/FeatureFilter-55dd341e.js","assets/floorFilterUtils-080a7cd2.js","assets/SnappingDragPipelineStep-e275580d.js","assets/dehydratedFeatureComparison-7855b188.js","assets/InteractiveAnalysisViewModel-3c9c7b62.js","assets/MeasurementWidgetContent-60198b21.js","assets/UnitSelect-52961079.js","assets/globalCss-94006b67.js"])).default({view:n,unit:r,uiStrings:this._createUIStringsForWidget(t)}):null}default:return null}}_destroyWidgets(){this._widgets.forEach(t=>t.destroy()),this._widgets.clear()}async _getActiveWidget(){const{activeTool:t,view:e}=this;if(!e||!t)return null;let r=null;if(this._widgets.has(t))r=this._widgets.get(t),r.visible=!0;else{if(r=await this._createWidget(t),!r)return null;await r.viewModel.start(),this._widgets.set(t,r)}return r}_createUIStringsForWidget(t){var r;if(!this.uiStrings)return;const e=t+"-"+((r=this.view)==null?void 0:r.type);return this.uiStrings[e]}_updateSubWidgetProperties(){this._widgets.forEach((t,e)=>{const{areaUnit:r,linearUnit:n}=this;t.unit=W(t)?r:n,t.uiStrings=this._createUIStringsForWidget(e)})}};i([s()],a.prototype,"activeTool",null),i([s({readOnly:!0})],a.prototype,"activeWidget",void 0),i([s()],a.prototype,"areaUnit",null),i([s()],a.prototype,"iconClass",void 0),i([s()],a.prototype,"icon",void 0),i([s()],a.prototype,"label",null),i([s()],a.prototype,"linearUnit",null),i([s(),y("esri/widgets/Measurement/t9n/Measurement")],a.prototype,"messages",void 0),i([s()],a.prototype,"uiStrings",void 0),i([s()],a.prototype,"view",null),i([s({type:g})],a.prototype,"viewModel",void 0),a=i([v("esri.widgets.Measurement")],a);const E=a;export{E as default};
