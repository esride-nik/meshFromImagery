import{a5 as n,a6 as s,eU as I,a9 as b,bA as y,_ as v,h7 as f}from"./index-b516d057.js";import{O as w,r as k,n as r,S as x,U as g,x as E}from"./jsxFactory-92036771.js";import{e as P}from"./globalCss-94006b67.js";var m;let a=m=class extends y{constructor(e){super(e),this.autoCloseMenu=!1,this.iconClass=null,this.items=null,this.label=null,this.open=!1,this.selected=!1,this.selectionEnabled=!1,this.clickFunction=null}castItems(e){return e?e.map(t=>t instanceof m?t:new m(t)):null}};n([s()],a.prototype,"autoCloseMenu",void 0),n([s()],a.prototype,"iconClass",void 0),n([s()],a.prototype,"items",void 0),n([I("items")],a.prototype,"castItems",null),n([s()],a.prototype,"label",void 0),n([s()],a.prototype,"open",void 0),n([s()],a.prototype,"selected",void 0),n([s()],a.prototype,"selectionEnabled",void 0),n([s()],a.prototype,"clickFunction",void 0),a=m=n([b("esri.widgets.FeatureTable.Grid.support.ButtonMenuItem")],a);const $=a;let c=class extends y{constructor(e){super(e),this.items=null,this.open=!1}castItems(e){return e?e.map(t=>t instanceof $?t:new $(t)):null}};n([s()],c.prototype,"items",void 0),n([I("items")],c.prototype,"castItems",null),n([s()],c.prototype,"open",void 0),c=n([b("esri.widgets.FeatureTable.Grid.support.ButtonMenuViewModel")],c);const F=c,o="esri-button-menu",l={base:o,content:`${o}__content`,itemWrapper:`${o}__item-wrapper`,label:`${o}__label`,icon:`${o}__icon`,item:`${o}__item`,itemLabel:`${o}__item-label`,itemLabelContent:`${o}__item-label-content`,selectableMenuItem:`${o}__item--selectable`,selectedMenuItem:`${o}__item--selected`,checkbox:`${o}__checkbox`,embeddedContentWrapper:`${o}__embedded-content-wrapper`,button:`${o}__button`,buttonSelected:`${o}__button--selected`};let d=class extends w{constructor(e,t){super(e,t),this._popover=null,this.disabled=!1,this.iconClass="",this.viewModel=new F}loadDependencies(){return k({button:()=>v(()=>import("./calcite-button-5457cec5.js"),["assets/calcite-button-5457cec5.js","assets/button-27a2f99e.js","assets/jsxFactory-92036771.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/uuid-709b6c67.js","assets/form-60623048.js","assets/interactive-39956fb6.js","assets/label2-0071fcd4.js","assets/loadable-7d42c3de.js","assets/locale-2cb18332.js","assets/key-c2c83cc7.js","assets/observers-9c654f26.js","assets/component-7281ffa6.js","assets/t9n-622f279b.js","assets/icon-c122f720.js","assets/loader-ea663d25.js","assets/guid-2347ca41.js"]),popover:()=>v(()=>import("./calcite-popover-c20a56ef.js"),["assets/calcite-popover-c20a56ef.js","assets/popover-33772892.js","assets/jsxFactory-92036771.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/uuid-709b6c67.js","assets/floating-ui-a6c9d5df.js","assets/debounce-7cc294e2.js","assets/Heading-2d7d203c.js","assets/guid-2347ca41.js","assets/openCloseComponent-3fbda1cf.js","assets/locale-2cb18332.js","assets/key-c2c83cc7.js","assets/observers-9c654f26.js","assets/t9n-622f279b.js","assets/loadable-7d42c3de.js","assets/FloatingArrow-9e5c8eb0.js","assets/component-7281ffa6.js","assets/action-79a6733c.js","assets/interactive-39956fb6.js","assets/icon-c122f720.js","assets/loader-ea663d25.js"])})}destroy(){this._popover=null}get items(){return this.viewModel.items}set items(e){this.viewModel.items=e}get open(){return this.viewModel.open}set open(e){this.viewModel.open=e}render(){const{open:e}=this,t=`${this.id}-button`;return r("div",{class:this.classes(l.base,P.widget),key:"menu"},r("calcite-button",{appearance:"transparent",bind:this,class:this.classes(l.button,e&&l.buttonSelected),disabled:this.disabled,iconStart:e?"x":"ellipsis",id:t,kind:"neutral",label:this.label||"button",onclick:()=>this._toggleOpen(e),tabIndex:0}),r("calcite-popover",{afterCreate:x,afterUpdate:()=>{var i;return(i=this._popover)==null?void 0:i.reposition()},autoClose:!0,bind:this,"data-node-ref":"_popover",label:this.label||"menu",open:e,overlayPositioning:"fixed",placement:"bottom",pointerDisabled:!0,referenceElement:t,onCalcitePopoverClose:this._onPopoverClose},this._renderMenuContent()))}_onPopoverClose(){this.open=!1}_renderMenuContent(){var i;const{id:e,open:t}=this;return r("div",{afterCreate:this._afterMenuContentNodeCreate,bind:this,class:l.content,hidden:!t,key:"esri-button-menu-content"},r("ul",{"aria-labelledby":`${e}-button`,bind:this,class:l.itemWrapper,id:`${e}-menu`,role:"menu"},(i=this.items)!=null&&i.length?this._renderItems():null))}_renderItems(){var e;return(e=this.items)==null?void 0:e.map((t,i)=>this._renderItem(t,i))}_renderItem(e,t,i){var _;const p=i!=null?`${this.id}-menu-item-${t}-${i}`:`${this.id}-menu-item-${t}`,h=`${p}-label`,C=this.classes(l.item,e.selectionEnabled?l.selectableMenuItem:null,e.selectionEnabled&&e.selected?l.selectedMenuItem:null);return r("li",{afterCreate:this._afterMenuItemCreate,bind:this,class:C,"data-item-index":t,"data-item-subIndex":i,for:p,key:p,onclick:u=>this._handleMenuItemInteraction(u,e),onkeydown:u=>this._handleMenuItemKeydown(u,e),role:"menuitem",tabIndex:this.disabled?-1:0},r("input",{checked:e.selected,class:l.checkbox,disabled:!0,id:p,name:p,tabIndex:-1,type:"checkbox"}),r("label",{class:l.itemLabel,for:p,id:h},r("span",{"aria-hidden":"true",class:this.classes(l.icon,e.iconClass)}),r("span",{class:l.itemLabelContent},g.sanitize(e.label))),r("ul",{"aria-labelledby":h,class:l.embeddedContentWrapper,id:`${this.id}-submenu`,role:"menu"},(_=e==null?void 0:e.items)==null?void 0:_.map((u,M)=>this._renderItem(u,t,M))))}_handleMenuItemInteraction(e,t){t.selected=!t.selected,t.open=!(!t.selected||!t.items),t.autoCloseMenu&&this.set("open",!1),t.clickFunction&&t.clickFunction({event:e,item:t}),e.stopPropagation()}_handleMenuItemKeydown(e,t){const i=f(e);E(i)&&this._handleMenuItemInteraction(e,t),i==="Escape"&&(this.open=!1,e.preventDefault(),e.stopPropagation())}_afterMenuContentNodeCreate(e){e.focus()}_toggleOpen(e){this.open=!e}_afterMenuItemCreate(e){e["data-item-index"]===0&&e.focus()}};n([s()],d.prototype,"disabled",void 0),n([s()],d.prototype,"iconClass",void 0),n([s()],d.prototype,"items",null),n([s()],d.prototype,"open",null),n([s()],d.prototype,"viewModel",void 0),d=n([b("esri.widgets.FeatureTable.Grid.support.ButtonMenu")],d);const T=d;export{$ as c,T as h};
