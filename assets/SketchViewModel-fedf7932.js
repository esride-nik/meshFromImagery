import{a5 as d,a6 as u,B as se,a9 as A,C as H,g9 as ne,mw as pe,nM as le,il as he,gW as ce,lC as de,nN as ue,fz as X,bg as ee,g_ as ye,eL as me,dS as $,dU as ge,dT as ve,nO as _e,V as K,nP as fe,cd as W,cb as P,dr as k,b9 as x,_ as O,cc as Ee,gj as L,iL as Z,bm as Ge,eh as Oe,eI as be,eJ as Te,di as we,ge as q,an as Se,s as Re,gs as z,iq as Ae,m7 as C}from"./index-b516d057.js";import{l as Y,i as F}from"./elevationInfoUtils-be36d866.js";import{z as Pe}from"./geodesicUtils-822c19ca.js";import{e as B}from"./layerUtils-437666a3.js";import{n as j,_ as E}from"./screenUtils-8dc4a7f9.js";import{w as Ce,e as _}from"./snappingUtils-93e84fbe.js";import{c as te,p as oe}from"./SketchTooltipOptions-cc43c059.js";import{l as ae,P as Me}from"./SnappingManager-aa70fdd4.js";import{r as Ie}from"./hitTestSelectUtils-d512707e.js";function V(e){switch(e){case m.SUPPORTED:break;case m.GRAPHICS_LAYER_MISSING:return"not owned by a graphics layer";case m.GEOMETRY_MISSING:return"no geometry";case m.GEOMETRY_TYPE_UNSUPPORTED:return"the geometry type is not supported";case m.ELEVATION_MODE_UNSUPPORTED:return"the elevation mode is not supported";case m.SYMBOL_TYPE_UNSUPPORTED:return"the symbol type is not supported"}return""}var m;(function(e){e[e.SUPPORTED=0]="SUPPORTED",e[e.GRAPHICS_LAYER_MISSING=1]="GRAPHICS_LAYER_MISSING",e[e.GEOMETRY_MISSING=2]="GEOMETRY_MISSING",e[e.GEOMETRY_TYPE_UNSUPPORTED=3]="GEOMETRY_TYPE_UNSUPPORTED",e[e.ELEVATION_MODE_UNSUPPORTED=4]="ELEVATION_MODE_UNSUPPORTED",e[e.SYMBOL_TYPE_UNSUPPORTED=5]="SYMBOL_TYPE_UNSUPPORTED"})(m||(m={}));function De(e){var t;if(((t=e.layer)==null?void 0:t.type)!=="graphics")return m.GRAPHICS_LAYER_MISSING;if(e.geometry==null)return m.GEOMETRY_MISSING;switch(e.geometry.type){case"polygon":case"point":case"polyline":case"mesh":break;default:return m.GEOMETRY_TYPE_UNSUPPORTED}return Y(e)!=="on-the-ground"&&F(e)?m.ELEVATION_MODE_UNSUPPORTED:m.SUPPORTED}var N;let S=N=class extends H{constructor(...e){super(...e),this.center=null,this.geodesic=!1,this.numberOfPoints=60,this.radius=1e3,this.radiusUnit="meters"}normalizeCtorArgs(e,t){let a;if(e!=null&&e.center)a=e;else{if(e!=null&&e.rings)return super.normalizeCtorArgs(e,t);a={center:e}}return{...super.normalizeCtorArgs(),...a,...t}}initialize(){const e=this.center,t=this.numberOfPoints;if(this.hasZ=(e==null?void 0:e.hasZ)??!1,this.rings.length!==0||!e)return;const a=ne(this.radius,this.radiusUnit,"meters"),o=e.spatialReference;let r,i="geographic";if(o.isWebMercator?i="webMercator":((o.wkid&&pe[o.wkid])!=null||(o.wkt2||o.wkt)&&le(o.wkt2||o.wkt))&&(i="projected"),this.geodesic){let p;switch(i){case"webMercator":p=he(e);break;case"projected":console.error("Creating a geodesic circle requires the center to be specified in web mercator or geographic coordinate system");break;case"geographic":p=e}r=this._createGeodesicCircle(p,a,t),i==="webMercator"&&(r=ce(r))}else{let p;i==="webMercator"||i==="projected"?p=a/de(e.spatialReference):i==="geographic"&&(p=ue(a,"meters",X(e.spatialReference).radius)),r=this._createPlanarCircle(e,p,t)}this.spatialReference=r.spatialReference,this.addRing(r.rings[0])}clone(){const{center:e,numberOfPoints:t,radius:a,radiusUnit:o,geodesic:r}=this;return new N({center:e==null?void 0:e.clone(),numberOfPoints:t,radius:a,radiusUnit:o,geodesic:r})}_createGeodesicCircle(e,t,a){let o=0;const r=[];for(;o<360;){const i=[0,0],p=[e.x,e.y];Pe(i,p,o,t),this.hasZ&&i.push(e.z),r.push(i),o+=360/a}return r.push(r[0]),new H(r)}_createPlanarCircle(e,t,a){const o=[],r=2*Math.PI/a;for(let i=0;i<a;++i){const p=r*i,s=[e.x+Math.cos(-p)*t,e.y+Math.sin(-p)*t];this.hasZ&&s.push(e.z),o.push(s)}return o.push(o[0]),new H({spatialReference:e.spatialReference,rings:[o]})}};d([u({type:se})],S.prototype,"center",void 0),d([u()],S.prototype,"geodesic",void 0),d([u()],S.prototype,"numberOfPoints",void 0),d([u()],S.prototype,"radius",void 0),d([u()],S.prototype,"radiusUnit",void 0),S=N=d([A("esri.geometry.Circle")],S);const Ue=S;function M(e){return ie(e).result}function qe(e){return ie(e).geometry}function ie(e){var o;if(((o=e.layer)==null?void 0:o.type)!=="graphics")return{result:m.GRAPHICS_LAYER_MISSING,geometry:null};const{geometry:t}=e;if(t==null)return{result:m.GEOMETRY_MISSING,geometry:null};if(Y(e)!=="on-the-ground"&&F(e))return{result:m.ELEVATION_MODE_UNSUPPORTED,geometry:null};const a=t.type;return a!=="point"&&a!=="mesh"&&a!=="polyline"&&(a!=="polygon"||e.geometry instanceof Ue)?{result:m.GEOMETRY_TYPE_UNSUPPORTED,geometry:null}:{result:m.SUPPORTED,geometry:t}}function He(e){var a;if(((a=e.layer)==null?void 0:a.type)!=="graphics")return m.GRAPHICS_LAYER_MISSING;if(e.geometry==null)return m.GEOMETRY_MISSING;switch(e.geometry.type){case"point":break;case"polygon":case"polyline":case"multipoint":case"extent":case"mesh":return m.SUPPORTED;default:return m.GEOMETRY_TYPE_UNSUPPORTED}const t=e.symbol!=null&&e.symbol.type==="point-3d"&&e.symbol.symbolLayers;return!t||!t.some(o=>o.type==="object")?m.SYMBOL_TYPE_UNSUPPORTED:Y(e)!=="on-the-ground"&&F(e)?m.ELEVATION_MODE_UNSUPPORTED:m.SUPPORTED}let G=class extends ee.EventedAccessor{constructor(e){super(e),this.cancelled=!1,this.history={undo:[],redo:[]},this.type=null}get tool(){if(!this.activeComponent)return null;switch(this.activeComponent.type){case"graphic-mover":case"move-3d":return"move";case"box":case"transform-3d":return"transform";case"reshape":case"reshape-3d":return"reshape";case"draw-2d":case"draw-3d":return this.activeComponent.geometryType;default:ye(this.activeComponent)}return null}addToHistory(e){this.history.redo=[],this.history.undo.push(e)}resetHistory(){this.history.redo=[],this.history.undo=[]}canUndo(){return this.history.undo.length>0}canRedo(){return this.history.redo.length>0}complete(){this._reset(),this.onEnd(),this.emit("complete")}cancel(){this.cancelled=!0,this.complete()}_reset(){var e;(e=this.activeComponent)==null||e.reset()}refreshComponent(){const e=this.activeComponent;e&&(e.type!=="box"&&e.type!=="reshape"&&e.type!=="graphic-mover"||e.refresh())}set undo(e){this._set("undo",()=>{this.canUndo()&&e()})}set redo(e){this._set("redo",()=>{this.canRedo()&&e()})}};d([u()],G.prototype,"activeComponent",void 0),d([u()],G.prototype,"cancelled",void 0),d([u()],G.prototype,"history",void 0),d([u()],G.prototype,"tool",null),d([u()],G.prototype,"type",void 0),d([u()],G.prototype,"canUndo",null),d([u()],G.prototype,"canRedo",null),d([u()],G.prototype,"onEnd",void 0),d([u()],G.prototype,"undo",null),d([u()],G.prototype,"redo",null),d([u()],G.prototype,"toggleTool",void 0),d([u()],G.prototype,"addToSelection",void 0),d([u()],G.prototype,"removeFromSelection",void 0),G=d([A("esri.widgets.Sketch.support.OperationHandle")],G);let U=class extends G{};d([u()],U.prototype,"activeComponent",void 0),U=d([A("esri.widgets.Sketch.support.CreateOperationHandle")],U);let w=class extends G{};d([u()],w.prototype,"activeComponent",void 0),w=d([A("esri.widgets.Sketch.support.UpdateOperationHandle")],w);const J={defaultZ:0},R={reshapeOptions:{edgeOperation:"split",shapeOperation:"move",vertexOperation:"move"},enableMoveAllGraphics:!0,enableRotation:!0,enableScaling:!0,multipleSelectionEnabled:!0,preserveAspectRatio:!1,toggleToolOnClick:!0,enableZ:!0,highlightOptions:{enabled:!0},tool:"transform"};let v=class extends ee.EventedAccessor{constructor(e){super(e),this._numUpdating=0,this._internalGraphicsLayer=new me({listMode:"hide",internal:!0,title:"SVM Internal"}),this._operationHandle=null,this._viewHandlesKey="viewHandles",this.activeFillSymbol=null,this.activeLineSymbol=null,this.activeVertexSymbol=null,this.allowDeleteKey=!0,this.labelOptions=new te,this.layer=null,this.pointSymbol=new $({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}}),this.polygonSymbol=new ge({color:[150,150,150,.2],outline:{color:[50,50,50],width:2}}),this.polylineSymbol=new ve({color:[130,130,130,1],width:2}),this.meshSymbol=new _e({symbolLayers:new K([new fe])}),this._snappingManager=null,this.tooltipOptions=new oe,this.updateGraphics=new K,this.updateOnGraphicClick=!0,this.vertexSymbol=new $({style:"circle",size:6,color:[255,255,255],outline:{color:[50,50,50],width:1}}),this._moduleLoaderAbortController=null,this._viewReadyAbortController=null,this._originalPopupEnabled=null,this.defaultCreateOptions=J,this.defaultUpdateOptions=R,this.snappingOptions=new ae}initialize(){this.addHandles([W(()=>{var e,t;return(t=(e=this.view)==null?void 0:e.map)==null?void 0:t.layers},"change",e=>{e.removed.includes(this.layer)&&this.cancel()}),W(()=>{var e;return(e=this.layer)==null?void 0:e.graphics},"change",e=>{if(this._operationHandle!=null)for(const t of e.removed)this.updateGraphics.includes(t)&&(this.updateGraphics.length>1?this._operationHandle.removeFromSelection(t):this._operationHandle.cancel())}),P(()=>{var e;return((e=this.layer)==null?void 0:e.elevationInfo)??null},e=>{e!==this._internalGraphicsLayer.elevationInfo&&(this.cancel(),this._internalGraphicsLayer.elevationInfo=e)},k),P(()=>this.view,e=>{x(this._snappingManager),e&&(this._snappingManager=new Me({view:e,options:this.snappingOptions}),e.type==="2d"?O(()=>import("./editingTools-d3eb3050.js"),["assets/editingTools-d3eb3050.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/SnappingVisualizer2D-4547907b.js","assets/enums-f1a6a48a.js","assets/snappingUtils-93e84fbe.js","assets/dehydratedPoint-5a1dfed5.js","assets/Query-071039d7.js","assets/FullTextSearch-12e0754c.js","assets/QuantizationParameters-f983cf8d.js","assets/screenUtils-8dc4a7f9.js","assets/signal-51ed66f5.js","assets/elevationInfoUtils-be36d866.js","assets/SnappingContext-90969376.js","assets/PointSnappingHint-671c9f09.js","assets/editPlaneUtils-f4a70878.js","assets/memoize-3e55df82.js","assets/unitFormatUtils-67047561.js","assets/Cyclical-4c223a04.js","assets/geometryEngine-656a968c.js","assets/geometryEngineBase-dfbd3a67.js","assets/hydrated-40effdd0.js","assets/surfaceCoordinateSystems-1cfad4a3.js","assets/UpdatingHandles-7949a657.js","assets/dehydratedFeatureComparison-7855b188.js","assets/ViewingMode-5d7d590b.js","assets/EditGeometryOperations-c2e73f2d.js","assets/geometry2dUtils-a99dcf3d.js","assets/InteractiveToolBase-ddd44c70.js","assets/hydratedFeatures-2365c307.js","assets/interfaces-1a80c8eb.js","assets/drawUtils-bd7471ac.js","assets/interfaces-0421c5e6.js","assets/SketchTooltipOptions-cc43c059.js","assets/SnappingDragPipelineStep-e275580d.js","assets/Scheduler-ff5943a4.js","assets/debugFlags-9a30f077.js","assets/RenderState-1d6218ee.js","assets/SnappingOperation-4a4ee09b.js","assets/mat2d-d4af8487.js","assets/mat2df64-4d1a9198.js","assets/helpMessageUtils-1ce96584.js","assets/projectVectorToVector-56c29b20.js","assets/coordinateSystem-38339d17.js","assets/boundedPlane-1da2f094.js","assets/SnappingManager-aa70fdd4.js","assets/FeatureFilter-55dd341e.js","assets/floorFilterUtils-080a7cd2.js","assets/viewUtils-9f810d02.js","assets/projectVectorToPoint-fbaf5599.js","assets/projectVectorToWGS84ComparableLonLat-5675a9f4.js","assets/geodesicUtils-822c19ca.js","assets/measurementUtils-3881da59.js","assets/automaticLengthMeasurementUtils-412e2f10.js","assets/themeUtils-7dcf5b71.js","assets/jsxFactory-92036771.js","assets/uuid-709b6c67.js","assets/quantityFormatUtils-e5b1c45f.js","assets/getDefaultUnitForView-d1ffbf16.js","assets/euclideanLengthMeasurementUtils-aa8fca96.js","assets/automaticAreaMeasurementUtils-7a3ffffd.js","assets/euclideanAreaMeasurementUtils-f9ba1710.js","assets/GraphicManipulator-bf7f8b04.js","assets/defaults-4faa92e6.js","assets/defaultsJSON-59981e75.js","assets/drapedUtils-5cffceb9.js","assets/hitTestSelectUtils-d512707e.js","assets/layerUtils-437666a3.js"]):e.type==="3d"&&(O(()=>import("./editingTools-df8b7065.js"),["assets/editingTools-df8b7065.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/elevationInfoUtils-be36d866.js","assets/quantityFormatUtils-e5b1c45f.js","assets/unitFormatUtils-67047561.js","assets/Cyclical-4c223a04.js","assets/getDefaultUnitForView-d1ffbf16.js","assets/TextOverlayItem-7f83875e.js","assets/jsxFactory-92036771.js","assets/uuid-709b6c67.js","assets/automaticLengthMeasurementUtils-412e2f10.js","assets/themeUtils-7dcf5b71.js","assets/memoize-3e55df82.js","assets/snappingUtils-93e84fbe.js","assets/dehydratedPoint-5a1dfed5.js","assets/Query-071039d7.js","assets/FullTextSearch-12e0754c.js","assets/QuantizationParameters-f983cf8d.js","assets/screenUtils-8dc4a7f9.js","assets/signal-51ed66f5.js","assets/euclideanLengthMeasurementUtils-aa8fca96.js","assets/projectVectorToVector-56c29b20.js","assets/measurementUtils-3881da59.js","assets/geometryEngine-656a968c.js","assets/geometryEngineBase-dfbd3a67.js","assets/hydrated-40effdd0.js","assets/projectVectorToWGS84ComparableLonLat-5675a9f4.js","assets/geodesicUtils-822c19ca.js","assets/viewUtils-9f810d02.js","assets/SnappingVisualizer3D-493bdb16.js","assets/ExtendedLineVisualElement-451ab04d.js","assets/vec4f32-0d1b2306.js","assets/frustum-f9d53cdf.js","assets/EngineVisualElement-43f3e8cb.js","assets/RenderGeometry-5dbc1699.js","assets/vec3f32-bac7ea57.js","assets/DefaultTechniqueConfiguration-b4dbe32f.js","assets/requestImageUtils-b142708c.js","assets/enums-bdecffa2.js","assets/Texture-bcb6d63f.js","assets/contextUtils-81fda295.js","assets/interfaces-8918b36f.js","assets/Material-5f4156ac.js","assets/ViewingMode-5d7d590b.js","assets/FramebufferObject-123b7c8d.js","assets/ShaderTechniqueConfiguration-2502462e.js","assets/ElevationProvider-abb53936.js","assets/hydratedFeatures-2365c307.js","assets/weather-2eb64924.js","assets/RenderState-1d6218ee.js","assets/NestedMap-1b5db22e.js","assets/VertexElementDescriptor-2925c6af.js","assets/VertexArrayObject-d19dab8d.js","assets/Octree-7cea9440.js","assets/InterleavedLayout-d76b0d59.js","assets/types-1305598a.js","assets/OrderIndependentTransparency-755f7dcc.js","assets/floatRGBA-ca990bbb.js","assets/Intersector-2e1d9db3.js","assets/Intersector-fa865806.js","assets/boundedPlane-1da2f094.js","assets/verticalOffsetUtils-e5214af9.js","assets/orientedBoundingBox-67c5cd22.js","assets/glUtil-ce5ee52b.js","assets/Scheduler-ff5943a4.js","assets/debugFlags-9a30f077.js","assets/VisualElement-187372ae.js","assets/LaserlineVisualElement-c0026af2.js","assets/PointVisualElement-11117df9.js","assets/Object3DVisualElement-459b9b9c.js","assets/ColorMaterial-bdf1f62a.js","assets/VerticalOffset.glsl-5743f98e.js","assets/RightAngleQuadVisualElement-95156bc2.js","assets/SnappingContext-90969376.js","assets/PointSnappingHint-671c9f09.js","assets/interfaces-1a80c8eb.js","assets/OutlineVisualElement-75d7e05b.js","assets/lineStippleUtils-0688e06c.js","assets/VerticesVisualElement-efafb673.js","assets/manipulatorUtils-9334c98f.js","assets/interfaces-0421c5e6.js","assets/ray-8da55042.js","assets/GraphicState-0d3046df.js","assets/editPlaneUtils-f4a70878.js","assets/surfaceCoordinateSystems-1cfad4a3.js","assets/UpdatingHandles-7949a657.js","assets/dehydratedFeatureComparison-7855b188.js","assets/EditGeometryOperations-c2e73f2d.js","assets/geometry2dUtils-a99dcf3d.js","assets/InteractiveToolBase-ddd44c70.js","assets/drawUtils-bd7471ac.js","assets/SketchTooltipOptions-cc43c059.js","assets/SnappingDragPipelineStep-e275580d.js","assets/SnappingOperation-4a4ee09b.js","assets/mat2d-d4af8487.js","assets/mat2df64-4d1a9198.js","assets/helpMessageUtils-1ce96584.js","assets/coordinateSystem-38339d17.js","assets/SnappingManager-aa70fdd4.js","assets/FeatureFilter-55dd341e.js","assets/floorFilterUtils-080a7cd2.js","assets/projectVectorToPoint-fbaf5599.js","assets/automaticAreaMeasurementUtils-7a3ffffd.js","assets/euclideanAreaMeasurementUtils-f9ba1710.js","assets/helpMessageUtils3d-26675e60.js","assets/manipulatorUtils-c4d6f78f.js","assets/dragEventPipeline3D-4663cd2c.js","assets/GraphicManipulator-bf7f8b04.js","assets/defaults-4faa92e6.js","assets/defaultsJSON-59981e75.js","assets/drapedUtils-5cffceb9.js","assets/TranslateTooltipInfos-e784159d.js","assets/IViewEvents-9a85f53d.js","assets/ShiftManipulator-85ff8a40.js","assets/ImageMaterial-10c9471b.js","assets/SlicePlane-40eedf78.js","assets/persistable-a11ce298.js","assets/MD5-715f37cd.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/resourceExtension-63924db9.js","assets/LineVisualElement-e3bb1937.js","assets/RenderCoordsHelper-8f237859.js","assets/projectVectorToDehydratedPoint-e30a7ff8.js","assets/Factory-829a6ea7.js","assets/ExtentTooltipInfos-e0fd687c.js","assets/layerUtils-437666a3.js","assets/hitTestSelectUtils-d512707e.js"]),O(()=>import("./GraphicsLayerView3D-e20a5d21.js"),["assets/GraphicsLayerView3D-e20a5d21.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/LayerView3D-c03d44fc.js","assets/heightModelInfoUtils-0dd2b6e4.js","assets/HeightModelInfo-b816d32b.js","assets/queryForSymbologySnapping-caae9522.js","assets/projectPointToVectorWithEngine-f608a34a.js","assets/dehydratedPoint-5a1dfed5.js","assets/elevationInfoUtils-be36d866.js","assets/RenderGeometry-5dbc1699.js","assets/vec3f32-bac7ea57.js","assets/DefaultTechniqueConfiguration-b4dbe32f.js","assets/requestImageUtils-b142708c.js","assets/enums-bdecffa2.js","assets/Texture-bcb6d63f.js","assets/contextUtils-81fda295.js","assets/interfaces-8918b36f.js","assets/Material-5f4156ac.js","assets/ViewingMode-5d7d590b.js","assets/FramebufferObject-123b7c8d.js","assets/ShaderTechniqueConfiguration-2502462e.js","assets/ElevationProvider-abb53936.js","assets/hydratedFeatures-2365c307.js","assets/weather-2eb64924.js","assets/RenderState-1d6218ee.js","assets/NestedMap-1b5db22e.js","assets/frustum-f9d53cdf.js","assets/VertexElementDescriptor-2925c6af.js","assets/VertexArrayObject-d19dab8d.js","assets/Octree-7cea9440.js","assets/InterleavedLayout-d76b0d59.js","assets/types-1305598a.js","assets/OrderIndependentTransparency-755f7dcc.js","assets/floatRGBA-ca990bbb.js","assets/Intersector-2e1d9db3.js","assets/Intersector-fa865806.js","assets/boundedPlane-1da2f094.js","assets/verticalOffsetUtils-e5214af9.js","assets/orientedBoundingBox-67c5cd22.js","assets/glUtil-ce5ee52b.js","assets/Scheduler-ff5943a4.js","assets/signal-51ed66f5.js","assets/debugFlags-9a30f077.js","assets/GraphicsProcessor-c903d185.js","assets/UpdatingHandles-7949a657.js","assets/ElevationQuery-a3eaf0a0.js","assets/vec2f32-eaf29605.js","assets/ColorMaterial-bdf1f62a.js","assets/VerticalOffset.glsl-5743f98e.js","assets/dehydratedFeatures-2a3f0608.js","assets/quantizationUtils-17105106.js","assets/featureConversionUtils-09cf00ff.js","assets/OptimizedFeature-e90b69df.js","assets/OptimizedFeatureSet-1d1ac4b9.js","assets/OptimizedGeometry-196224d4.js","assets/edgeUtils-6e4a97fb.js","assets/SnappingCandidate-970faec6.js","assets/objectResourceUtils-003803db.js","assets/devEnvironmentUtils-4eab2a99.js","assets/DefaultMaterial_COLOR_GAMMA-101ea40c.js","assets/Version-1f969b2a.js","assets/resourceUtils-1d03d2fe.js","assets/mat3f32-6c416b1c.js","assets/symbolColorUtils-3ca646c8.js","assets/callExpressionWithFeature-36423058.js","assets/lineStippleUtils-0688e06c.js","assets/projectVectorToDehydratedPoint-e30a7ff8.js","assets/interfaces-1a80c8eb.js","assets/webStyleSymbolUtils-4761c8f2.js","assets/Intersector-a291e778.js","assets/fontUtils-56b88a2f.js","assets/projectVectorToVector-56c29b20.js","assets/Query-071039d7.js","assets/FullTextSearch-12e0754c.js","assets/QuantizationParameters-f983cf8d.js","assets/Graphics3DObjectStates-511adea3.js","assets/jsonUtils-52514725.js","assets/DictionaryLoader-e327eff9.js","assets/FieldsIndex-e8db657f.js","assets/UnknownTimeZone-a05df022.js","assets/HeatmapColorStop-3fff4333.js","assets/heatmapUtils-7f42325f.js","assets/rendererConversion-b2429202.js","assets/basemapUtils-6ec10a55.js","assets/Basemap-8d62c69e.js","assets/loadAll-5e767cfa.js","assets/writeUtils-e226a8aa.js","assets/defaults-4faa92e6.js","assets/defaultsJSON-59981e75.js","assets/optimizedFeatureQueryEngineAdapter-1fecea41.js","assets/PooledRBush-fa11eac4.js","assets/quickselect-bc0541de.js","assets/screenUtils-8dc4a7f9.js","assets/popupUtils-e4ebc84a.js","assets/layerViewUtils-6ebe90f4.js","assets/projectExtentUtils-15e84132.js","assets/geometryServiceUtils-3e048225.js","assets/project-1bd91657.js","assets/LayerView-060b46d4.js"])))},k),P(()=>{var e;return(e=this.view)==null?void 0:e.spatialReference},(e,t)=>{e&&t&&!e.equals(t)&&this.cancel()})]),Ce(this)}destroy(){this.cancel(),this._removeDefaultLayer(),this._snappingManager=x(this._snappingManager),this._set("view",null),this.emit("destroy")}get _defaultUpdateTool(){var e;return((e=this.view)==null?void 0:e.type)==="3d"?"move":"transform"}get updating(){return this._numUpdating>0||this._snappingManager!=null&&this._snappingManager.updating}get activeTool(){var e;return((e=this._operationHandle)==null?void 0:e.tool)??null}get activeComponent(){var e;return((e=this._operationHandle)==null?void 0:e.activeComponent)??null}get createGraphic(){return this.activeComponent==null||this.activeComponent.type!=="draw-3d"&&this.activeComponent.type!=="draw-2d"?this._get("createGraphic"):this.activeComponent.graphic}get defaultCreateOptions(){return this._get("defaultCreateOptions")}set defaultCreateOptions(e){this._set("defaultCreateOptions",{...J,...e})}get defaultUpdateOptions(){return this._get("defaultUpdateOptions")}set defaultUpdateOptions(e){this._set("defaultUpdateOptions",{...R,...e,reshapeOptions:{...R.reshapeOptions,...e==null?void 0:e.reshapeOptions},highlightOptions:{...R.highlightOptions,...e==null?void 0:e.highlightOptions}})}set snappingOptions(e){this._snappingManager!=null&&(this._snappingManager.options=e),this._set("snappingOptions",e)}get state(){var a;const e=!(!((a=this.view)!=null&&a.ready)||!this.layer),t=this._operationHandle;return e&&t?"active":e?"ready":"disabled"}get view(){return this._get("view")}set view(e){const t=this._get("view");if(t){const{container:o,map:r}=t;o&&(t.cursor=null),r==null||r.remove(this._internalGraphicsLayer),this.removeHandles(this._viewHandlesKey),this.cancel()}const a="view-ready";this.removeHandles(a),e&&this.addHandles(Ee(()=>e.ready,o=>{this.removeHandles(this._viewHandlesKey),o&&this.addHandles(this._generateViewHandles(e),this._viewHandlesKey)},k),a),this._set("view",e)}cancel(){this._moduleLoaderAbortController=L(this._moduleLoaderAbortController),this._viewReadyAbortController=L(this._viewReadyAbortController),this._operationHandle&&this._operationHandle.cancel()}complete(){this._operationHandle&&this._operationHandle.complete()}delete(){const{state:e,updateGraphics:t}=this;if(e==="active"&&t.length){const{activeTool:a,layer:o}=this,r=t.toArray();o.removeMany(r),this.cancel(),this._emitDeleteEvent({graphics:r,tool:a})}}duplicate(){if(this.state==="active"&&this.updateGraphics.length){const e=this.updateGraphics.map(t=>t.clone()).toArray();return this.layer.addMany(e),this.emit("duplicate",{graphics:e,type:"duplicate"}),e}return[]}async create(e,t){this.cancel(),await this._waitViewReady();const{view:a,layer:o}=this;if(!a||this.state==="disabled")throw o||this._logMissingLayer(),Z();if(a.activeTool!=null&&(a.activeTool=null),!e)return void this._logError("sketch:missing-parameter","Missing parameter 'tool'.");B(a,this._internalGraphicsLayer);const r=await this._setupCreateOperation(e,t);if(r==null||this.destroyed)return void a.map.remove(this._internalGraphicsLayer);const i=()=>{var p;if(r===this._operationHandle){const s=this.createGraphic,l=this._operationHandle.cancelled;this._operationHandle.destroy(),this._operationHandle=null,this._set("createGraphic",null),(p=this.view)!=null&&p.map&&this.view.map.remove(this._internalGraphicsLayer),r.cancelled||s==null||o.add(s),this.emit("create",{graphic:s,state:l?"cancel":"complete",tool:e,toolEventInfo:null,type:"create"})}};r.on("complete",i),this._operationHandle=r,a.ready&&a.focus()}async update(e,t){this.cancel(),await this._waitViewReady();const{layer:a,view:o,state:r}=this;if(!o||r==="disabled")throw a||this._logMissingLayer(),Z();o.activeTool!=null&&(o.activeTool=null);const i=Array.isArray(e)?e:[e];if(e==null||!(i!=null&&i.length))return void this._logError("sketch:missing-parameter","Missing parameter 'graphics'.");if(i.some(s=>s.layer!==a?(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics missing from the supplied GraphicsLayer."),!0):s.geometry==null&&(this._logError("sketch:invalid-parameter","Parameter 'graphics' contains one or more graphics with an unsupported geometry."),!0)))return;const p=await this._setupUpdateOperation(i,t);this.destroyed||p==null||f(p)||(B(o,this._internalGraphicsLayer),this._setUpdateOperationHandle(p,t),this.emit("update",{graphics:i,state:"start",aborted:!1,tool:p.tool,toolEventInfo:null,type:"update"}))}async _updateSpatialReference(e){const t=this.view;if(t){this._beginAsyncOperation(),e=Array.isArray(e)?e:[e];for(const a of e)a.geometry==null||a.geometry.type==="mesh"||Ge(a.geometry.spatialReference,t.spatialReference)||(Oe(a.geometry.spatialReference,t.spatialReference)||be()||await Te(),a.geometry=we(a.geometry,t.spatialReference));this._endAsyncOperation()}else this._logMissingView()}undo(){var e;this.canUndo()&&((e=this._operationHandle)==null||e.undo())}redo(){var e;this.canRedo()&&((e=this._operationHandle)==null||e.redo())}canUndo(){return!(!this._operationHandle||!this._operationHandle.canUndo())}canRedo(){return!(!this._operationHandle||!this._operationHandle.canRedo())}toggleUpdateTool(){this._operationHandle&&this._operationHandle.toggleTool&&this._operationHandle.toggleTool()}async _getFirstHit(e){const t=this.view;if(!t)return this._logMissingView(),null;if(t.type==="2d"){const r=[];t.map.allLayers.forEach(p=>{p.type!=="vector-tile"&&p.type!=="imagery"||r.push(p)});const i=await t.hitTest(e,{exclude:r});return Ie(i.results)}const a=[t.map.ground];t.map.allLayers.forEach(r=>{r.type==="integrated-mesh"&&a.push(r)});const o=await t.hitTest(e,{exclude:a});if(o.results.length>0){const r=o.results[0];if(r!=null&&r.type==="graphic"&&r.graphic&&(!o.ground.mapPoint||t.map.ground.opacity<1||o.ground.distance-(r.distance??0)>-Math.min(3*o.ground.distance,t.viewingMode==="global"?X(t.renderCoordsHelper.spatialReference).radius/t.renderCoordsHelper.unitInMeters:Number.POSITIVE_INFINITY)))return r}return null}_generateViewHandles(e){return[e.on("immediate-click",async t=>{var i;const a=this.state==="active"&&((i=this._operationHandle)==null?void 0:i.type)==="create";if(this.state==="disabled"||a||!this.updateOnGraphicClick)return;this._beginAsyncOperation();const o=await t.async(()=>this._getFirstHit(j(t)));let r=null;if(o!=null){const p=o.graphic;this.updateGraphics.includes(p)||p.layer===this.layer?(t.stopPropagation(),r=p):e.type!=="2d"||this._isComponentGraphic(p)||this.state!=="active"||this.cancel()}else this.state==="active"&&this.cancel();r==null||this.updateGraphics.includes(r)||await this.update([r],{...this.defaultUpdateOptions,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions}}),this._endAsyncOperation()},E.WIDGET)]}async _setupCreateOperation(e,t){const a=this.view;if(!a)return this._logMissingView(),null;const o={hasZ:a.type==="3d",...this.defaultCreateOptions,...t},r=await this._setupDrawGraphicTool(e,a,o);return r==null?null:(a.tools.add(r),a.activeTool=r,this._setupCreateOperationHandle(r))}async _setupDrawGraphicTool(e,t,a){if(e==="multipoint"&&t.type==="3d")return this._logError("sketch:create","Multipoint geometries are not supported in SceneView."),null;if(!t)return this._logMissingView(),null;const o=e!=="rectangle",r=e!=="rectangle",i={view:t,mode:e==="rectangle"||e==="circle"?"hybrid":"click",...a,snapToScene:!1,geometryType:e,graphicSymbol:this._getGraphicSymbolFromTool(e),snappingManager:this._snappingManager,forceUniformSize:r,centered:o};return t.type==="2d"?this._makeDrawGraphicTool2D(i):this._makeDrawGraphicTool3D(i)}async _makeDrawGraphicTool2D(e){const t=await this._requireModule(O(()=>import("./editingTools-d3eb3050.js"),["assets/editingTools-d3eb3050.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/SnappingVisualizer2D-4547907b.js","assets/enums-f1a6a48a.js","assets/snappingUtils-93e84fbe.js","assets/dehydratedPoint-5a1dfed5.js","assets/Query-071039d7.js","assets/FullTextSearch-12e0754c.js","assets/QuantizationParameters-f983cf8d.js","assets/screenUtils-8dc4a7f9.js","assets/signal-51ed66f5.js","assets/elevationInfoUtils-be36d866.js","assets/SnappingContext-90969376.js","assets/PointSnappingHint-671c9f09.js","assets/editPlaneUtils-f4a70878.js","assets/memoize-3e55df82.js","assets/unitFormatUtils-67047561.js","assets/Cyclical-4c223a04.js","assets/geometryEngine-656a968c.js","assets/geometryEngineBase-dfbd3a67.js","assets/hydrated-40effdd0.js","assets/surfaceCoordinateSystems-1cfad4a3.js","assets/UpdatingHandles-7949a657.js","assets/dehydratedFeatureComparison-7855b188.js","assets/ViewingMode-5d7d590b.js","assets/EditGeometryOperations-c2e73f2d.js","assets/geometry2dUtils-a99dcf3d.js","assets/InteractiveToolBase-ddd44c70.js","assets/hydratedFeatures-2365c307.js","assets/interfaces-1a80c8eb.js","assets/drawUtils-bd7471ac.js","assets/interfaces-0421c5e6.js","assets/SketchTooltipOptions-cc43c059.js","assets/SnappingDragPipelineStep-e275580d.js","assets/Scheduler-ff5943a4.js","assets/debugFlags-9a30f077.js","assets/RenderState-1d6218ee.js","assets/SnappingOperation-4a4ee09b.js","assets/mat2d-d4af8487.js","assets/mat2df64-4d1a9198.js","assets/helpMessageUtils-1ce96584.js","assets/projectVectorToVector-56c29b20.js","assets/coordinateSystem-38339d17.js","assets/boundedPlane-1da2f094.js","assets/SnappingManager-aa70fdd4.js","assets/FeatureFilter-55dd341e.js","assets/floorFilterUtils-080a7cd2.js","assets/viewUtils-9f810d02.js","assets/projectVectorToPoint-fbaf5599.js","assets/projectVectorToWGS84ComparableLonLat-5675a9f4.js","assets/geodesicUtils-822c19ca.js","assets/measurementUtils-3881da59.js","assets/automaticLengthMeasurementUtils-412e2f10.js","assets/themeUtils-7dcf5b71.js","assets/jsxFactory-92036771.js","assets/uuid-709b6c67.js","assets/quantityFormatUtils-e5b1c45f.js","assets/getDefaultUnitForView-d1ffbf16.js","assets/euclideanLengthMeasurementUtils-aa8fca96.js","assets/automaticAreaMeasurementUtils-7a3ffffd.js","assets/euclideanAreaMeasurementUtils-f9ba1710.js","assets/GraphicManipulator-bf7f8b04.js","assets/defaults-4faa92e6.js","assets/defaultsJSON-59981e75.js","assets/drapedUtils-5cffceb9.js","assets/hitTestSelectUtils-d512707e.js","assets/layerUtils-437666a3.js"]));return f(t)||this.destroyed?null:new t.module.DrawGraphicTool2D({...e,activeVertexSymbol:this.activeVertexSymbol,regularVerticesSymbol:this.vertexSymbol,activeLineSymbol:this.activeLineSymbol,activeFillSymbol:xe(e.geometryType)?this.activeFillSymbol:null,tooltipOptions:this.tooltipOptions})}async _makeDrawGraphicTool3D(e){const t=await this._requireModule(O(()=>import("./editingTools-df8b7065.js"),["assets/editingTools-df8b7065.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/elevationInfoUtils-be36d866.js","assets/quantityFormatUtils-e5b1c45f.js","assets/unitFormatUtils-67047561.js","assets/Cyclical-4c223a04.js","assets/getDefaultUnitForView-d1ffbf16.js","assets/TextOverlayItem-7f83875e.js","assets/jsxFactory-92036771.js","assets/uuid-709b6c67.js","assets/automaticLengthMeasurementUtils-412e2f10.js","assets/themeUtils-7dcf5b71.js","assets/memoize-3e55df82.js","assets/snappingUtils-93e84fbe.js","assets/dehydratedPoint-5a1dfed5.js","assets/Query-071039d7.js","assets/FullTextSearch-12e0754c.js","assets/QuantizationParameters-f983cf8d.js","assets/screenUtils-8dc4a7f9.js","assets/signal-51ed66f5.js","assets/euclideanLengthMeasurementUtils-aa8fca96.js","assets/projectVectorToVector-56c29b20.js","assets/measurementUtils-3881da59.js","assets/geometryEngine-656a968c.js","assets/geometryEngineBase-dfbd3a67.js","assets/hydrated-40effdd0.js","assets/projectVectorToWGS84ComparableLonLat-5675a9f4.js","assets/geodesicUtils-822c19ca.js","assets/viewUtils-9f810d02.js","assets/SnappingVisualizer3D-493bdb16.js","assets/ExtendedLineVisualElement-451ab04d.js","assets/vec4f32-0d1b2306.js","assets/frustum-f9d53cdf.js","assets/EngineVisualElement-43f3e8cb.js","assets/RenderGeometry-5dbc1699.js","assets/vec3f32-bac7ea57.js","assets/DefaultTechniqueConfiguration-b4dbe32f.js","assets/requestImageUtils-b142708c.js","assets/enums-bdecffa2.js","assets/Texture-bcb6d63f.js","assets/contextUtils-81fda295.js","assets/interfaces-8918b36f.js","assets/Material-5f4156ac.js","assets/ViewingMode-5d7d590b.js","assets/FramebufferObject-123b7c8d.js","assets/ShaderTechniqueConfiguration-2502462e.js","assets/ElevationProvider-abb53936.js","assets/hydratedFeatures-2365c307.js","assets/weather-2eb64924.js","assets/RenderState-1d6218ee.js","assets/NestedMap-1b5db22e.js","assets/VertexElementDescriptor-2925c6af.js","assets/VertexArrayObject-d19dab8d.js","assets/Octree-7cea9440.js","assets/InterleavedLayout-d76b0d59.js","assets/types-1305598a.js","assets/OrderIndependentTransparency-755f7dcc.js","assets/floatRGBA-ca990bbb.js","assets/Intersector-2e1d9db3.js","assets/Intersector-fa865806.js","assets/boundedPlane-1da2f094.js","assets/verticalOffsetUtils-e5214af9.js","assets/orientedBoundingBox-67c5cd22.js","assets/glUtil-ce5ee52b.js","assets/Scheduler-ff5943a4.js","assets/debugFlags-9a30f077.js","assets/VisualElement-187372ae.js","assets/LaserlineVisualElement-c0026af2.js","assets/PointVisualElement-11117df9.js","assets/Object3DVisualElement-459b9b9c.js","assets/ColorMaterial-bdf1f62a.js","assets/VerticalOffset.glsl-5743f98e.js","assets/RightAngleQuadVisualElement-95156bc2.js","assets/SnappingContext-90969376.js","assets/PointSnappingHint-671c9f09.js","assets/interfaces-1a80c8eb.js","assets/OutlineVisualElement-75d7e05b.js","assets/lineStippleUtils-0688e06c.js","assets/VerticesVisualElement-efafb673.js","assets/manipulatorUtils-9334c98f.js","assets/interfaces-0421c5e6.js","assets/ray-8da55042.js","assets/GraphicState-0d3046df.js","assets/editPlaneUtils-f4a70878.js","assets/surfaceCoordinateSystems-1cfad4a3.js","assets/UpdatingHandles-7949a657.js","assets/dehydratedFeatureComparison-7855b188.js","assets/EditGeometryOperations-c2e73f2d.js","assets/geometry2dUtils-a99dcf3d.js","assets/InteractiveToolBase-ddd44c70.js","assets/drawUtils-bd7471ac.js","assets/SketchTooltipOptions-cc43c059.js","assets/SnappingDragPipelineStep-e275580d.js","assets/SnappingOperation-4a4ee09b.js","assets/mat2d-d4af8487.js","assets/mat2df64-4d1a9198.js","assets/helpMessageUtils-1ce96584.js","assets/coordinateSystem-38339d17.js","assets/SnappingManager-aa70fdd4.js","assets/FeatureFilter-55dd341e.js","assets/floorFilterUtils-080a7cd2.js","assets/projectVectorToPoint-fbaf5599.js","assets/automaticAreaMeasurementUtils-7a3ffffd.js","assets/euclideanAreaMeasurementUtils-f9ba1710.js","assets/helpMessageUtils3d-26675e60.js","assets/manipulatorUtils-c4d6f78f.js","assets/dragEventPipeline3D-4663cd2c.js","assets/GraphicManipulator-bf7f8b04.js","assets/defaults-4faa92e6.js","assets/defaultsJSON-59981e75.js","assets/drapedUtils-5cffceb9.js","assets/TranslateTooltipInfos-e784159d.js","assets/IViewEvents-9a85f53d.js","assets/ShiftManipulator-85ff8a40.js","assets/ImageMaterial-10c9471b.js","assets/SlicePlane-40eedf78.js","assets/persistable-a11ce298.js","assets/MD5-715f37cd.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/resourceExtension-63924db9.js","assets/LineVisualElement-e3bb1937.js","assets/RenderCoordsHelper-8f237859.js","assets/projectVectorToDehydratedPoint-e30a7ff8.js","assets/Factory-829a6ea7.js","assets/ExtentTooltipInfos-e0fd687c.js","assets/layerUtils-437666a3.js","assets/hitTestSelectUtils-d512707e.js"]));if(f(t)||this.destroyed)return null;const{elevationInfo:a}=this.layer;return new t.module.DrawGraphicTool3D({...e,elevationInfo:a,snapToScene:a==null||a.mode==="absolute-height",labelOptions:this.labelOptions,tooltipOptions:this.tooltipOptions})}_setupCreateOperationHandle(e){const t=this.view;if(!t)return this._logMissingView(),null;let a=null;const o=e.forceUniformSize,r=e.centered,i=[t.on("key-down",s=>{if(s.key===_.pan)s.stopPropagation(),s.repeat||(e.enabled=!1);else if(s.key===_.complete)s.stopPropagation(),e.completeCreateOperation();else if(s.key!==_.vertexAdd||s.repeat)s.key===_.undo?(s.stopPropagation(),p.undo()):s.key===_.redo?(s.stopPropagation(),p.redo()):s.key!==_.constraint||e.geometryType!=="rectangle"&&e.geometryType!=="circle"||s.repeat?s.key===_.center&&(s.repeat||(e.centered=!r,s.stopPropagation())):(e.forceUniformSize=!o,s.stopPropagation());else{const l=e.drawOperation.geometryType;l!=="polyline"&&l!=="polygon"&&l!=="multipoint"||(s.stopPropagation(),e.drawOperation.commitStagedVertex())}},E.WIDGET),t.on("key-up",s=>{s.key===_.pan?e.enabled=!0:s.key!==_.constraint||e.geometryType!=="rectangle"&&e.geometryType!=="circle"?s.key===_.center&&(e.centered=r,s.stopPropagation()):(e.forceUniformSize=o,s.stopPropagation())},E.WIDGET),e.on("vertex-add",s=>{switch(a=a==null?"start":"active",s.operation){case"apply":this.emit("create",{graphic:e.graphic,state:a,tool:this.activeTool,toolEventInfo:s,type:"create"});break;case"undo":this._emitUndoEvent({graphics:[e.graphic],tool:e.geometryType});break;case"redo":this._emitRedoEvent({graphics:[e.graphic],tool:e.geometryType})}}),e.on("cursor-update",s=>{e.drawOperation.numCommittedVertices>0&&this.emit("create",{graphic:e.graphic,state:"active",tool:this.activeTool,toolEventInfo:{coordinates:s.vertices[0].coordinates,type:"cursor-update"},type:"create"})}),e.on("vertex-remove",s=>{switch(s.operation){case"apply":this.emit("create",{graphic:e.graphic,state:"active",tool:this.activeTool,toolEventInfo:s,type:"create"});break;case"undo":this._emitUndoEvent({graphics:[e.graphic],tool:e.geometryType});break;case"redo":this._emitRedoEvent({graphics:[e.graphic],tool:e.geometryType})}}),e.on("complete",s=>{this._set("createGraphic",s.graphic),a="complete",s.aborted?p&&p.cancel():p&&p.complete()}),P(()=>this._getGraphicSymbolFromTool(e.geometryType),s=>{e.graphicSymbol=s})],p=new U({activeComponent:e,tool:e.geometryType,type:"create",onEnd:()=>{var s;i.forEach(l=>l.remove()),i.length=0,(s=t.tools)==null||s.remove(e)},undo:()=>{e.canUndo&&e.undo()},redo:()=>{e.canRedo&&e.redo()},canUndo:()=>e.canUndo,canRedo:()=>e.canRedo});return p}_getGraphicSymbolFromTool(e){switch(e){case"point":case"multipoint":return this.pointSymbol;case"polyline":return this.polylineSymbol;case"circle":case"rectangle":case"polygon":return this.polygonSymbol;case"mesh":return this.meshSymbol}}async _setupUpdateOperation(e,t){var p;const{layer:a,view:o}=this;if(!o)return this._logMissingView(),null;const r={tool:this._defaultUpdateTool,...this.defaultUpdateOptions,...t,reshapeOptions:{...this.defaultUpdateOptions.reshapeOptions,...t==null?void 0:t.reshapeOptions},highlightOptions:{...this.defaultUpdateOptions.highlightOptions,...t==null?void 0:t.highlightOptions}};let i=r.tool;for(const s of e)a.remove(s),a.add(s);if(o.type==="3d"){if(e.length===0)return null;switch(i){case"move":return this._setupMove3DOperation(e,r,o,i);case"reshape":{if(e.length>1)return this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null;const s=M(e[0]);return s===m.SUPPORTED?this._setupReshape3DOperation(e[0],r,o):(this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${V(s)}).`),null)}case"transform":return this._setupGraphicTransform3DOperation(e,r,o)}}switch(i){case"move":return this._setupMove2DOperation(e,r,o);case"reshape":{if(e.length>1)return this._logError("sketch:reshape-multiple","Reshape operation does not support multiple graphics."),null;const s=M(e[0]);return s===m.SUPPORTED?this._setupTransformOrReshape2DOperation(e,i,r,o):(this._logError("sketch:reshape",`Reshape operation not supported for provided graphic(s) (${V(s)}).`),null)}case"transform":if(e.length===1){const s=(p=e[0].geometry)==null?void 0:p.type;s!=="point"&&s!=="multipoint"||(i="reshape")}return this._setupTransformOrReshape2DOperation(e,i,r,o)}}async _setupMove3DOperation(e,t,a,o,r=!1){for(const n of e){const h=De(n);if(h!==m.SUPPORTED)return this._logError("sketch:move",`Move operation not supported for provided graphic(s) (${V(h)}).`),null}const i=await this._requireModule(O(()=>import("./editingTools-df8b7065.js"),["assets/editingTools-df8b7065.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/elevationInfoUtils-be36d866.js","assets/quantityFormatUtils-e5b1c45f.js","assets/unitFormatUtils-67047561.js","assets/Cyclical-4c223a04.js","assets/getDefaultUnitForView-d1ffbf16.js","assets/TextOverlayItem-7f83875e.js","assets/jsxFactory-92036771.js","assets/uuid-709b6c67.js","assets/automaticLengthMeasurementUtils-412e2f10.js","assets/themeUtils-7dcf5b71.js","assets/memoize-3e55df82.js","assets/snappingUtils-93e84fbe.js","assets/dehydratedPoint-5a1dfed5.js","assets/Query-071039d7.js","assets/FullTextSearch-12e0754c.js","assets/QuantizationParameters-f983cf8d.js","assets/screenUtils-8dc4a7f9.js","assets/signal-51ed66f5.js","assets/euclideanLengthMeasurementUtils-aa8fca96.js","assets/projectVectorToVector-56c29b20.js","assets/measurementUtils-3881da59.js","assets/geometryEngine-656a968c.js","assets/geometryEngineBase-dfbd3a67.js","assets/hydrated-40effdd0.js","assets/projectVectorToWGS84ComparableLonLat-5675a9f4.js","assets/geodesicUtils-822c19ca.js","assets/viewUtils-9f810d02.js","assets/SnappingVisualizer3D-493bdb16.js","assets/ExtendedLineVisualElement-451ab04d.js","assets/vec4f32-0d1b2306.js","assets/frustum-f9d53cdf.js","assets/EngineVisualElement-43f3e8cb.js","assets/RenderGeometry-5dbc1699.js","assets/vec3f32-bac7ea57.js","assets/DefaultTechniqueConfiguration-b4dbe32f.js","assets/requestImageUtils-b142708c.js","assets/enums-bdecffa2.js","assets/Texture-bcb6d63f.js","assets/contextUtils-81fda295.js","assets/interfaces-8918b36f.js","assets/Material-5f4156ac.js","assets/ViewingMode-5d7d590b.js","assets/FramebufferObject-123b7c8d.js","assets/ShaderTechniqueConfiguration-2502462e.js","assets/ElevationProvider-abb53936.js","assets/hydratedFeatures-2365c307.js","assets/weather-2eb64924.js","assets/RenderState-1d6218ee.js","assets/NestedMap-1b5db22e.js","assets/VertexElementDescriptor-2925c6af.js","assets/VertexArrayObject-d19dab8d.js","assets/Octree-7cea9440.js","assets/InterleavedLayout-d76b0d59.js","assets/types-1305598a.js","assets/OrderIndependentTransparency-755f7dcc.js","assets/floatRGBA-ca990bbb.js","assets/Intersector-2e1d9db3.js","assets/Intersector-fa865806.js","assets/boundedPlane-1da2f094.js","assets/verticalOffsetUtils-e5214af9.js","assets/orientedBoundingBox-67c5cd22.js","assets/glUtil-ce5ee52b.js","assets/Scheduler-ff5943a4.js","assets/debugFlags-9a30f077.js","assets/VisualElement-187372ae.js","assets/LaserlineVisualElement-c0026af2.js","assets/PointVisualElement-11117df9.js","assets/Object3DVisualElement-459b9b9c.js","assets/ColorMaterial-bdf1f62a.js","assets/VerticalOffset.glsl-5743f98e.js","assets/RightAngleQuadVisualElement-95156bc2.js","assets/SnappingContext-90969376.js","assets/PointSnappingHint-671c9f09.js","assets/interfaces-1a80c8eb.js","assets/OutlineVisualElement-75d7e05b.js","assets/lineStippleUtils-0688e06c.js","assets/VerticesVisualElement-efafb673.js","assets/manipulatorUtils-9334c98f.js","assets/interfaces-0421c5e6.js","assets/ray-8da55042.js","assets/GraphicState-0d3046df.js","assets/editPlaneUtils-f4a70878.js","assets/surfaceCoordinateSystems-1cfad4a3.js","assets/UpdatingHandles-7949a657.js","assets/dehydratedFeatureComparison-7855b188.js","assets/EditGeometryOperations-c2e73f2d.js","assets/geometry2dUtils-a99dcf3d.js","assets/InteractiveToolBase-ddd44c70.js","assets/drawUtils-bd7471ac.js","assets/SketchTooltipOptions-cc43c059.js","assets/SnappingDragPipelineStep-e275580d.js","assets/SnappingOperation-4a4ee09b.js","assets/mat2d-d4af8487.js","assets/mat2df64-4d1a9198.js","assets/helpMessageUtils-1ce96584.js","assets/coordinateSystem-38339d17.js","assets/SnappingManager-aa70fdd4.js","assets/FeatureFilter-55dd341e.js","assets/floorFilterUtils-080a7cd2.js","assets/projectVectorToPoint-fbaf5599.js","assets/automaticAreaMeasurementUtils-7a3ffffd.js","assets/euclideanAreaMeasurementUtils-f9ba1710.js","assets/helpMessageUtils3d-26675e60.js","assets/manipulatorUtils-c4d6f78f.js","assets/dragEventPipeline3D-4663cd2c.js","assets/GraphicManipulator-bf7f8b04.js","assets/defaults-4faa92e6.js","assets/defaultsJSON-59981e75.js","assets/drapedUtils-5cffceb9.js","assets/TranslateTooltipInfos-e784159d.js","assets/IViewEvents-9a85f53d.js","assets/ShiftManipulator-85ff8a40.js","assets/ImageMaterial-10c9471b.js","assets/SlicePlane-40eedf78.js","assets/persistable-a11ce298.js","assets/MD5-715f37cd.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/resourceExtension-63924db9.js","assets/LineVisualElement-e3bb1937.js","assets/RenderCoordsHelper-8f237859.js","assets/projectVectorToDehydratedPoint-e30a7ff8.js","assets/Factory-829a6ea7.js","assets/ExtentTooltipInfos-e0fd687c.js","assets/layerUtils-437666a3.js","assets/hitTestSelectUtils-d512707e.js"]));if(f(i))return i;const p=new i.module.GraphicMoveTool({view:a,enableZ:t.enableZ,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions});a.tools.add(p),p.graphics.addMany(e),r||this.updateGraphics.addMany(e);const s=[],l=new w({activeComponent:p,tool:o,type:"update",onEnd:()=>{var n;s.forEach(h=>h.remove()),s.length=0,(n=a.tools)==null||n.remove(p),p.destroyed||p.destroy()},undo:()=>{I(l,this.updateGraphics.toArray()),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:o})},redo:()=>{D(l,this.updateGraphics.toArray()),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:o})},addToSelection:n=>{this.updateGraphics.push(n),p.graphics.push(n),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[n],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:n=>{const h=this.updateGraphics.indexOf(n);l.history.undo.forEach(c=>c.updates.splice(h,1)),l.history.redo.forEach(c=>c.updates.splice(h,1)),this.updateGraphics.remove(n),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[n],type:"selection-change"},type:"update"}),this.updateGraphics.length!==0?p.graphics.remove(n):l.complete()},toggleTool:async()=>{if(this.updateGraphics.length!==1||t.toggleToolOnClick===!1||o!=="transform")return;const n=this.updateGraphics.at(0);if(M(n)!==m.SUPPORTED)return;l.onEnd(),l.destroy();const h=await this._setupReshape3DOperation(n,t,a,!0);f(h)||this._setUpdateOperationHandle(h,t)}});return s.push(...this._getHandlesForComponent(l,t),a.on("immediate-click",n=>this._getCommonUpdateOperationClickHandlers(l,n,t),E.WIDGET),a.on("key-down",n=>{this._getCommonUpdateOperationKeyDownHandlers(l,n)},E.WIDGET)),l}_setupGraphicTransform3DOperation(e,t,a,o=!1){if(e.length===1&&He(e[0])===m.SUPPORTED){const r=e[0],i=r.geometry;if(i!=null&&(i.type==="point"||i.type==="mesh"))return this._setupPointTransform3DOperation(r,t,a);if(i!=null&&(i.type==="polygon"||i.type==="polyline"))return this._setupPolyTransform3DOperation(r,t,a,o)}return this._setupMove3DOperation(e,t,a,"transform",o)}async _setupPointTransform3DOperation(e,t,a){const o="transform",{enableRotation:r,enableScaling:i,enableZ:p}=t,s=await this._requireModule(O(()=>import("./editingTools-df8b7065.js"),["assets/editingTools-df8b7065.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/elevationInfoUtils-be36d866.js","assets/quantityFormatUtils-e5b1c45f.js","assets/unitFormatUtils-67047561.js","assets/Cyclical-4c223a04.js","assets/getDefaultUnitForView-d1ffbf16.js","assets/TextOverlayItem-7f83875e.js","assets/jsxFactory-92036771.js","assets/uuid-709b6c67.js","assets/automaticLengthMeasurementUtils-412e2f10.js","assets/themeUtils-7dcf5b71.js","assets/memoize-3e55df82.js","assets/snappingUtils-93e84fbe.js","assets/dehydratedPoint-5a1dfed5.js","assets/Query-071039d7.js","assets/FullTextSearch-12e0754c.js","assets/QuantizationParameters-f983cf8d.js","assets/screenUtils-8dc4a7f9.js","assets/signal-51ed66f5.js","assets/euclideanLengthMeasurementUtils-aa8fca96.js","assets/projectVectorToVector-56c29b20.js","assets/measurementUtils-3881da59.js","assets/geometryEngine-656a968c.js","assets/geometryEngineBase-dfbd3a67.js","assets/hydrated-40effdd0.js","assets/projectVectorToWGS84ComparableLonLat-5675a9f4.js","assets/geodesicUtils-822c19ca.js","assets/viewUtils-9f810d02.js","assets/SnappingVisualizer3D-493bdb16.js","assets/ExtendedLineVisualElement-451ab04d.js","assets/vec4f32-0d1b2306.js","assets/frustum-f9d53cdf.js","assets/EngineVisualElement-43f3e8cb.js","assets/RenderGeometry-5dbc1699.js","assets/vec3f32-bac7ea57.js","assets/DefaultTechniqueConfiguration-b4dbe32f.js","assets/requestImageUtils-b142708c.js","assets/enums-bdecffa2.js","assets/Texture-bcb6d63f.js","assets/contextUtils-81fda295.js","assets/interfaces-8918b36f.js","assets/Material-5f4156ac.js","assets/ViewingMode-5d7d590b.js","assets/FramebufferObject-123b7c8d.js","assets/ShaderTechniqueConfiguration-2502462e.js","assets/ElevationProvider-abb53936.js","assets/hydratedFeatures-2365c307.js","assets/weather-2eb64924.js","assets/RenderState-1d6218ee.js","assets/NestedMap-1b5db22e.js","assets/VertexElementDescriptor-2925c6af.js","assets/VertexArrayObject-d19dab8d.js","assets/Octree-7cea9440.js","assets/InterleavedLayout-d76b0d59.js","assets/types-1305598a.js","assets/OrderIndependentTransparency-755f7dcc.js","assets/floatRGBA-ca990bbb.js","assets/Intersector-2e1d9db3.js","assets/Intersector-fa865806.js","assets/boundedPlane-1da2f094.js","assets/verticalOffsetUtils-e5214af9.js","assets/orientedBoundingBox-67c5cd22.js","assets/glUtil-ce5ee52b.js","assets/Scheduler-ff5943a4.js","assets/debugFlags-9a30f077.js","assets/VisualElement-187372ae.js","assets/LaserlineVisualElement-c0026af2.js","assets/PointVisualElement-11117df9.js","assets/Object3DVisualElement-459b9b9c.js","assets/ColorMaterial-bdf1f62a.js","assets/VerticalOffset.glsl-5743f98e.js","assets/RightAngleQuadVisualElement-95156bc2.js","assets/SnappingContext-90969376.js","assets/PointSnappingHint-671c9f09.js","assets/interfaces-1a80c8eb.js","assets/OutlineVisualElement-75d7e05b.js","assets/lineStippleUtils-0688e06c.js","assets/VerticesVisualElement-efafb673.js","assets/manipulatorUtils-9334c98f.js","assets/interfaces-0421c5e6.js","assets/ray-8da55042.js","assets/GraphicState-0d3046df.js","assets/editPlaneUtils-f4a70878.js","assets/surfaceCoordinateSystems-1cfad4a3.js","assets/UpdatingHandles-7949a657.js","assets/dehydratedFeatureComparison-7855b188.js","assets/EditGeometryOperations-c2e73f2d.js","assets/geometry2dUtils-a99dcf3d.js","assets/InteractiveToolBase-ddd44c70.js","assets/drawUtils-bd7471ac.js","assets/SketchTooltipOptions-cc43c059.js","assets/SnappingDragPipelineStep-e275580d.js","assets/SnappingOperation-4a4ee09b.js","assets/mat2d-d4af8487.js","assets/mat2df64-4d1a9198.js","assets/helpMessageUtils-1ce96584.js","assets/coordinateSystem-38339d17.js","assets/SnappingManager-aa70fdd4.js","assets/FeatureFilter-55dd341e.js","assets/floorFilterUtils-080a7cd2.js","assets/projectVectorToPoint-fbaf5599.js","assets/automaticAreaMeasurementUtils-7a3ffffd.js","assets/euclideanAreaMeasurementUtils-f9ba1710.js","assets/helpMessageUtils3d-26675e60.js","assets/manipulatorUtils-c4d6f78f.js","assets/dragEventPipeline3D-4663cd2c.js","assets/GraphicManipulator-bf7f8b04.js","assets/defaults-4faa92e6.js","assets/defaultsJSON-59981e75.js","assets/drapedUtils-5cffceb9.js","assets/TranslateTooltipInfos-e784159d.js","assets/IViewEvents-9a85f53d.js","assets/ShiftManipulator-85ff8a40.js","assets/ImageMaterial-10c9471b.js","assets/SlicePlane-40eedf78.js","assets/persistable-a11ce298.js","assets/MD5-715f37cd.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/resourceExtension-63924db9.js","assets/LineVisualElement-e3bb1937.js","assets/RenderCoordsHelper-8f237859.js","assets/projectVectorToDehydratedPoint-e30a7ff8.js","assets/Factory-829a6ea7.js","assets/ExtentTooltipInfos-e0fd687c.js","assets/layerUtils-437666a3.js","assets/hitTestSelectUtils-d512707e.js"]));if(f(s))return s;const l=new s.module.GraphicTransformTool({graphic:e,view:a,enableRotation:r,enableScaling:i,enableZ:p,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions});a.tools.add(l),this.updateGraphics.add(e);const n=[],h=new w({activeComponent:l,tool:o,type:"update",onEnd:()=>{var c;n.forEach(g=>g.remove()),n.length=0,(c=a.tools)==null||c.remove(l),l.destroyed||l.destroy()},undo:()=>{I(h,this.updateGraphics.toArray()),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:o})},redo:()=>{D(h,this.updateGraphics.toArray()),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:o})},addToSelection:async c=>{this.updateGraphics.add(c),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[c],removed:[],type:"selection-change"},type:"update"}),h.onEnd(),h.destroy();const g=await this._setupMove3DOperation(this.updateGraphics.toArray(),t,a,"transform",!0);f(g)||this._setUpdateOperationHandle(g,t)},removeFromSelection:c=>{this.updateGraphics.remove(c),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[c],type:"selection-change"},type:"update"}),h.complete()},toggleTool:()=>{}});return n.push(...this._getHandlesForComponent(h,t),a.on("immediate-click",c=>this._getCommonUpdateOperationClickHandlers(h,c,t),E.WIDGET),a.on("key-down",c=>{this._getCommonUpdateOperationKeyDownHandlers(h,c)},E.WIDGET)),h}async _setupPolyTransform3DOperation(e,t,a,o=!1){const r="transform",{enableRotation:i,enableScaling:p,enableZ:s,preserveAspectRatio:l}=t,n=await this._requireModule(O(()=>import("./editingTools-df8b7065.js"),["assets/editingTools-df8b7065.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/elevationInfoUtils-be36d866.js","assets/quantityFormatUtils-e5b1c45f.js","assets/unitFormatUtils-67047561.js","assets/Cyclical-4c223a04.js","assets/getDefaultUnitForView-d1ffbf16.js","assets/TextOverlayItem-7f83875e.js","assets/jsxFactory-92036771.js","assets/uuid-709b6c67.js","assets/automaticLengthMeasurementUtils-412e2f10.js","assets/themeUtils-7dcf5b71.js","assets/memoize-3e55df82.js","assets/snappingUtils-93e84fbe.js","assets/dehydratedPoint-5a1dfed5.js","assets/Query-071039d7.js","assets/FullTextSearch-12e0754c.js","assets/QuantizationParameters-f983cf8d.js","assets/screenUtils-8dc4a7f9.js","assets/signal-51ed66f5.js","assets/euclideanLengthMeasurementUtils-aa8fca96.js","assets/projectVectorToVector-56c29b20.js","assets/measurementUtils-3881da59.js","assets/geometryEngine-656a968c.js","assets/geometryEngineBase-dfbd3a67.js","assets/hydrated-40effdd0.js","assets/projectVectorToWGS84ComparableLonLat-5675a9f4.js","assets/geodesicUtils-822c19ca.js","assets/viewUtils-9f810d02.js","assets/SnappingVisualizer3D-493bdb16.js","assets/ExtendedLineVisualElement-451ab04d.js","assets/vec4f32-0d1b2306.js","assets/frustum-f9d53cdf.js","assets/EngineVisualElement-43f3e8cb.js","assets/RenderGeometry-5dbc1699.js","assets/vec3f32-bac7ea57.js","assets/DefaultTechniqueConfiguration-b4dbe32f.js","assets/requestImageUtils-b142708c.js","assets/enums-bdecffa2.js","assets/Texture-bcb6d63f.js","assets/contextUtils-81fda295.js","assets/interfaces-8918b36f.js","assets/Material-5f4156ac.js","assets/ViewingMode-5d7d590b.js","assets/FramebufferObject-123b7c8d.js","assets/ShaderTechniqueConfiguration-2502462e.js","assets/ElevationProvider-abb53936.js","assets/hydratedFeatures-2365c307.js","assets/weather-2eb64924.js","assets/RenderState-1d6218ee.js","assets/NestedMap-1b5db22e.js","assets/VertexElementDescriptor-2925c6af.js","assets/VertexArrayObject-d19dab8d.js","assets/Octree-7cea9440.js","assets/InterleavedLayout-d76b0d59.js","assets/types-1305598a.js","assets/OrderIndependentTransparency-755f7dcc.js","assets/floatRGBA-ca990bbb.js","assets/Intersector-2e1d9db3.js","assets/Intersector-fa865806.js","assets/boundedPlane-1da2f094.js","assets/verticalOffsetUtils-e5214af9.js","assets/orientedBoundingBox-67c5cd22.js","assets/glUtil-ce5ee52b.js","assets/Scheduler-ff5943a4.js","assets/debugFlags-9a30f077.js","assets/VisualElement-187372ae.js","assets/LaserlineVisualElement-c0026af2.js","assets/PointVisualElement-11117df9.js","assets/Object3DVisualElement-459b9b9c.js","assets/ColorMaterial-bdf1f62a.js","assets/VerticalOffset.glsl-5743f98e.js","assets/RightAngleQuadVisualElement-95156bc2.js","assets/SnappingContext-90969376.js","assets/PointSnappingHint-671c9f09.js","assets/interfaces-1a80c8eb.js","assets/OutlineVisualElement-75d7e05b.js","assets/lineStippleUtils-0688e06c.js","assets/VerticesVisualElement-efafb673.js","assets/manipulatorUtils-9334c98f.js","assets/interfaces-0421c5e6.js","assets/ray-8da55042.js","assets/GraphicState-0d3046df.js","assets/editPlaneUtils-f4a70878.js","assets/surfaceCoordinateSystems-1cfad4a3.js","assets/UpdatingHandles-7949a657.js","assets/dehydratedFeatureComparison-7855b188.js","assets/EditGeometryOperations-c2e73f2d.js","assets/geometry2dUtils-a99dcf3d.js","assets/InteractiveToolBase-ddd44c70.js","assets/drawUtils-bd7471ac.js","assets/SketchTooltipOptions-cc43c059.js","assets/SnappingDragPipelineStep-e275580d.js","assets/SnappingOperation-4a4ee09b.js","assets/mat2d-d4af8487.js","assets/mat2df64-4d1a9198.js","assets/helpMessageUtils-1ce96584.js","assets/coordinateSystem-38339d17.js","assets/SnappingManager-aa70fdd4.js","assets/FeatureFilter-55dd341e.js","assets/floorFilterUtils-080a7cd2.js","assets/projectVectorToPoint-fbaf5599.js","assets/automaticAreaMeasurementUtils-7a3ffffd.js","assets/euclideanAreaMeasurementUtils-f9ba1710.js","assets/helpMessageUtils3d-26675e60.js","assets/manipulatorUtils-c4d6f78f.js","assets/dragEventPipeline3D-4663cd2c.js","assets/GraphicManipulator-bf7f8b04.js","assets/defaults-4faa92e6.js","assets/defaultsJSON-59981e75.js","assets/drapedUtils-5cffceb9.js","assets/TranslateTooltipInfos-e784159d.js","assets/IViewEvents-9a85f53d.js","assets/ShiftManipulator-85ff8a40.js","assets/ImageMaterial-10c9471b.js","assets/SlicePlane-40eedf78.js","assets/persistable-a11ce298.js","assets/MD5-715f37cd.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/resourceExtension-63924db9.js","assets/LineVisualElement-e3bb1937.js","assets/RenderCoordsHelper-8f237859.js","assets/projectVectorToDehydratedPoint-e30a7ff8.js","assets/Factory-829a6ea7.js","assets/ExtentTooltipInfos-e0fd687c.js","assets/layerUtils-437666a3.js","assets/hitTestSelectUtils-d512707e.js"]));if(f(n))return n;const h=new n.module.ExtentTransformTool({graphic:e,view:a,enableRotation:i,enableScaling:p,enableZ:s,preserveAspectRatio:l,tooltipOptions:this.tooltipOptions});a.tools.add(h),o||this.updateGraphics.add(e);const c=[],g=new w({activeComponent:h,tool:r,type:"update",onEnd:()=>{var y;c.forEach(b=>b.remove()),c.length=0,(y=a.tools)==null||y.remove(h),h.destroyed||h.destroy()},canUndo:()=>h.canUndo,undo:()=>{h.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:r})},canRedo:()=>h.canRedo,redo:()=>{h.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:r})},addToSelection:async y=>{this.updateGraphics.add(y),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[y],removed:[],type:"selection-change"},type:"update"}),g.onEnd(),g.destroy();const b=await this._setupMove3DOperation(this.updateGraphics.toArray(),t,a,"transform",!0);f(b)||this._setUpdateOperationHandle(b,t)},removeFromSelection:y=>{this.updateGraphics.remove(y),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[y],type:"selection-change"},type:"update"}),g.complete()},toggleTool:async()=>{if(this.updateGraphics.length!==1||t.toggleToolOnClick===!1)return;const y=this.updateGraphics.at(0);if(M(y)!==m.SUPPORTED)return;g.onEnd(),g.destroy();const b=await this._setupReshape3DOperation(y,t,a,!0);f(b)||this._setUpdateOperationHandle(b,t)}});return c.push(...this._getHandlesForComponent(g,t),a.on("immediate-click",y=>this._getCommonUpdateOperationClickHandlers(g,y,t),E.WIDGET),a.on("key-down",y=>this._getCommonUpdateOperationKeyDownHandlers(g,y),E.WIDGET),a.on("key-down",y=>{y.key!==_.constraint||y.repeat||(h.preserveAspectRatio=!h.preserveAspectRatio,y.stopPropagation())},E.WIDGET),a.on("key-up",y=>{y.key===_.constraint&&(h.preserveAspectRatio=!h.preserveAspectRatio,y.stopPropagation())},E.WIDGET)),g}async _setupMove2DOperation(e,t,a){const o="move";this.updateGraphics.addMany(e),await this._updateSpatialReference(e);const r=await this._getGraphicMover(e,t,a);if(f(r))return r;const i=new w({activeComponent:r,tool:o,type:"update",onEnd:()=>{var n;this._displayDefaultCursor(),l.forEach(h=>h.remove()),s.forEach(h=>h.remove()),l=[],s=[],r.destroy(),(n=this._internalGraphicsLayer)==null||n.removeMany([...this.updateGraphics.toArray()])},undo:()=>{const n=this.updateGraphics.toArray();I(i,n),i.refreshComponent(),this._emitUndoEvent({graphics:n,tool:o})},redo:()=>{const n=this.updateGraphics.toArray();D(i,n),i.refreshComponent(),this._emitRedoEvent({graphics:n,tool:o})},addToSelection:async n=>{await this._updateSpatialReference(n),this.updateGraphics.push(n),r.graphics=this.updateGraphics.toArray(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[n],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:n=>{const h=this.updateGraphics.indexOf(n);i.history.undo.forEach(g=>g.updates.splice(h,1)),i.history.redo.forEach(g=>g.updates.splice(h,1)),this.updateGraphics.remove(n);const c=this.updateGraphics.toArray();this.emit("update",{graphics:c,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[n],type:"selection-change"},type:"update"}),this.updateGraphics.length!==0?r.graphics=c:i.complete()}});let p=!1,s=[a.on("immediate-click",n=>this._getCommonUpdateOperationClickHandlers(i,n,t),E.WIDGET),a.on("key-down",n=>{this._getCommonUpdateOperationKeyDownHandlers(i,n),n.key!==_.constraint||n.repeat||(p=!0,r.enableMoveAllGraphics=!r.enableMoveAllGraphics)},E.WIDGET),a.on("key-up",n=>{n.key===_.constraint&&p&&(p=!1,r.enableMoveAllGraphics=!r.enableMoveAllGraphics)},E.WIDGET)],l=this._getHandlesForComponent(i,t);return i}async _setupReshape3DOperation(e,t,a,o=!1){const r="reshape",i=await this._requireModule(O(()=>import("./editingTools-df8b7065.js"),["assets/editingTools-df8b7065.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/elevationInfoUtils-be36d866.js","assets/quantityFormatUtils-e5b1c45f.js","assets/unitFormatUtils-67047561.js","assets/Cyclical-4c223a04.js","assets/getDefaultUnitForView-d1ffbf16.js","assets/TextOverlayItem-7f83875e.js","assets/jsxFactory-92036771.js","assets/uuid-709b6c67.js","assets/automaticLengthMeasurementUtils-412e2f10.js","assets/themeUtils-7dcf5b71.js","assets/memoize-3e55df82.js","assets/snappingUtils-93e84fbe.js","assets/dehydratedPoint-5a1dfed5.js","assets/Query-071039d7.js","assets/FullTextSearch-12e0754c.js","assets/QuantizationParameters-f983cf8d.js","assets/screenUtils-8dc4a7f9.js","assets/signal-51ed66f5.js","assets/euclideanLengthMeasurementUtils-aa8fca96.js","assets/projectVectorToVector-56c29b20.js","assets/measurementUtils-3881da59.js","assets/geometryEngine-656a968c.js","assets/geometryEngineBase-dfbd3a67.js","assets/hydrated-40effdd0.js","assets/projectVectorToWGS84ComparableLonLat-5675a9f4.js","assets/geodesicUtils-822c19ca.js","assets/viewUtils-9f810d02.js","assets/SnappingVisualizer3D-493bdb16.js","assets/ExtendedLineVisualElement-451ab04d.js","assets/vec4f32-0d1b2306.js","assets/frustum-f9d53cdf.js","assets/EngineVisualElement-43f3e8cb.js","assets/RenderGeometry-5dbc1699.js","assets/vec3f32-bac7ea57.js","assets/DefaultTechniqueConfiguration-b4dbe32f.js","assets/requestImageUtils-b142708c.js","assets/enums-bdecffa2.js","assets/Texture-bcb6d63f.js","assets/contextUtils-81fda295.js","assets/interfaces-8918b36f.js","assets/Material-5f4156ac.js","assets/ViewingMode-5d7d590b.js","assets/FramebufferObject-123b7c8d.js","assets/ShaderTechniqueConfiguration-2502462e.js","assets/ElevationProvider-abb53936.js","assets/hydratedFeatures-2365c307.js","assets/weather-2eb64924.js","assets/RenderState-1d6218ee.js","assets/NestedMap-1b5db22e.js","assets/VertexElementDescriptor-2925c6af.js","assets/VertexArrayObject-d19dab8d.js","assets/Octree-7cea9440.js","assets/InterleavedLayout-d76b0d59.js","assets/types-1305598a.js","assets/OrderIndependentTransparency-755f7dcc.js","assets/floatRGBA-ca990bbb.js","assets/Intersector-2e1d9db3.js","assets/Intersector-fa865806.js","assets/boundedPlane-1da2f094.js","assets/verticalOffsetUtils-e5214af9.js","assets/orientedBoundingBox-67c5cd22.js","assets/glUtil-ce5ee52b.js","assets/Scheduler-ff5943a4.js","assets/debugFlags-9a30f077.js","assets/VisualElement-187372ae.js","assets/LaserlineVisualElement-c0026af2.js","assets/PointVisualElement-11117df9.js","assets/Object3DVisualElement-459b9b9c.js","assets/ColorMaterial-bdf1f62a.js","assets/VerticalOffset.glsl-5743f98e.js","assets/RightAngleQuadVisualElement-95156bc2.js","assets/SnappingContext-90969376.js","assets/PointSnappingHint-671c9f09.js","assets/interfaces-1a80c8eb.js","assets/OutlineVisualElement-75d7e05b.js","assets/lineStippleUtils-0688e06c.js","assets/VerticesVisualElement-efafb673.js","assets/manipulatorUtils-9334c98f.js","assets/interfaces-0421c5e6.js","assets/ray-8da55042.js","assets/GraphicState-0d3046df.js","assets/editPlaneUtils-f4a70878.js","assets/surfaceCoordinateSystems-1cfad4a3.js","assets/UpdatingHandles-7949a657.js","assets/dehydratedFeatureComparison-7855b188.js","assets/EditGeometryOperations-c2e73f2d.js","assets/geometry2dUtils-a99dcf3d.js","assets/InteractiveToolBase-ddd44c70.js","assets/drawUtils-bd7471ac.js","assets/SketchTooltipOptions-cc43c059.js","assets/SnappingDragPipelineStep-e275580d.js","assets/SnappingOperation-4a4ee09b.js","assets/mat2d-d4af8487.js","assets/mat2df64-4d1a9198.js","assets/helpMessageUtils-1ce96584.js","assets/coordinateSystem-38339d17.js","assets/SnappingManager-aa70fdd4.js","assets/FeatureFilter-55dd341e.js","assets/floorFilterUtils-080a7cd2.js","assets/projectVectorToPoint-fbaf5599.js","assets/automaticAreaMeasurementUtils-7a3ffffd.js","assets/euclideanAreaMeasurementUtils-f9ba1710.js","assets/helpMessageUtils3d-26675e60.js","assets/manipulatorUtils-c4d6f78f.js","assets/dragEventPipeline3D-4663cd2c.js","assets/GraphicManipulator-bf7f8b04.js","assets/defaults-4faa92e6.js","assets/defaultsJSON-59981e75.js","assets/drapedUtils-5cffceb9.js","assets/TranslateTooltipInfos-e784159d.js","assets/IViewEvents-9a85f53d.js","assets/ShiftManipulator-85ff8a40.js","assets/ImageMaterial-10c9471b.js","assets/SlicePlane-40eedf78.js","assets/persistable-a11ce298.js","assets/MD5-715f37cd.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/resourceExtension-63924db9.js","assets/LineVisualElement-e3bb1937.js","assets/RenderCoordsHelper-8f237859.js","assets/projectVectorToDehydratedPoint-e30a7ff8.js","assets/Factory-829a6ea7.js","assets/ExtentTooltipInfos-e0fd687c.js","assets/layerUtils-437666a3.js","assets/hitTestSelectUtils-d512707e.js"]));if(f(i))return i;const p=t.reshapeOptions,s=new i.module.GraphicReshapeTool({view:a,graphic:e,enableZVertex:t.enableZ&&(p==null?void 0:p.vertexOperation)==="move",enableZShape:t.enableZ&&(p==null?void 0:p.shapeOperation)==="move",enableMoveGraphic:(p==null?void 0:p.shapeOperation)==="move"||(p==null?void 0:p.shapeOperation)==="move-xy",enableMidpoints:(p==null?void 0:p.edgeOperation)==="split",enableEdgeOffset:(p==null?void 0:p.edgeOperation)==="offset",snappingManager:this._snappingManager,labelOptions:this.labelOptions,tooltipOptions:this.tooltipOptions});a.tools.add(s),o||this.updateGraphics.add(e);const l=[],n=new w({activeComponent:s,tool:r,type:"update",onEnd:()=>{var h;l.forEach(c=>c.remove()),l.length=0,(h=a.tools)==null||h.remove(s),s.destroyed||s.destroy()},canUndo:()=>s.canUndo,undo:()=>{s.undo(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:r})},canRedo:()=>s.canRedo,redo:()=>{s.redo(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:r})},addToSelection:async h=>{this.updateGraphics.add(h),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[h],removed:[],type:"selection-change"},type:"update"}),n.onEnd(),n.destroy();const c=await this._setupMove3DOperation(this.updateGraphics.toArray(),t,a,"transform",!0);f(c)||this._setUpdateOperationHandle(c,t)},removeFromSelection:h=>{this.updateGraphics.remove(h),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[h],type:"selection-change"},type:"update"}),n.complete()},toggleTool:async()=>{if(t.toggleToolOnClick===!1)return;n.onEnd(),n.destroy();const h=await this._setupGraphicTransform3DOperation(this.updateGraphics.toArray(),t,a,!0);f(h)||this._setUpdateOperationHandle(h,t)}});return l.push(...this._getHandlesForComponent(n,t),a.on("immediate-click",h=>this._getCommonUpdateOperationClickHandlers(n,h,t),E.WIDGET),a.on("key-down",h=>{this._getCommonUpdateOperationKeyDownHandlers(n,h)},E.WIDGET)),n}async _setupTransformOrReshape2DOperation(e,t,a,o){this.updateGraphics.addMany(e),await this._updateSpatialReference(e);const r=t==="transform"?await this._getBox(e,a,o):await this._getReshape(e,a,o);if(f(r))return r;const i=new w({activeComponent:r,type:"update",onEnd:()=>{s.forEach(l=>l.remove()),p.forEach(l=>l.remove()),s=[],p=[],i.activeComponent&&!i.activeComponent.destroyed&&i.activeComponent.destroy(),this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray())},undo:()=>{I(i,this.updateGraphics.toArray()),i.refreshComponent(),this._emitUndoEvent({graphics:this.updateGraphics.toArray(),tool:i.tool})},redo:()=>{D(i,this.updateGraphics.toArray()),i.refreshComponent(),this._emitRedoEvent({graphics:this.updateGraphics.toArray(),tool:i.tool})},addToSelection:async l=>{let n=i.activeComponent;if((n==null?void 0:n.type)==="reshape"){const h=[...this.updateGraphics,l];this.updateGraphics.removeAll(),i.onEnd(),i.destroy();const c=await this._setupMove2DOperation(h,a,o);if(f(c))return;this._setUpdateOperationHandle(c,a)}else this.updateGraphics.add(l),n.graphics=this.updateGraphics.toArray(),n.refresh(),i.resetHistory();this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[l],removed:[],type:"selection-change"},type:"update"})},removeFromSelection:async l=>{const n=this.updateGraphics.indexOf(l);i.history.undo.forEach(c=>c.updates.splice(n,1)),i.history.redo.forEach(c=>c.updates.splice(n,1)),this.updateGraphics.remove(l);const h=this.updateGraphics.toArray();if(h.length===0)i.complete();else{const c=h[0].geometry;h.length!==1||c==null||c.type!=="point"&&c.type!=="multipoint"?i.activeComponent.graphics=h:i.toggleTool()}this.emit("update",{graphics:h,state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:[],removed:[l],type:"selection-change"},type:"update"})},toggleTool:async()=>{var c;if(this.updateGraphics.length>1)return;const l=this.updateGraphics.at(0),n=l.geometry;if(n!=null&&(i.tool==="reshape"&&(n.type==="point"||n.type==="multipoint")||i.tool==="transform"&&n.type==="extent"))return;let h=null;i.tool==="transform"?h=await this._getReshape([l],a,o):i.tool==="reshape"&&(h=await this._getBox([l],a,o)),f(h)||((c=i.activeComponent)==null||c.destroy(),i.activeComponent=h,i.activeComponent&&(s.forEach(g=>g.remove()),s=this._getHandlesForComponent(i,a)))}});let p=[o.on("immediate-click",l=>this._getCommonUpdateOperationClickHandlers(i,l,a),E.WIDGET),o.on("key-down",l=>{if(this._getCommonUpdateOperationKeyDownHandlers(i,l),l.key===_.constraint&&!l.repeat&&i){const n=i.activeComponent;n&&n.type==="box"&&(n.preserveAspectRatio=!n.preserveAspectRatio)}},E.WIDGET),o.on("key-up",l=>{if(l.key===_.constraint&&i){const n=i.activeComponent;n&&n.type==="box"&&(n.preserveAspectRatio=!n.preserveAspectRatio)}},E.WIDGET)],s=this._getHandlesForComponent(i,a);return i}async _getGraphicMover(e,t,a){const{enableMoveAllGraphics:o,highlightOptions:r}=t,i=await this._requireModule(O(()=>import("./GraphicMover-b901f690.js"),["assets/GraphicMover-b901f690.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/drawUtils-bd7471ac.js","assets/HighlightHelper-5e29e60e.js","assets/layerUtils-437666a3.js","assets/layerViewUtils-6ebe90f4.js","assets/featureUtils-73b624d6.js","assets/utils-1a995f8e.js","assets/basemapUtils-6ec10a55.js","assets/Basemap-8d62c69e.js","assets/loadAll-5e767cfa.js","assets/writeUtils-e226a8aa.js","assets/screenUtils-8dc4a7f9.js","assets/signal-51ed66f5.js","assets/GraphicManipulator-bf7f8b04.js","assets/elevationInfoUtils-be36d866.js","assets/defaults-4faa92e6.js","assets/defaultsJSON-59981e75.js","assets/drapedUtils-5cffceb9.js"]));return f(i)?i:new i.module.default({enableMoveAllGraphics:o,highlightsEnabled:!!(r!=null&&r.enabled),indicatorsEnabled:!1,graphics:e,view:a,callbacks:{onGraphicMoveStart:({dx:p,dy:s,graphic:l})=>{this._displayGrabbingCursor(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:p,dy:s,mover:l,type:"move-start"},type:"update"})},onGraphicMove:({dx:p,dy:s,graphic:l})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:p,dy:s,mover:l,type:"move"},type:"update"}),onGraphicMoveStop:({dx:p,dy:s,graphic:l})=>{this._displayPointerCursor(),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:p,dy:s,mover:l,type:"move-stop"},type:"update"})},onGraphicPointerOver:()=>this._displayPointerCursor(),onGraphicPointerOut:()=>this._displayDefaultCursor()}})}async _getBox(e,t,a){const{enableRotation:o,enableScaling:r,highlightOptions:i,preserveAspectRatio:p}=t,s=await this._requireModule(O(()=>import("./Box-6c461a9f.js"),["assets/Box-6c461a9f.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/unitFormatUtils-67047561.js","assets/Cyclical-4c223a04.js","assets/drawUtils-bd7471ac.js","assets/GraphicMover-b901f690.js","assets/HighlightHelper-5e29e60e.js","assets/layerUtils-437666a3.js","assets/layerViewUtils-6ebe90f4.js","assets/featureUtils-73b624d6.js","assets/utils-1a995f8e.js","assets/basemapUtils-6ec10a55.js","assets/Basemap-8d62c69e.js","assets/loadAll-5e767cfa.js","assets/writeUtils-e226a8aa.js","assets/screenUtils-8dc4a7f9.js","assets/signal-51ed66f5.js","assets/GraphicManipulator-bf7f8b04.js","assets/elevationInfoUtils-be36d866.js","assets/defaults-4faa92e6.js","assets/defaultsJSON-59981e75.js","assets/drapedUtils-5cffceb9.js","assets/settings-24fe1554.js","assets/SketchTooltipOptions-cc43c059.js","assets/ExtentTooltipInfos-e0fd687c.js","assets/automaticLengthMeasurementUtils-412e2f10.js","assets/themeUtils-7dcf5b71.js","assets/jsxFactory-92036771.js","assets/uuid-709b6c67.js","assets/memoize-3e55df82.js","assets/quantityFormatUtils-e5b1c45f.js","assets/getDefaultUnitForView-d1ffbf16.js","assets/snappingUtils-93e84fbe.js","assets/dehydratedPoint-5a1dfed5.js","assets/Query-071039d7.js","assets/FullTextSearch-12e0754c.js","assets/QuantizationParameters-f983cf8d.js","assets/euclideanLengthMeasurementUtils-aa8fca96.js","assets/projectVectorToVector-56c29b20.js","assets/measurementUtils-3881da59.js","assets/geometryEngine-656a968c.js","assets/geometryEngineBase-dfbd3a67.js","assets/hydrated-40effdd0.js","assets/projectVectorToWGS84ComparableLonLat-5675a9f4.js","assets/geodesicUtils-822c19ca.js","assets/TranslateTooltipInfos-e784159d.js"]));return f(s)?s:new s.module.default({graphics:e,enableRotation:o,enableScaling:r,highlightsEnabled:!!(i!=null&&i.enabled),preserveAspectRatio:p,layer:this._internalGraphicsLayer,view:a,tooltipOptions:this.tooltipOptions,callbacks:{onMoveStart:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onMove:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onMoveStop:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onScaleStart:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onScale:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onScaleStop:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onRotateStart:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onRotate:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"}),onRotateStop:l=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...l},type:"update"})}})}async _getReshape(e,t,a){var s,l,n;const o=((s=t.reshapeOptions)==null?void 0:s.edgeOperation)==="split",r=((l=t.reshapeOptions)==null?void 0:l.shapeOperation)==="move",i=!!((n=t.highlightOptions)!=null&&n.enabled),p=await this._requireModule(O(()=>import("./Reshape-03b5fe83.js"),["assets/Reshape-03b5fe83.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/unitFormatUtils-67047561.js","assets/Cyclical-4c223a04.js","assets/ViewingMode-5d7d590b.js","assets/SnappingVisualizer2D-4547907b.js","assets/enums-f1a6a48a.js","assets/snappingUtils-93e84fbe.js","assets/dehydratedPoint-5a1dfed5.js","assets/Query-071039d7.js","assets/FullTextSearch-12e0754c.js","assets/QuantizationParameters-f983cf8d.js","assets/screenUtils-8dc4a7f9.js","assets/signal-51ed66f5.js","assets/elevationInfoUtils-be36d866.js","assets/SnappingContext-90969376.js","assets/PointSnappingHint-671c9f09.js","assets/drawUtils-bd7471ac.js","assets/GraphicMover-b901f690.js","assets/HighlightHelper-5e29e60e.js","assets/layerUtils-437666a3.js","assets/layerViewUtils-6ebe90f4.js","assets/featureUtils-73b624d6.js","assets/utils-1a995f8e.js","assets/basemapUtils-6ec10a55.js","assets/Basemap-8d62c69e.js","assets/loadAll-5e767cfa.js","assets/writeUtils-e226a8aa.js","assets/GraphicManipulator-bf7f8b04.js","assets/defaults-4faa92e6.js","assets/defaultsJSON-59981e75.js","assets/drapedUtils-5cffceb9.js","assets/settings-24fe1554.js","assets/EditGeometryOperations-c2e73f2d.js","assets/geometry2dUtils-a99dcf3d.js","assets/SketchTooltipOptions-cc43c059.js","assets/automaticLengthMeasurementUtils-412e2f10.js","assets/themeUtils-7dcf5b71.js","assets/jsxFactory-92036771.js","assets/uuid-709b6c67.js","assets/memoize-3e55df82.js","assets/quantityFormatUtils-e5b1c45f.js","assets/getDefaultUnitForView-d1ffbf16.js","assets/euclideanLengthMeasurementUtils-aa8fca96.js","assets/projectVectorToVector-56c29b20.js","assets/measurementUtils-3881da59.js","assets/geometryEngine-656a968c.js","assets/geometryEngineBase-dfbd3a67.js","assets/hydrated-40effdd0.js","assets/projectVectorToWGS84ComparableLonLat-5675a9f4.js","assets/geodesicUtils-822c19ca.js","assets/TranslateTooltipInfos-e784159d.js","assets/automaticAreaMeasurementUtils-7a3ffffd.js","assets/euclideanAreaMeasurementUtils-f9ba1710.js"]));return f(p)?p:new p.module.default({enableMidpoints:o,enableMovement:r,graphic:e[0],highlightsEnabled:i,layer:this._internalGraphicsLayer,snappingManager:this._snappingManager,tooltipOptions:this.tooltipOptions,view:a,callbacks:{onReshapeStart:h=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...h},type:"update"}),onReshape:h=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{...h},type:"update"}),onReshapeStop:({mover:h,type:c})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:h,type:c},type:"update"}),onMoveStart:({dx:h,dy:c,mover:g,type:y})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:h,dy:c,mover:g,type:y},type:"update"}),onMove:({dx:h,dy:c,mover:g,type:y})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:h,dy:c,mover:g,type:y},type:"update"}),onMoveStop:({dx:h,dy:c,mover:g,type:y})=>this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:h,dy:c,mover:g,type:y},type:"update"}),onVertexAdd:({added:h,type:c,vertices:g})=>{const y=h.map(b=>q(b.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{added:y,vertices:g,type:c},type:"update"})},onVertexRemove:({removed:h,type:c,vertices:g})=>{const y=h.map(b=>q(b.geometry));this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{removed:y,vertices:g,type:c},type:"update"})}}})}_getHandlesForComponent(e,t){const a=e.activeComponent;if(!a)return[];switch(a.type){case"graphic-mover":return[a.on("graphic-click",({graphic:o,viewEvent:r})=>{var i;(i=r.native)!=null&&i.shiftKey&&(r.stopPropagation(),e.removeFromSelection(o))}),a.on("graphic-move-start",o=>e.addToHistory(T(o.allGraphics)))];case"box":return[a.on("graphic-click",o=>this._onTransformOrReshape2DGraphicClick(e,t,o)),a.on("move-start",o=>e.addToHistory(T(o.graphics))),a.on("rotate-start",o=>e.addToHistory(T(o.graphics))),a.on("scale-start",o=>e.addToHistory(T(o.graphics)))];case"reshape":return[a.on("graphic-click",o=>this._onTransformOrReshape2DGraphicClick(e,t,o)),a.on("move-start",o=>e.addToHistory(T([o.mover]))),a.on("reshape-start",o=>e.addToHistory(T([o.graphic]))),a.on("vertex-add",o=>e.addToHistory(T([o.oldGraphic]))),a.on("vertex-remove",o=>e.addToHistory(T([o.oldGraphic])))];case"move-3d":return[a.on("graphic-move-start",o=>{e.addToHistory(T(o.allGraphics)),this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:o.allGraphics.length>0?o.allGraphics[0]:null,type:"move-start"},type:"update"})}),a.on("graphic-move",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:o.dx,dy:o.dy,mover:o.allGraphics.length>0?o.allGraphics[0]:null,type:"move"},type:"update"})}),a.on("graphic-move-stop",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{dx:0,dy:0,mover:o.allGraphics.length>0?o.allGraphics[0]:null,type:"move-stop"},type:"update"})}),a.on("immediate-click",o=>{o.shiftKey?this._toggleSelection([o.graphic],e,t):e.toggleTool()})];case"transform-3d":return[a.on("record-undo",({record:o})=>{e.addToHistory({updates:[o]})}),a.on("graphic-translate-start",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:o.graphic,dx:o.dxScreen,dy:o.dyScreen,type:"move-start"},type:"update"})}),a.on("graphic-translate-stop",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:o.graphic,dx:o.dxScreen,dy:o.dyScreen,type:"move-stop"},type:"update"})}),a.on("graphic-rotate-start",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:o.graphic,angle:o.angle,type:"rotate-start"},type:"update"})}),a.on("graphic-rotate-stop",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:o.graphic,angle:o.angle,type:"rotate-stop"},type:"update"})}),a.on("graphic-scale-start",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:o.graphic,xScale:o.xScale,yScale:o.yScale,type:"scale-start"},type:"update"})}),a.on("graphic-scale-stop",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:o.graphic,xScale:o.xScale,yScale:o.yScale,type:"scale-stop"},type:"update"})}),a.on("graphic-translate",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:o.graphic,dx:o.dxScreen,dy:o.dyScreen,type:"move"},type:"update"})}),a.on("graphic-rotate",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:o.graphic,angle:o.angle,type:"rotate"},type:"update"})}),a.on("graphic-scale",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:{mover:o.graphic,xScale:o.xScale,yScale:o.yScale,type:"scale"},type:"update"})}),a.on("immediate-click",o=>{o.shiftKey?this._toggleSelection([o.graphic],e,t):e.toggleTool()})];case"reshape-3d":return[a.on("reshape",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:o,type:"update"})}),a.on("move",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:o,type:"update"})}),a.on("vertex-add",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:o,type:"update"})}),a.on("vertex-remove",o=>{this.emit("update",{graphics:this.updateGraphics.toArray(),state:"active",aborted:!1,tool:this.activeTool,toolEventInfo:o,type:"update"})}),a.on("immediate-click",o=>{o.shiftKey?this._toggleSelection([o.graphic],e,t):e.toggleTool()})]}}_onTransformOrReshape2DGraphicClick(e,t,a){var i;const{graphic:o,viewEvent:r}=a;return(i=r.native)!=null&&i.shiftKey&&o.layer===this.layer?(r.stopPropagation(),e.removeFromSelection(o)):t.toggleToolOnClick?(r.stopPropagation(),e.toggleTool()):void 0}_setUpdateOperationHandle(e,t){var r;this._operationHandle=e;const a=(r=this.view)==null?void 0:r.map;this._disablePopup(t);const o=()=>{if(e===this._operationHandle){const i=this.updateGraphics.toArray(),p=this._operationHandle.tool;this._operationHandle.destroy(),this._operationHandle=null,this._internalGraphicsLayer.removeMany(this.updateGraphics.toArray()),this.updateGraphics.removeAll(),a&&a.remove(this._internalGraphicsLayer),this._restorePopup(t),this.emit("update",{graphics:i,state:"complete",aborted:e.cancelled,tool:p,toolEventInfo:null,type:"update"})}};e.on("complete",o)}async _getCommonUpdateOperationClickHandlers(e,t,a){const o=j(t),r=await t.async(()=>this._getFirstHit(o));if(r==null)return void e.complete();if(t.native.shiftKey&&this._toggleSelection([r.graphic],e,a))return void t.stopPropagation();this.updateGraphics.includes(r.graphic)?t.stopPropagation():e.complete()}_toggleSelection(e,t,a){const o=!!a.multipleSelectionEnabled;return e.some(r=>r!=null&&!(!o||r.layer!==this.layer)&&(this.updateGraphics.includes(r)?t.removeFromSelection(r):t.addToSelection(r),!0))}_getCommonUpdateOperationKeyDownHandlers(e,t){if(!e)return;const a=t.key;a===_.undo&&e.canUndo()?(t.stopPropagation(),e.undo()):a===_.redo&&e.canRedo()?(t.stopPropagation(),e.redo()):a===_.cancel?(t.stopPropagation(),e.cancel()):this.allowDeleteKey&&_.delete.includes(a)&&this._onDeleteKey(t)}_onDeleteKey(e){var o;if(!this._operationHandle||this._operationHandle.type!=="update")return;const t=this.activeComponent,a=this.updateGraphics.toArray();t!=null&&t.type!=="reshape-3d"&&(t.type!=="reshape"||a.length===1&&((o=a[0].geometry)==null?void 0:o.type)==="point")&&(e.stopPropagation(),this.delete())}_removeDefaultLayer(){var e,t;this._internalGraphicsLayer&&((t=(e=this.view)==null?void 0:e.map)==null||t.remove(this._internalGraphicsLayer),this._internalGraphicsLayer=x(this._internalGraphicsLayer))}_isComponentGraphic(e){var a;const{activeComponent:t}=this;return!(!e||t==null)&&(((a=e.attributes)==null?void 0:a.esriSketchTool)||t.type==="draw-2d"&&t.graphic===e||(t.type==="box"||t.type==="reshape")&&t.isUIGraphic(e))}_displayPointerCursor(){var e;(e=this.view)!=null&&e.container&&this.view.cursor!=="pointer"&&(this.view.cursor="pointer")}_displayGrabbingCursor(){var e;(e=this.view)!=null&&e.container&&this.view.cursor!=="grabbing"&&(this.view.cursor="grabbing")}_displayDefaultCursor(){var e;(e=this.view)!=null&&e.container&&this.view.cursor!==null&&(this.view.cursor=null)}_logError(e,t,a){Se.getLogger(this).error(new Re(e,t,a))}async _requireModule(e){const t=new AbortController;this._moduleLoaderAbortController=t;const a=await e;return this._moduleLoaderAbortController!==t||t.signal.aborted?{requireError:"aborted"}:{module:a}}_emitUndoEvent(e){this.emit("undo",{...e,type:"undo"})}_emitRedoEvent(e){this.emit("redo",{...e,type:"redo"})}_emitDeleteEvent(e){this.emit("delete",{...e,type:"delete"})}get test(){return{operationHandle:this._operationHandle,snappingManager:this._snappingManager,defaultUpdateOptions:R}}wait(){return z(()=>!this.updating)}_beginAsyncOperation(){this._numUpdating+=1,this.notifyChange("updating")}_endAsyncOperation(){this._numUpdating-=1,this.notifyChange("updating")}_disablePopupEnabled(e){var t;return((t=this.view)==null?void 0:t.type)!=="3d"||this.updateOnGraphicClick||((e==null?void 0:e.toggleToolOnClick)??!1)}_disablePopup(e){this._disablePopupEnabled(e)&&this.view&&this._originalPopupEnabled==null&&(this._originalPopupEnabled=this.view.popupEnabled,this.view.popupEnabled=!1)}_restorePopup(e){this._disablePopupEnabled(e)&&this.view&&this._originalPopupEnabled!=null&&(this.view.popupEnabled=this._originalPopupEnabled,this._originalPopupEnabled=null)}async _waitViewReady(){const e=this.view;e?(L(this._viewReadyAbortController),this._viewReadyAbortController=new AbortController,await Ae(z(()=>e==null?void 0:e.ready),this._viewReadyAbortController.signal)):this._logMissingView()}_logMissingView(){this._logError("sketch:missing-property",Q("view"))}_logMissingLayer(){this._logError(ke,Q("layer"))}};d([u()],v.prototype,"updating",null),d([u()],v.prototype,"_operationHandle",void 0),d([u({readOnly:!0})],v.prototype,"activeTool",null),d([u()],v.prototype,"activeFillSymbol",void 0),d([u()],v.prototype,"activeLineSymbol",void 0),d([u()],v.prototype,"activeVertexSymbol",void 0),d([u()],v.prototype,"allowDeleteKey",void 0),d([u({readOnly:!0})],v.prototype,"createGraphic",null),d([u()],v.prototype,"defaultCreateOptions",null),d([u()],v.prototype,"defaultUpdateOptions",null),d([u({type:te,nonNullable:!0})],v.prototype,"labelOptions",void 0),d([u()],v.prototype,"layer",void 0),d([u({types:C})],v.prototype,"pointSymbol",void 0),d([u({types:C})],v.prototype,"polygonSymbol",void 0),d([u({types:C})],v.prototype,"polylineSymbol",void 0),d([u()],v.prototype,"meshSymbol",void 0),d([u({type:ae,nonNullable:!0})],v.prototype,"snappingOptions",null),d([u()],v.prototype,"_snappingManager",void 0),d([u({readOnly:!0})],v.prototype,"state",null),d([u({type:oe,nonNullable:!0})],v.prototype,"tooltipOptions",void 0),d([u({readOnly:!0})],v.prototype,"updateGraphics",void 0),d([u()],v.prototype,"updateOnGraphicClick",void 0),d([u({types:C})],v.prototype,"vertexSymbol",void 0),d([u({value:null})],v.prototype,"view",null),v=d([A("esri.widgets.Sketch.SketchViewModel")],v);const ke="sketch:missing-property",Q=e=>`Property '${e}' is missing on SketchViewModel.`;function xe(e){return e==="polygon"||e==="rectangle"||e==="circle"}function I(e,t){re("undo",e.history.undo,e.history.redo,t)}function D(e,t){re("redo",e.history.redo,e.history.undo,t)}function re(e,t,a,o){const r=t.pop();if(!r)return;const i=r.updates,p=[];o.forEach((s,l)=>{const n=i[l];n!=null&&("geometry"in n&&n.geometry!=null&&(p.push({geometry:s.geometry}),s.geometry=n.geometry),"symbol"in n&&n.symbol!=null&&(p.push({symbol:s.symbol}),s.symbol=n.symbol),"undo"in n&&(p.push(n),n[e](s)))}),a.push({updates:p})}function T(e){return{updates:e.map(t=>({geometry:t.geometry}))}}function f(e){return"requireError"in e&&e.requireError==="aborted"}const ze=v;export{m as P,ze as a,Ue as g,qe as l,M as n,De as o};
