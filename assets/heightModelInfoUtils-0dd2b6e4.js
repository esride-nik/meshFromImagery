import{s as a,p as w}from"./index-b516d057.js";import{v as h}from"./HeightModelInfo-b816d32b.js";function I(e,o){if(!e)return null;if(!u(e))return new a("webscene:unsupported-height-model-info","The vertical coordinate system of the scene is not supported",{heightModelInfo:e});const c=e.heightUnit,t=h.deriveUnitFromSR(e,o).heightUnit;return c!==t?new a("webscene:incompatible-height-unit",`The vertical units of the scene (${c}) must match the horizontal units of the scene (${t})`,{verticalUnit:c,horizontalUnit:t}):null}function R(e,o,c){const t=M(e),n=o,d=y(t,n,c);if(t){const r=h.deriveUnitFromSR(t,e.spatialReference).heightUnit;if(!c&&r!==t.heightUnit){const s=new a("layerview:unmatched-height-unit",`The vertical units of the layer must match the horizontal units (${r})`,{horizontalUnit:r});return new a("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:t,error:s})}}if(!v(e)||d===i.Unsupported)return new a("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:t});switch(d){case i.Units:{const r=(t==null?void 0:t.heightUnit)||"unknown",s=(n==null?void 0:n.heightUnit)||"unknown",l=new a("layerview:incompatible-height-unit",`The vertical units of the layer (${r}) must match the vertical units of the scene (${s})`,{layerUnit:r,sceneUnit:s});return new a("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:t,sceneHeightModelInfo:n,error:l})}case i.HeightModel:{const r=(t==null?void 0:t.heightModel)||"unknown",s=(n==null?void 0:n.heightModel)||"unknown",l=new a("layerview:incompatible-height-model",`The height model of the layer (${r}) must match the height model of the scene (${s})`,{layerHeightModel:r,sceneHeightModel:s});return new a("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:t,sceneHeightModelInfo:n,error:l})}case i.CRS:{const r=(t==null?void 0:t.vertCRS)||"unknown",s=(n==null?void 0:n.vertCRS)||"unknown",l=new a("layerview:incompatible-vertical-datum",`The vertical datum of the layer (${r}) must match the vertical datum of the scene (${s})`,{layerDatum:r,sceneDatum:s});return new a("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:t,sceneHeightModelInfo:n,error:l})}}return null}function y(e,o,c){if(!u(e)||!u(o))return i.Unsupported;if(e==null||o==null)return i.Ok;if(!c&&e.heightUnit!==o.heightUnit)return i.Units;if(e.heightModel!==o.heightModel)return i.HeightModel;switch(e.heightModel){case"gravity-related-height":return i.Ok;case"ellipsoidal":return e.vertCRS===o.vertCRS?i.Ok:i.CRS;default:return i.Unsupported}}var i;function u(e){return e==null||e.heightModel!=null&&e.heightUnit!=null}function v(e){return"heightModelInfo"in e&&e.heightModelInfo!=null||e.spatialReference!=null||!p(e)}function M(e){var t;const o=e.url?w(e.url):void 0;return!(((t=e.spatialReference)==null?void 0:t.vcsWkid)==null&&o!=null&&o.serverType==="ImageServer")&&g(e)&&e.heightModelInfo?e.heightModelInfo:p(e)?h.deriveUnitFromSR(b,e.spatialReference):null}function g(e){return"heightModelInfo"in e}function f(e){if(e.type==="unknown"||!("capabilities"in e))return!1;switch(e.type){case"csv":case"feature":case"geojson":case"subtype-group":case"ogc-feature":case"oriented-imagery":case"wfs":case"knowledge-graph-sublayer":return!0;default:return!1}}function p(e){return f(e)?!!(e.capabilities&&e.capabilities.data&&e.capabilities.data.supportsZ):m(e)}function H(e){return e.layers!=null||m(e)||f(e)||g(e)}function m(e){switch(e.type){case"building-scene":case"elevation":case"integrated-mesh":case"point-cloud":case"scene":case"voxel":return!0;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"csv":case"dimension":case"geojson":case"feature":case"subtype-group":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"knowledge-graph":case"link-chart":case"knowledge-graph-sublayer":case"line-of-sight":case"map-image":case"map-notes":case"media":case"ogc-feature":case"open-street-map":case"oriented-imagery":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"video":case"wcs":case"web-tile":case"wfs":case"wms":case"wmts":case null:return!1}return!1}(function(e){e[e.Ok=0]="Ok",e[e.Units=1]="Units",e[e.HeightModel=2]="HeightModel",e[e.CRS=3]="CRS",e[e.Unsupported=4]="Unsupported"})(i||(i={}));const b=new h({heightModel:"gravity-related-height"});export{H as g,I as i,M as l,R as r};
