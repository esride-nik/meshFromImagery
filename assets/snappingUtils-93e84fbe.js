import{a5 as r,a6 as o,a9 as L,dA as m,ae as T,fn as h,f9 as R,f1 as O,db as y,d4 as N,cb as $,dr as F,eD as V,oz as C,n8 as k}from"./index-b516d057.js";import{e as b}from"./dehydratedPoint-5a1dfed5.js";import{b as P}from"./Query-071039d7.js";import{_ as q}from"./screenUtils-8dc4a7f9.js";import{c as z,y as I}from"./elevationInfoUtils-be36d866.js";let u=class extends T{constructor(){super(...arguments),this.enabled=!0}};r([o({type:Boolean})],u.prototype,"enabled",void 0),u=r([L("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],u);let i=class extends T{constructor(t){super(t),this.lineSnapper=new u,this.parallelLineSnapper=new u,this.rightAngleSnapper=new u,this.rightAngleTriangleSnapper=new u,this.shortLineThreshold=15,this.distance=5,this.pointThreshold=1e-6,this.intersectionParallelLineThreshold=1e-6,this.parallelLineThreshold=1e-6,this.verticalLineThreshold=.1,this.touchSensitivityMultiplier=1.5,this.pointOnLineThreshold=1e-6,this.orange=new m([255,127,0]),this.orangeTransparent=new m([255,127,0,.5]),this.lineHintWidthReference=3,this.lineHintWidthTarget=3,this.lineHintFadedExtensions=.3,this.parallelLineHintWidth=2,this.parallelLineHintLength=24,this.parallelLineHintOffset=1.5,this.rightAngleHintSize=24,this.rightAngleHintOutlineSize=1.5,this.satisfiesConstraintScreenThreshold=1}};r([o({type:u,constructOnly:!0,nonNullable:!0,json:{write:!0}})],i.prototype,"lineSnapper",void 0),r([o({type:u,constructOnly:!0,nonNullable:!0,json:{write:!0}})],i.prototype,"parallelLineSnapper",void 0),r([o({type:u,constructOnly:!0,nonNullable:!0,json:{write:!0}})],i.prototype,"rightAngleSnapper",void 0),r([o({type:u,constructOnly:!0,nonNullable:!0,json:{write:!0}})],i.prototype,"rightAngleTriangleSnapper",void 0),r([o({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],i.prototype,"shortLineThreshold",void 0),r([o({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],i.prototype,"distance",void 0),r([o({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],i.prototype,"pointThreshold",void 0),r([o({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],i.prototype,"intersectionParallelLineThreshold",void 0),r([o({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],i.prototype,"parallelLineThreshold",void 0),r([o({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],i.prototype,"verticalLineThreshold",void 0),r([o({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],i.prototype,"touchSensitivityMultiplier",void 0),r([o({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],i.prototype,"pointOnLineThreshold",void 0),r([o({type:m,nonNullable:!0})],i.prototype,"orange",void 0),r([o({type:m,nonNullable:!0})],i.prototype,"orangeTransparent",void 0),r([o({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],i.prototype,"lineHintWidthReference",void 0),r([o({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],i.prototype,"lineHintWidthTarget",void 0),r([o({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],i.prototype,"lineHintFadedExtensions",void 0),r([o({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],i.prototype,"parallelLineHintWidth",void 0),r([o({type:Number,nonNullable:!0,range:{min:0,max:50},json:{write:!0}})],i.prototype,"parallelLineHintLength",void 0),r([o({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],i.prototype,"parallelLineHintOffset",void 0),r([o({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],i.prototype,"rightAngleHintSize",void 0),r([o({type:Number,nonNullable:!0,range:{min:0,max:6},json:{write:!0}})],i.prototype,"rightAngleHintOutlineSize",void 0),r([o({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],i.prototype,"satisfiesConstraintScreenThreshold",void 0),i=r([L("esri.views.interactive.snapping.Settings.Defaults")],i);const Z=new i;var g;(function(e){e[e.FEATURE=1]="FEATURE",e[e.SELF=2]="SELF",e[e.ALL=3]="ALL"})(g||(g={}));let f=class{constructor(t,n){this.isDraped=t,this.domain=n}};class S extends f{constructor(t,n,s=g.ALL){super(n,s),this.intersectionPoint=t}equals(t){return t instanceof S&&h(this.intersectionPoint,t.intersectionPoint)}}let ee=class j extends f{constructor(t,n,s,p,a=g.ALL,d=!0,l=!0){super(p,a),this.type=t,this.lineStart=n,this.lineEnd=s,this.fadeLeft=d,this.fadeRight=l}equals(t){return t instanceof j&&this.type===t.type&&h(this.lineStart,t.lineStart)&&h(this.lineEnd,t.lineEnd)&&this.fadeLeft===t.fadeLeft&&this.fadeRight===t.fadeRight}get length(){return R(this.lineStart,this.lineEnd)}},te=class A extends f{constructor(t,n,s,p=g.ALL){super(s,p),this.lineStart=t,this.lineEnd=n}equals(t){return t instanceof A&&h(this.lineStart,t.lineStart)&&h(this.lineEnd,t.lineEnd)}},ne=class H extends f{constructor(t,n,s,p,a=g.ALL){super(p,a),this.previousVertex=t,this.centerVertex=n,this.nextVertex=s}equals(t){return t instanceof H&&h(this.previousVertex,t.previousVertex)&&h(this.centerVertex,t.centerVertex)&&h(this.nextVertex,t.nextVertex)}};const ie={redo:"r",undo:"z",center:"Alt",constraint:"Shift",cancel:"Escape",delete:["Backspace","Delete"],complete:"Enter",vertexAdd:"f",pan:" "},v={toggle:"Control"},re={enterInputMode:"Tab",commit:"Enter",discard:"Escape",next:"Tab"};function oe(e,t,n){return y(e,t,n)}function se(e){return e}function le(e,t,n){return y(e,t,n)}function ae(e){return O(e)}function w(e,t,{coordinateHelper:n,elevationInfo:s}){return e?M(n.vectorToDehydratedPoint(e,W),t,s):null}function M(e,t,n){if(e==null)return null;if(t==null)return y(e.x,e.y,e.z??0);if(t.type==="2d")return y(e.x,e.y,0);const s=z(t,e,n,I)??0;return y(e.x,e.y,s)}function pe(e,t){return b(e[0],e[1],e[2],t)}const W=b(0,0,0,null);function D(e,t){const n=e.x-t.x,s=e.y-t.y;return n*n+s*s}function ue(e,t){return Math.sqrt(D(e,t))}function he(e,t){t.sort((n,s)=>N(n.targetPoint,e)-N(s.targetPoint,e))}var E;function de({point:e,distance:t,returnEdge:n,vertexMode:s,coordinateHelper:{spatialReference:p},filter:a},d,l){return l=l!=null?l.clone():new P({where:"1=1"}),a&&(l.geometry=a.geometry,l.distance=a.distance,l.spatialRelationship=a.spatialRelationship,l.where=V(l.where,a.where),l.timeExtent=C(l.timeExtent,a.timeExtent),l.objectIds=B(l.objectIds,a.objectIds)),{point:b(e[0],e[1],e[2],p.toJSON()),mode:d,distance:t,returnEdge:n,vertexMode:s,query:l.toJSON()}}function B(e,t){return e||t?t?e?Array.from(k(new Set(e),new Set(t))):t:e:null}function ce(e,t,n){return{left:w(e.leftVertex.pos,t,n),right:w(e.rightVertex.pos,t,n)}}function ge(e){return e.createQuery()}function ye(e,t=()=>{}){const n=$(()=>({view:e.view,snappingOptions:e.snappingOptions}),({view:s,snappingOptions:p})=>{const a="snapping-toggle",d=q.TOOL;if(e.removeHandles(a),s&&p!=null){const l=[s.on("key-down",c=>{c.key!==v.toggle||c.repeat||(p.enabledToggled=!0,t())},d),s.on("key-up",c=>{c.key===v.toggle&&(p.enabledToggled=!1,t())},d),s.on("pointer-move",c=>{const x=c.native.ctrlKey;p.enabledToggled!==x&&(p.enabledToggled=x,t())},d)];e.addHandles(l,a)}},F);e.addHandles(n)}function me(e){var t;return e!=null&&typeof e=="object"&&"declaredClass"in e&&e.declaredClass==="esri.WebMap"&&"utilityNetworks"in e&&!!((t=e==null?void 0:e.utilityNetworks)!=null&&t.length)}(function(e){e[e.TARGET=0]="TARGET",e[e.REFERENCE=1]="REFERENCE",e[e.REFERENCE_EXTENSION=2]="REFERENCE_EXTENSION"})(E||(E={}));export{de as E,me as R,ne as a,pe as b,le as c,g as d,ie as e,E as f,M as g,re as h,se as i,ge as j,w as k,ae as l,he as m,ee as n,S as o,Z as p,ue as q,te as r,f as s,D as t,oe as u,ce as v,ye as w};
