import{lg as $,gO as b,lh as I,gH as d,gP as f,li as A,kE as E,fz as O,lj as w,f6 as y,lk as F,aW as D,ll as g,lm as R,cF as S,ln as T}from"./index-b516d057.js";import{t as v}from"./DefaultTechniqueConfiguration-b4dbe32f.js";import{l as C}from"./ViewingMode-5d7d590b.js";import{B as N,s as L}from"./RenderGeometry-5dbc1699.js";function X(t,n,a=null){const o=[],l=n.mapPositions;U(n,o);const r=o[0][1].data,s=o[0][1].indices.length,e=$(s);return j(n,o,e),P(n,o,e),z(n,o,e),H(n,o,e),_(n,o,e),x(n,o,e),B(n,o,r),new b(t,o,l,I.Line,a)}function U(t,n){const{attributeData:{position:a},removeDuplicateStartEnd:o}=t,l=W(a)&&o,r=a.length/3-(l?1:0),s=new Array(2*(r-1)),e=l?a.slice(0,-3):a;let u=0;for(let c=0;c<r-1;c++)s[u++]=c,s[u++]=c+1;n.push([d.POSITION,new f(e,s,3,l)])}function j(t,n,a){if(t.attributeData.colorFeature!=null)return;const o=t.attributeData.color;n.push([d.COLOR,new f(o??A,a,4)])}function z(t,n,a){t.attributeData.normal&&n.push([d.NORMAL,new f(t.attributeData.normal,a,3)])}function H(t,n,a){t.attributeData.colorFeature!=null&&n.push([d.COLORFEATUREATTRIBUTE,new f([t.attributeData.colorFeature],a,1,!0)])}function P(t,n,a){t.attributeData.sizeFeature==null&&n.push([d.SIZE,new f([t.attributeData.size??1],a,1,!0)])}function _(t,n,a){t.attributeData.sizeFeature!=null&&n.push([d.SIZEFEATUREATTRIBUTE,new f([t.attributeData.sizeFeature],a,1,!0)])}function x(t,n,a){t.attributeData.opacityFeature!=null&&n.push([d.OPACITYFEATUREATTRIBUTE,new f([t.attributeData.opacityFeature],a,1,!0)])}function B(t,n,a){if(t.overlayInfo==null||t.overlayInfo.renderCoordsHelper.viewingMode!==C.Global||!t.overlayInfo.spatialReference.isGeographic)return;const o=E(a.length),l=O(t.overlayInfo.spatialReference);for(let p=0;p<o.length;p+=3)w(a,p,o,p,l);const r=a.length/3,s=v(r+1);let e=Z,u=k,c=0,h=0;y(e,o[h++],o[h++],o[h++]),s[0]=0;for(let p=1;p<r+1;++p)p===r&&(h=0),y(u,o[h++],o[h++],o[h++]),c+=F(e,u),s[p]=c,[e,u]=[u,e];n.push([d.DISTANCETOSTART,new f(s,n[0][1].indices,1,!0)])}function W(t){const n=t.length;return t[0]===t[n-3]&&t[1]===t[n-2]&&t[2]===t[n-1]}const Z=D(),k=D();function tt(t,n){if(t==null||t.length===0)return[];const a=[];return t.forEach(o=>{const l=o.length,r=E(3*l);o.forEach((e,u)=>{r[3*u]=e[0],r[3*u+1]=e[1],r[3*u+2]=e[2]});const s={attributeData:{position:r,normal:n},removeDuplicateStartEnd:!1};a.push(s)}),a}function nt(t,n,a,o){const l=t.type==="polygon"?g.CCW_IS_HOLE:g.NONE,r=t.type==="polygon"?t.rings:t.paths,{position:s,outlines:e}=R(r,!!t.hasZ,l,t.spatialReference),u=E(s.length),c=N(s,t.spatialReference,0,u,0,s,0,s.length/3,n,a,o),h=c!=null;return{lines:h?m(e,s,u):[],projectionSuccess:h,sampledElevation:c}}function ot(t,n){const a=t.type==="polygon"?g.CCW_IS_HOLE:g.NONE,o=t.type==="polygon"?t.rings:t.paths,{position:l,outlines:r}=R(o,!1,a),s=S(l,t.spatialReference,0,l,n,0,l.length/3);for(let e=2;e<l.length;e+=3)l[e]=L;return{lines:s?m(r,l):[],projectionSuccess:s}}function m(t,n,a=null){const o=new Array;for(const{index:l,count:r}of t){if(r<=1)continue;const s=3*l,e=3*r;o.push({position:T(n,3*l,3*r),mapPositions:a!=null?T(a,s,e):void 0})}return o}const i={dash:[4,3],dot:[1,3],"long-dash":[8,3],"short-dash":[4,1],"short-dot":[1,1]},G={dash:i.dash,"dash-dot":[...i.dash,...i.dot],dot:i.dot,"long-dash":i["long-dash"],"long-dash-dot":[...i["long-dash"],...i.dot],"long-dash-dot-dot":[...i["long-dash"],...i.dot,...i.dot],none:null,"short-dash":i["short-dash"],"short-dash-dot":[...i["short-dash"],...i["short-dot"]],"short-dash-dot-dot":[...i["short-dash"],...i["short-dot"],...i["short-dot"]],"short-dot":i["short-dot"],solid:null},M=8;function Y(t,n){return t==null?t:{pattern:t.slice(),pixelRatio:n}}function at(t){return{pattern:[t,t],pixelRatio:2}}function et(t){return t!=null&&t.type==="style"?q(t.style):null}function q(t){return t!=null?Y(G[t],M):null}export{tt as R,X as b,at as h,ot as l,et as n,nt as p};
