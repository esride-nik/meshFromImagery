import{ai as O,B as $,ah as U,eT as b,bj as W,n$ as D,o0 as Z,o1 as J,o2 as Q,o3 as q,fO as x,M as ie,eB as M,o4 as re,s as f,ez as oe,cu as ae,o5 as le,c9 as K,a5 as G,a6 as ue,a9 as ce,bA as he,gk as fe,gj as pe,b9 as me,bn as ge,ib as de,ac as Te,iL as j,y as Se,al as F,X as _e,v as A,ng as Ee,o6 as ke,jO as we,aW as R,d8 as xe,fk as I,fe as P,d2 as ye,d1 as Oe,i3 as $e,V as be,o7 as ve,o8 as We}from"./index-b516d057.js";import{l as z}from"./ViewingMode-5d7d590b.js";import{I as Re}from"./Scheduler-ff5943a4.js";const Le=12;let E=class p{constructor(e){const s=p.checkUnsupported(e);if(s!=null)throw s;const n=e;this.spatialReference=n.spatialReference,this._isWebMercator=this.spatialReference.isWebMercator,this._isGCS=D(this.spatialReference)||Z(this.spatialReference)||J(this.spatialReference),this.origin=[n.origin.x,n.origin.y],this.pixelSize=n.size[0],this.dpi=n.dpi;const i=n.lods.reduce((u,h,m)=>(h.level<u.min&&(u.min=h.level,u.minIndex=m),u.max=Math.max(u.max,h.level),u),{min:1/0,minIndex:0,max:-1/0}),r=n.lods[i.minIndex],a=2**r.level;let o=r.resolution*a,c=r.scale*a;this.levels=new Array(i.max+1);for(let u=0;u<this.levels.length;u++)this.levels[u]={resolution:o,scale:c,tileSize:[o*n.size[0],o*n.size[1]]},o/=2,c/=2}clone(){return new p(this.toTileInfo())}toTileInfo(){return new O({dpi:this.dpi,origin:new $({x:this.origin[0],y:this.origin[1],spatialReference:this.spatialReference}),size:[this.pixelSize,this.pixelSize],spatialReference:this.spatialReference,lods:this.levels.map((e,s)=>new b({level:s,scale:e.scale,resolution:e.resolution}))})}getExtent(e,s,n,i){const r=this.levels[e],a=r.tileSize[0],o=r.tileSize[1];i[0]=this.origin[0]+n*a,i[2]=this.origin[0]+(n+1)*a,i[3]=this.origin[1]-s*o,i[1]=this.origin[1]-(s+1)*o}convertExtentToRadians(e,s){this._isWebMercator?(s[0]=Q(e[0]),s[1]=q(e[1]),s[2]=Q(e[2]),s[3]=q(e[3])):this._isGCS&&(s[0]=x(e[0]),s[1]=x(e[1]),s[2]=x(e[2]),s[3]=x(e[3]))}getExtentGeometry(e,s,n,i=new ie){return this.getExtent(e,s,n,T),i.spatialReference=this.spatialReference,i.xmin=T[0],i.ymin=T[1],i.xmax=T[2],i.ymax=T[3],i.zmin=void 0,i.zmax=void 0,i}ensureMaxLod(e){if(e==null)return!1;let s=!1;for(;this.levels.length<=e;){const n=this.levels[this.levels.length-1],i=n.resolution/2;this.levels.push({resolution:i,scale:n.scale/2,tileSize:[i*this.pixelSize,i*this.pixelSize]}),s=!0}return s}capMaxLod(e){this.levels.length>e+1&&(this.levels.length=e+1)}getMaxLod(){return this.levels.length-1}scaleAtLevel(e){return this.levels[0].scale/2**e}levelAtScale(e){const s=this.levels[0].scale;return e>=s?0:Math.log(s/e)*Math.LOG2E}resolutionAtLevel(e){return this.levels[0].resolution/2**e}compatibleWith(e){if(!(e instanceof p)){if(p.checkUnsupported(e))return!1;e=new p(e)}if(!e.spatialReference.equals(this.spatialReference)||e.pixelSize!==this.pixelSize)return!1;const s=Math.min(this.levels.length,e.levels.length)-1,n=this.levels[s].resolution;let i=.5*n;return!M(e.origin[0],this.origin[0],i)||!M(e.origin[1],this.origin[1],i)?!1:(i=.5*n/2**s/this.pixelSize*Le,M(n,e.levels[s].resolution,i))}rootTilesInExtent(e,s=null,n=1/0){const i=new Array,r=this.levels[0].tileSize;if(e==null||r[0]===0||r[1]===0)return i;p.computeRowColExtent(e,r,this.origin,T);let a=T[1],o=T[3],c=T[0],u=T[2];const h=u-c,m=o-a;if(h*m>n){const g=Math.floor(Math.sqrt(n));m>g&&(a=a+Math.floor(.5*m)-Math.floor(.5*g),o=a+g),h>g&&(c=c+Math.floor(.5*h)-Math.floor(.5*g),u=c+g)}for(let g=a;g<o;g++)for(let k=c;k<u;k++)i.push([0,g,k]);return s!=null&&(s[0]=this.origin[0]+c*r[0],s[1]=this.origin[1]-o*r[1],s[2]=this.origin[0]+u*r[0],s[3]=this.origin[1]-a*r[1]),i}static computeRowColExtent(e,s,n,i){const r=.001*(e[2]-e[0]+(e[3]-e[1]));i[0]=Math.max(0,Math.floor((e[0]+r-n[0])/s[0])),i[2]=Math.max(0,Math.ceil((e[2]-r-n[0])/s[0])),i[1]=Math.max(0,Math.floor((n[1]-e[3]+r)/s[1])),i[3]=Math.max(0,Math.ceil((n[1]-e[1]-r)/s[1]))}static isPowerOfTwo(e){const s=e.lods,n=s[0].resolution*2**s[0].level;return!s.some(i=>!re(i.resolution,n/2**i.level))}static hasGapInLevels(e){const s=e.lods.map(n=>n.level);s.sort((n,i)=>n-i);for(let n=1;n<s.length;n++)if(s[n]!==s[0]+n)return!0;return!1}static tileSizeSupported(e){const s=e.size[1];return s===e.size[0]&&(s&s-1)==0&&s>=128&&s<=512}static hasOriginPerLODs(e){const s=e.origin;return e.lods.some(n=>n.origin!=null&&(n.origin[0]!==s.x||n.origin[1]!==s.y))}static getMissingTileInfoError(){return new f("tilingscheme:tile-info-missing","Tiling scheme must have tiling information")}static checkUnsupported(e){return e==null?C():e.lods.length<1?new f("tilingscheme:generic","Tiling scheme must have at least one level"):p.isPowerOfTwo(e)?p.hasGapInLevels(e)?new f("tilingscheme:gaps","Tiling scheme levels must not have gaps between min and max level"):p.tileSizeSupported(e)?p.hasOriginPerLODs(e)?new f("tilingscheme:multiple-origin","Tiling scheme levels must not have their own origin"):null:new f("tilingscheme:tile-size","Tiles must be square and size must be one of [128, 256, 512]"):new f("tilingscheme:power-of-two","Tiling scheme must be power of two")}static fromExtent(e,s){const n=e[2]-e[0],i=e[3]-e[1],r=oe(s),a=1.2*Math.max(n,i),o=256,c=96,u=.0254,h=new p(new O({size:[o,o],origin:new $({x:e[0]-.5*(a-n),y:e[3]+.5*(a-i)}),lods:[new b({level:0,resolution:a/o,scale:1/(o/c*u/(a*r))})],spatialReference:s}));return h.ensureMaxLod(20),h}static makeWebMercatorAuxiliarySphere(e){const s=new p(p.WebMercatorAuxiliarySphereTileInfo);return s.ensureMaxLod(e),s}static makeGCSWithTileSize(e,s=256,n=16){const i=256/s,r=new p(new O({size:[s,s],origin:new $({x:-180,y:90,spatialReference:e}),spatialReference:e,lods:[new b({level:0,resolution:.703125*i,scale:295497598570834e-6*i})]}));return r.ensureMaxLod(n),r}get test(){return{isWebMercator:this._isWebMercator,isGCS:this._isGCS}}};function C(){return new f("tilingscheme:tile-info-missing","Tiling scheme must have tiling information")}E.WebMercatorAuxiliarySphereTileInfo=new O({size:[256,256],origin:new $({x:-20037508342787e-6,y:20037508342787e-6,spatialReference:U.WebMercator}),spatialReference:U.WebMercator,lods:[new b({level:0,resolution:156543.03392800014,scale:591657527591555e-6})]}),E.WebMercatorAuxiliarySphere=E.makeWebMercatorAuxiliarySphere(19);const T=W(),V=64,ht=512,ft=2.5,pt=ae(le/10),mt=2,Me=W();E.WebMercatorAuxiliarySphere.getExtent(0,0,0,Me);const gt=W([-180,-90,180,90]),dt="Cannot extend surface to encompass all layers because it would result in too many root tiles.",Tt="Surface extent is too large for tile resolution at level 0.",Ae=3;let Ie=Ae;function St(t){return t<4?3:Ie}let Ne=class{constructor(e){this.client=e,this._cancelled=!1,this.size=0,this.duration=0}};class ze{constructor(e){this.typeWorkerQuota=e,this.tasks=new Array,this.numWorkers=0,this.statistics=new De}}class De{constructor(){this.requests=0,this.size=0,this.duration=0,this.speed=0}}class Ce{constructor(e,s,n,i){this._workerFunc=e,this._callbackFunc=s,this._maxTotalNumWorkers=n,this._totalNumWorkers=0,this._clients=i.map(r=>new ze(r))}destroy(){this._clients.length=0}hasQuota(e){const s=this._clients[e];return!!s&&(this._totalNumWorkers<this._maxTotalNumWorkers||s.numWorkers+s.tasks.length<s.typeWorkerQuota)}push(e){const s=this._clients[e.client];s&&(this._totalNumWorkers<this._maxTotalNumWorkers?(s.numWorkers++,this._totalNumWorkers++,this._workerFunc(e,(n,i)=>this._taskCallback(n,i))):s.tasks.push(e))}cancel(e){this._taskFinished(e),e._cancelled=!0}_taskFinished(e){const s=this._clients[e.client];this._totalNumWorkers--,s&&(s.numWorkers--,s.statistics.requests++,s.statistics.size+=e.size||0,s.statistics.duration+=e.duration||0,s.statistics.speed=s.statistics.duration>0?s.statistics.size/s.statistics.duration:0,K(s.numWorkers>=0)),this._next()}_next(){for(const e of this._clients)if(e&&e.numWorkers<e.typeWorkerQuota&&this._processQueue(e))return;for(const e of this._clients)if(e&&this._processQueue(e))return}_processQueue(e){for(;e.tasks.length>0;)if(this._workerFunc(e.tasks.shift(),(s,n)=>this._taskCallback(s,n)))return e.numWorkers++,this._totalNumWorkers++,!0;return!1}_taskCallback(e,s){e._cancelled||(this._callbackFunc(e,s),this._taskFinished(e))}getStatsForType(e){const s=this._clients[e];return s?{quota:s.typeWorkerQuota,workers:s.numWorkers,queueSize:s.tasks.length,requestStats:s.statistics}:null}get test(){const e=this;return{set workerFunc(s){e._workerFunc=s}}}}let N=class extends he{constructor(){super(...arguments),this._tasks=new Map,this._onLoadQueue=new Array,this._doneQueue=new Array,this.updating=!1}setup(e,s,n){this._loadQueue=new Ce((i,r)=>this._startLoading(i,r),(i,r)=>this._doneLoadingCB(i,r),e,s),n&&(this._frameTask=n.registerTask(Re.STREAM_DATA_LOADER,this))}destroy(){this._frameTask=fe(this._frameTask),this._tasks.forEach(e=>pe(e.abortController)),this._loadQueue=me(this._loadQueue),this._onLoadQueue=null,this._doneQueue=null,this._tasks=null}hasDownloadSlots(e){return this._loadQueue.hasQuota(e)}request(e,s,n,i={}){const r=ge();r.__signal=i!=null?i.signal:null;const a=this._createOrUpdateTask(e,s,n,i,r);return de(i,()=>this._cancelRequest(a,r)),r.promise}_createTask(e,s,n,i,r,a){const o=new Qe(e,s,n,i,r);return this._updateTask(o,a),this._tasks.set(r,o),this._tasks.size===1&&this._set("updating",!0),this._loadQueue.push(o),o}_cancelRequest(e,s){var n;Te(e.resolvers,s),s.reject(j()),e.resolvers.length===0&&(e.status===d.DOWNLOADING&&(e.status=d.CANCELLED,this._loadQueue.cancel(e),(n=e.abortController)==null||n.abort(),e.request=null,e.abortController=null),e.status=d.CANCELLED,this._tasks.delete(e.key),this._tasks.size===0&&this._set("updating",!1))}_updateTask(e,s){e.resolvers.push(s)}_createOrUpdateTask(e,s,n,i,r){const a=qe((i==null?void 0:i.uid)||e,s,n),o=this._tasks.get(a);return o?(this._updateTask(o,r),o):this._createTask(e,i,s,n,a,r)}_doneLoadingCB(e,s){this._loadQueue&&(K(e.status===d.DOWNLOADING),e.status=d.DOWNLOADED,this._frameTask?this._doneQueue.push({task:e,err:s}):this._doneLoading(e,s))}get running(){return this._doneQueue.length>0||this._onLoadQueue.length>0}runTask(e){for(;!e.done&&this._onLoadQueue.length>0;){const s=this._onLoadQueue.shift();Se(s.task.abortController),s.task.abortController=null,s.callback(s.task),e.madeProgress()}for(;!e.done&&this._doneQueue.length>0;){const s=this._doneQueue.shift();s.task.status!==d.DOWNLOADED&&(s.err=s.err||j()),this._doneLoading(s.task,s.err),e.madeProgress()}}_doneLoading(e,s){if(s&&!F(s)&&e.numRetries>0)return--e.numRetries,void this._loadQueue.push(e);let n=e.result instanceof HTMLImageElement?0:e.resolvers.length;for(const i of e.resolvers)if(s)F(s)?i.reject(s):i.reject(new f("stream-data-loader:request-error",`Failed to request resource at '${e.url}'. ${s}`,{url:e.url,error:s}));else{--n;const r=n>0?_e(e.result):e.result;i.resolve(r)}this._tasks.delete(e.key),this._tasks.size===0&&this._set("updating",!1)}_startLoading(e,s){if(e.status===d.CANCELLED)return!1;let n,i;switch(e.startTime=performance.now(),e.status=d.DOWNLOADING,e.docType){case"binary":i="array-buffer",n=0;break;case"image":i="image";break;case"image+type":i="array-buffer";break;default:i="json"}e.abortController=new AbortController;const r=e.abortController.signal;e.request=A(e.url,{...e.options,responseType:i,timeout:n,signal:r});let a=()=>{};const o=u=>{e.duration=performance.now()-e.startTime,e.size=u instanceof ArrayBuffer?u.byteLength:e.size||0,e.result=u,this._frameTask?this._onLoadQueue.push({callback:s,task:e}):(e.abortController=null,s(e))},c=u=>{e.status===d.DOWNLOADING&&s(e,u),a()};return e.docType!=="image+type"?(e.request.then(u=>o(u.data),c),!0):(e.request.then(u=>{const h=u.data,m=Ue(h);if(i="image",e.size=h.byteLength,m==="unknown")return e.request=A(e.url,{responseType:i,timeout:n,signal:r}),void e.request.then(L=>o(L.data),c);const g=new Blob([h],{type:m}),k=window.URL.createObjectURL(g);a=()=>window.URL.revokeObjectURL(k),e.request=A(k,{responseType:i,timeout:n,signal:r}),e.request.then(L=>o(new Y(L.data,m,a)),c)},c),!0)}get test(){return{loadQueue:this._loadQueue}}};G([ue({readOnly:!0})],N.prototype,"updating",void 0),N=G([ce("esri.views.3d.support.StreamDataLoader")],N);const He={numRetries:0};function Ue(t){if(t.byteLength<2)return"unknown";const e=new Uint8Array(t,0,t.byteLength);return e[0]===137&&e[1]===80?"image/png":e[0]===71&&e[1]===73?"image/gif":e[0]===66&&e[1]===77?"image/bmp":e[0]===255&&e[1]===216?"image/jpeg":"unknown"}let Y=class{constructor(e,s,n){this.image=e,this.type=s,this.release=n}get isOpaque(){return this.type==="image/jpeg"}};function wt(t){return"image"in t&&"type"in t}let Qe=class extends Ne{constructor(e,s,n,i,r){super(i),this.url=e,this.options=s,this.docType=n,this.key=r,this.result=null,this.status=d.QUEUED,this.request=null,this.abortController=null,this.resolvers=new Array,this.startTime=0,this.numRetries=He.numRetries}};function qe(t,e,s){return`${t}:${e}:${s}`}var d;(function(t){t[t.QUEUED=1]="QUEUED",t[t.DOWNLOADING=2]="DOWNLOADING",t[t.DOWNLOADED=3]="DOWNLOADED",t[t.CANCELLED=4]="CANCELLED"})(d||(d={}));var B,l;(function(t){t[t.INSIDE=0]="INSIDE",t[t.INTERSECTS=1]="INTERSECTS",t[t.OUTSIDE=2]="OUTSIDE"})(B||(B={})),function(t){t[t.NORTH=0]="NORTH",t[t.NORTH_EAST=1]="NORTH_EAST",t[t.EAST=2]="EAST",t[t.SOUTH_EAST=3]="SOUTH_EAST",t[t.SOUTH=4]="SOUTH",t[t.SOUTH_WEST=5]="SOUTH_WEST",t[t.WEST=6]="WEST",t[t.NORTH_WEST=7]="NORTH_WEST"}(l||(l={}));const w=R(),Ge=R(),S=R(),_=R();function je(t,e,s=0){const n=t.extent;if(n==null)return!1;if(s===0)return Ee(n,e);const i=Math.min(n[2]-n[0],n[3]-n[1]);return ke(n,e,s*i)}function y(t,e,s,n){xe(w,s),w[n]=e[n];const i=I(w,w,e),r=I(Ge,t,e),a=P(r,i),o=P(i,i);let c;c=a<=0?e:o<=a?s:ye(w,e,Oe(i,i,a/o));const u=I(w,t,c);return Math.PI/2-Math.atan(u[2]/Math.sqrt(u[0]*u[0]+u[1]*u[1]))}function Fe(t,e,s){const n=t.extent;if(n==null)return 0;S[0]=n[0],S[1]=n[1],S[2]=s,_[0]=n[2],_[1]=n[3],_[2]=s;let i=1/0,r=1/0;return e[0]<S[0]?i=y(e,S,_,0):e[0]>_[0]&&(i=y(e,_,S,0)),e[1]<S[1]?r=y(e,S,_,1):e[1]>_[1]&&(r=y(e,_,S,1)),Math.min(i,r)}function Pe(t,e,s){if(t==null)return C();if(t.spatialReference.isGeographic&&!D(t.spatialReference))return new f("tilingscheme:local-unsupported-spatial-reference","The tiling scheme spatial reference is not supported in local scenes");const n=E.checkUnsupported(t);if(n!=null)return n;if(s==null)return new f("tilingscheme:extent-not-exist","The layer does not provide a layer extent.");const i=Ve(t,s);if(i)return i;const r=t.spatialReference;return e==null||r.equals(e)||e.isWGS84&&r.isWebMercator?null:new f("tilingscheme:spatial-reference-mismatch","The tiling scheme does not match the spatial reference of the local scene")}function Ve(t,e){const s=t.lods,n=s[0].resolution*2**s[0].level,i=[n*t.size[0],n*t.size[1]],r=[t.origin.x,t.origin.y],a=we(e),o=W();E.computeRowColExtent(a,i,r,o);const c=(o[2]-o[0])*(o[3]-o[1]);if(c>V){const u=s[0].scale*2**s[0].level;let h=Math.max((a[3]-a[1])/t.size[1],(a[2]-a[0])/t.size[0])*u/n;const m=Math.floor(Math.log(h)/Math.log(10));return h=Math.ceil(h/10**m)*10**m,new f("tilingscheme:too-many-root-tiles","Scale of level 0 of the tiling scheme (1:"+Math.floor(u).toLocaleString()+") is too large for the layer's extent. Suggested scale: 1:"+h.toLocaleString()+".",{level0Scale:u,suggestedLevel0Scale:h,requiredNumRootTiles:c,allowedNumRootTiles:V})}return null}const Be=Object.freeze(Object.defineProperty({__proto__:null,checkIfTileInfoSupportedForViewSR:Pe,isInsideExtent:je,tiltToExtentEdge:Fe},Symbol.toStringTag,{value:"Module"}));function Xe(){return!0}function Ze(){return 0}function Je(t,e){if(t==null)return C();const s=t.lods.length-1,n=t.spatialReference,i=D(n)||Z(n)||J(n);if(n.isWebMercator){if(!E.makeWebMercatorAuxiliarySphere(s).compatibleWith(t))return new f("tilingscheme:incompatible-global-web-mercator","The tiling scheme is not compatible with the ArcGIS Online Web Mercator tiling scheme")}else{if(!i)return new f("tilingscheme:global-unsupported-spatial-reference","The tiling scheme spatial reference is not supported in global scenes");if(!E.makeGCSWithTileSize(t.spatialReference,t.size[0],s).compatibleWith(t))return t.spatialReference.isWGS84?new f("tilingscheme:incompatible-global-wgs84","The tiling scheme is not compatible with the ArcGIS Online WGS84 tiling scheme"):new f("tilingscheme:incompatible-global","The tiling scheme is not compatible with the ArcGIS Online tiling scheme")}return e==null||t.spatialReference.equals(e)?void 0:new f("tilingscheme:spatial-reference-mismatch","The tiling scheme does not match the spatial reference of the global scene")}const Ke=Object.freeze(Object.defineProperty({__proto__:null,checkIfTileInfoSupportedForViewSR:Je,isInsideExtent:Xe,tiltToExtentEdge:Ze},Symbol.toStringTag,{value:"Module"})),Ye={[z.Global]:Ke,[z.Local]:Be};function yt(t,e){t||console.warn("Terrain: "+e)}let v=!1,et=!1;function Ot(t){et=t,v=v||t}function $t(t){v=t}function bt(t,e){var s;if(v&&!t){const n=(s=new Error().stack)==null?void 0:s.slice(5);throw console.warn("Terrain internal: "+(e??"")+" at "+n),new Error("Assertion failed"+(e?": "+e:""))}}function vt(t){return H(t)?{fullExtent:t.fullExtent,minScale:t.layer.minScale,maxScale:t.layer.maxScale,tilemapCache:null}:t.layer}function X(t){return(t==null?void 0:t.type)==="imagery-tile"||(t==null?void 0:t.type)==="wcs"}function H(t){return(t==null?void 0:t.type)==="imagery-tile-3d"}function ee(t){return(t==null?void 0:t.type)==="tile-3d"}function te(t){return(t==null?void 0:t.type)==="vector-tile-3d"}function se(t){return(t==null?void 0:t.type)==="wmts-3d"}function tt(t){return(t==null?void 0:t.type)==="elevation-3d"}function Wt(t){return(t==null?void 0:t.type)==="group"}function Rt(t){return t&&(ee(t)||se(t)||H(t)||te(t))}function st(t){return t&&(ee(t)||H(t)||te(t)||se(t))}function Lt(t){return st(t)||tt(t)}function Mt(t){var s;const e=(s=t==null?void 0:t.sourceLayerInfo)==null?void 0:s.data;return e!=null&&"type"in e&&e.type==="raster-tile"}function At(t){return nt(t==null?void 0:t.sourceLayerInfo)||!!(t!=null&&t.isVTLBackground)}function It(t){var s;const e=(s=t==null?void 0:t.sourceLayerInfo)==null?void 0:s.data;return e!=null&&"type"in e&&e.type==="tile-texture"}function Nt(t){var s;const e=(s=t==null?void 0:t.sourceLayerInfo)==null?void 0:s.data;return e instanceof HTMLImageElement||e instanceof Y||e instanceof HTMLCanvasElement||e instanceof ImageData}function nt(t){return(t==null?void 0:t.data)!=null&&"type"in t.data&&t.data.type==="vector-tile"}function zt(t){return t!=null&&"release"in t&&t.release(),null}function Dt(t){return t.fetchTile&&t.hasOverriddenFetchTile!==!1}function ne(t,e,s,n){return Ye[n].checkIfTileInfoSupportedForViewSR(t,s,e)}function Ct(t,e,s){let n=null,i=null;if((t==null?void 0:t.type)==="wmts"){const r=it(t,e,s);n=r.tileInfo,i=r.fullExtent}else{i=X(t)?t.getCompatibleFullExtent(e):t.fullExtent;const r=s===z.Local;if(X(t))n=t.getCompatibleTileInfo(e,i,r);else if((t==null?void 0:t.type)==="vector-tile"){const a=r&&!rt(e)||ot.force512VTL,o=t.tileInfo.spatialReference.isGeographic;n=a?t.tileInfo:t.tileInfo.getOrCreateCompatible(256,o?1:2)}else n=t.tileInfo}return n!=null&&i!=null&&ne(n,i,e,s)==null?{tileInfo:n,fullExtent:i}:null}function it(t,e,s){const n=$e(t);if(n!=null){if(!be.isCollection(n))return{tileInfo:n.tileInfo,fullExtent:n.fullExtent};{const i=n.find(r=>ne(r.tileInfo,r.fullExtent,e,s)==null);if(i)return{tileInfo:i.tileInfo,fullExtent:i.fullExtent}}}return{tileInfo:null,fullExtent:null}}function rt(t){return t.isWGS84||t.isWebMercator||ve(t)||!We(t)}const ot={force512VTL:!1};function Ht(t){return"["+t[0]+","+t[1]+","+t[2]+"]"}function Ut(t){return"("+t[0]+","+t[1]+","+t[2]+")"}function Qt(t,e,s=at){return Math.abs(t-e)<s}function qt(t){return t===l.NORTH_EAST?l.SOUTH_WEST:t===l.NORTH_WEST?l.SOUTH_EAST:t===l.SOUTH_WEST?l.NORTH_EAST:l.NORTH_WEST}function Gt(t){return t===l.NORTH?l.SOUTH:t===l.EAST?l.WEST:t===l.SOUTH?l.NORTH:l.EAST}function jt(t){return t===l.NORTH_WEST||t===l.SOUTH_WEST}function Ft(t){return t===l.NORTH_WEST||t===l.NORTH_EAST}function Pt(t){return t===l.NORTH_WEST||t===l.WEST||t===l.SOUTH_WEST}function Vt(t){return t===l.NORTH_EAST||t===l.EAST||t===l.SOUTH_EAST}function Bt(t){return t===l.SOUTH_EAST||t===l.SOUTH||t===l.SOUTH_WEST}function Xt(t){return t===l.NORTH_EAST||t===l.NORTH||t===l.NORTH_WEST}const Zt=[l.NORTH,l.EAST,l.SOUTH,l.WEST],Jt=[l.NORTH_EAST,l.SOUTH_EAST,l.SOUTH_WEST,l.NORTH_WEST],at=1e-5;export{H as $,Y as A,Gt as B,ne as C,N as D,ft as E,Ut as F,Qt as G,X as H,Wt as I,Vt as J,Bt as K,Nt as L,ot as M,Lt as N,wt as O,jt as P,Xt as Q,tt as R,l as S,B as T,Rt as U,Ht as V,st as W,Zt as X,Jt as Y,Dt as Z,te as _,E as a,ee as a0,$t as a1,Ot as a2,Ct as b,vt as c,mt as d,St as e,yt as f,qt as g,v as h,ht as i,At as j,rt as k,pt as l,Me as m,It as n,nt as o,bt as p,Ft as q,V as r,et as s,dt as t,gt as u,it as v,zt as w,Mt as x,Tt as y,Pt as z};
