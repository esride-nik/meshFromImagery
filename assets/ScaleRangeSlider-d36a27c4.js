import{aP as A,j5 as N,a5 as s,a6 as r,a9 as $,bA as P,cb as b,h3 as I,eU as z,iu as V,_ as v,cc as j,b9 as B,fU as F,h1 as J}from"./index-b516d057.js";import{l as U,L as q}from"./Slider-50915901.js";import{e as H,O as W,r as G,n as d,S as K}from"./jsxFactory-92036771.js";import{e as C}from"./globalCss-94006b67.js";import"./uuid-709b6c67.js";const _="esri-scale-range-slider",w=`${_}__scale-menu`,h={base:_,scaleIndicatorWrapper:`${_}__scale-indicator-wrapper`,scaleIndicator:`${_}__scale-indicator`,scaleIndicatorIcon:`${_}__scale-indicator-icon`,scaleIndicatorContainer:`${_}__scale-indicator-container`,scaleMenuContainer:`${w}-container`,scaleMenuSeparator:`${w}-separator`,scaleMenuToggle:`${w}-toggle`,scaleMenuSublabel:`${w}-sublabel`,scalePreview:`${_}__scale-preview`,scalePreviewThumbnail:`${_}__scale-preview-thumbnail`},Q="en-wo",X=A().substr(0,2);var l;(function(e){e.ar="ar",e.bg="bg",e.cs="cs",e.da="da",e.de="de",e.el="el",e.en="en",e.es="es",e.et="et",e.fi="fi",e.fr="fr",e.is="is",e.it="it",e.ja="ja",e.ko="ko",e.lt="lt",e.lv="lv",e.nl="nl",e.nn="nn",e.pl="pl",e.pt="pt",e.ro="ro",e.ru="ru",e.sk="sk",e.sv="sv",e.th="th",e.zh="zh"})(l||(l={}));const Y={ae:l.en,ar:l.es,at:l.de,au:l.en,be:l.nl,bg:l.bg,bo:l.es,br:l.pt,ca:l.en,ch:l.de,ci:l.fr,cl:l.es,cn:l.zh,co:l.es,cr:l.es,cz:l.cs,de:l.de,dk:l.da,ee:l.et,eg:l.en,es:l.es,fi:l.fi,fr:l.fr,gb:l.en,gl:l.da,gr:l.el,gt:l.es,hk:l.en,id:l.en,ie:l.en,il:l.en,in:l.en,iq:l.ar,is:l.is,it:l.it,jp:l.ja,ke:l.en,kr:l.ko,kw:l.ar,li:l.de,lt:l.lt,lu:l.en,lv:l.lv,ma:l.fr,mg:l.fr,ml:l.fr,mo:l.en,mx:l.es,my:l.en,ni:l.es,nl:l.nl,no:l.nn,nz:l.en,pe:l.es,pl:l.pl,pr:l.es,pt:l.pt,ro:l.ro,ru:l.ru,rw:l.en,se:l.sv,sg:l.en,sk:l.sk,sr:l.nl,sv:l.es,th:l.th,tn:l.fr,tw:l.zh,us:l.en,ve:l.es,vi:l.en,wo:l.en,za:l.en},O=new Set(["ar-iq","ar-kw","bg-bg","cs-cz","da-dk","da-gl","de-at","de-ch","de-de","de-li","el-gr","en-ae","en-au","en-ca","en-eg","en-gb","en-hk","en-id","en-ie","en-il","en-in","en-iq","en-ke","en-lu","en-mo","en-my","en-nz","en-rw","en-sg","en-us","en-vi","en-wo","en-za","es-ar","es-bo","es-cl","es-co","es-cr","es-es","es-gt","es-mx","es-ni","es-pe","es-pr","es-sv","es-ve","et-ee","fi-fi","fr-ci","fr-fr","fr-ma","fr-mg","fr-ml","fr-tn","is-is","it-it","ja-jp","ko-kr","lt-lt","lv-lv","nl-be","nl-nl","nl-sr","nn-no","pl-pl","pt-br","pt-pt","ro-ro","ru-ru","sk-sk","sv-se","th-th","zh-cn","zh-tw"]);function Z(e){return e.toLowerCase()}function ee(e){return`url(${N(`esri/widgets/ScaleRangeSlider/images/scalePreview/${e}.jpg`)})`}function ie(e){e=Z(e);const i=`${X}-${e}`,t=`${Y[e]}-${e}`;return ee(O.has(i)?i:O.has(t)?t:Q)}function te(e){if(!(e<0||e>=5*5))return`-${128*(e%5)}px -${128*Math.floor(e/5)}px`}var M;const k=147914382,ae=[{id:"room",minScale:100},{id:"rooms",minScale:400},{id:"smallBuilding",minScale:800},{id:"building",minScale:1999},{id:"buildings",minScale:3999},{id:"street",minScale:7499},{id:"streets",minScale:14999},{id:"neighborhood",minScale:29999},{id:"town",minScale:59999},{id:"city",minScale:119999},{id:"cities",minScale:249999},{id:"metropolitanArea",minScale:499999},{id:"county",minScale:999999},{id:"counties",minScale:1999999},{id:"stateProvince",minScale:3999999},{id:"statesProvinces",minScale:6999999},{id:"countriesSmall",minScale:14999999},{id:"countriesBig",minScale:34999999},{id:"continent",minScale:99999999},{id:"world",minScale:k}];function L(e,i){const t=ae,a=t.length,n=[];let c,u=e;e=e>=0?e:0,i=i>0?i:t[a-1].minScale;for(let S=0;S<a;S++){const g=Math.min(t[S].minScale,i);c=Math.min(g,i),e<=g&&u<i&&n.push({id:t[S].id,maxScale:Math.max(u,e),minScale:c}),u=c+1}return n.reverse(),le(n)}function le(e){if(e.length===0)return e;const[i]=e,t=e[e.length-1];return i.minScale===i.maxScale&&(e.shift(),i.minScale+=1),t.minScale===t.maxScale&&(e.pop(),t.maxScale-=1),e}let p=M=class extends P{constructor(){super(...arguments),this.ranges=[]}static fromScaleRange({maxScale:e,minScale:i}){return new M({ranges:L(e,i)})}static async fromLayer(e){var a;await e.when();const i="tileInfo"in e?(a=e.tileInfo)==null?void 0:a.lods:void 0;let t;return i?t=L(i[i.length-1].scale,i[0].scale):t=L(0,0),new M({ranges:t})}get firstRange(){return this.ranges[0]}get lastRange(){const e=this.ranges;return e[e.length-1]}get length(){return this.ranges.length}get maxScale(){return this.lastRange.maxScale}get minScale(){return this.firstRange.minScale}isMinScaleEdge(e){const{firstRange:i}=this,t=i.minScale,a=M.RecommendedScales[i.id]||i.maxScale;return e<=t&&e>=a}isMaxScaleEdge(e){const{lastRange:i}=this,t=i.maxScale;return e<=(M.RecommendedScales[i.id]||i.minScale)&&e>=t}findScaleRange(e){const i=this.ranges;let t;if(e>=i[0].maxScale)return i[0];if(e<=i[i.length-1].minScale)return i[i.length-1];for(let a=0;a<i.length;a++){const n=i[a];if(e>=n.maxScale&&e<=n.minScale){t=n;break}}return t}findScaleRangeByIndex(e){return this.ranges[this._clampScaleRangeIndex(e)]}scaleToRangeIndex(e){return this.ranges.indexOf(this.findScaleRange(e))}clampScale(e){return Math.min(this.minScale,Math.max(this.maxScale,e))}clampMinScale(e){return e===0?this.minScale:this.clampScale(e)}clampMaxScale(e){return this.clampScale(e)}contains(e){const i=this.ranges;let t=!1;for(let a=0;a<i.length;a++){const{maxScale:n,minScale:c}=i[a];if(e>=n&&e<=c){t=!0;break}}return t}_clampScaleRangeIndex(e){if(e<=0)return 0;const t=this.ranges.length-1;return e>t?t:Math.floor(e)}};p.RecommendedScales=Object.freeze({world:k,continent:5e7,countriesBig:25e6,countriesSmall:12e6,statesProvinces:6e6,stateProvince:3e6,counties:15e5,county:75e4,metropolitanArea:32e4,cities:16e4,city:8e4,town:4e4,neighborhood:2e4,streets:1e4,street:5e3,buildings:2500,building:1250,smallBuilding:800,rooms:400,room:100}),s([r()],p.prototype,"firstRange",null),s([r()],p.prototype,"lastRange",null),s([r()],p.prototype,"length",null),s([r()],p.prototype,"maxScale",null),s([r()],p.prototype,"minScale",null),s([r({constructOnly:!0})],p.prototype,"ranges",void 0),p=M=s([$("esri.widgets.ScaleRangeSlider.ScaleRanges")],p);const y=p;let m=class extends P{constructor(e){super(e),this.layer=null,this.scaleRanges=y.fromScaleRange({minScale:0,maxScale:0}),this.sliderViewModel=(()=>{const{max:i}=this._getSliderIndexRange(this.scaleRanges.length-1);return new U({precision:10,min:0,max:i,values:[0,i]})})()}initialize(){this.addHandles([b(()=>this.layer,e=>e==null?void 0:e.load().catch(()=>{})),b(()=>{var e,i;return{loaded:(e=this.layer)==null?void 0:e.loaded,ready:(i=this.view)==null?void 0:i.ready}},({loaded:e,ready:i})=>{if(!e||!i)return;if(this._hasTiledLayer()){const a=this._getLayerResampling()?void 0:this.mapScaleToSlider(this._getTiledLayerMaxScale()),n=this.mapScaleToSlider(this._getTiledLayerMinScale());this.sliderViewModel.effectiveMax=a,this.sliderViewModel.effectiveMin=n}else{const a=this.layer&&"maxScaleRange"in this.layer?this.layer.maxScaleRange:null,{minScale:n=0,maxScale:c=0}=a??{};this.sliderViewModel.effectiveMax=c===0?void 0:this.mapScaleToSlider(c),this.sliderViewModel.effectiveMin=n===0?void 0:this.mapScaleToSlider(n)}const t=this.layer;t&&"minScale"in t&&"maxScale"in t?(this.minScale=t.minScale,this.maxScale=t.maxScale):(this.minScale=void 0,this.maxScale=void 0)},I)])}get effectiveMaxScale(){return this.maxScale===0?this.maxScaleLimit:this.maxScale}get effectiveMinScale(){return this.minScale===0?this.minScaleLimit:this.minScale}get effectiveMaxScaleLimit(){return this.mapSliderToScale(this.sliderViewModel.effectiveMax??this.sliderViewModel.max)}get effectiveMinScaleLimit(){return this.mapSliderToScale(this.sliderViewModel.effectiveMin??this.sliderViewModel.min)}get maxScale(){const e=this.mapSliderToScale(this.sliderViewModel.values[1]);return this._normalizeScale("max",e)}set maxScale(e){this._setMaxScaleOnSlider(e)}get maxScaleLimit(){return this.mapSliderToScale(this.sliderViewModel.max)}set maxScaleLimit(e){this._setSliderRange({maxScale:e,minScale:this.minScaleLimit})}get minScale(){const e=this.mapSliderToScale(this.sliderViewModel.values[0]);return this._normalizeScale("min",e)}set minScale(e){this._setMinScaleOnSlider(e)}get minScaleLimit(){return this.mapSliderToScale(this.sliderViewModel.min)}set minScaleLimit(e){this._setSliderRange({maxScale:this.maxScaleLimit,minScale:e})}get state(){const{view:e,layer:i}=this;return!e&&!i||!e&&i&&i.loaded||!i&&e&&e.ready||e&&e.ready&&i&&i.loaded?"ready":"disabled"}set view(e){this._set("view",e)}mapScaleToSlider(e){const i=this.scaleRanges.scaleToRangeIndex(e),t=this.scaleRanges.findScaleRangeByIndex(i),{maxScale:a,minScale:n}=t,{max:c,min:u}=this._getSliderIndexRange(i);return this._mapToRange(e,n,a,u,c)}mapSliderToScale(e){const i=this.scaleRanges.findScaleRangeByIndex(e),{maxScale:t,minScale:a}=i,{max:n,min:c}=this._getSliderIndexRange(e);return this._mapToRange(e,c,n,a,t)}_setSliderRange(e){this.scaleRanges=y.fromScaleRange(e);const{max:i}=this._getSliderIndexRange(this.scaleRanges.length-1);this.sliderViewModel.max=i,this.sliderViewModel.min=0,this.notifyChange("maxScaleLimit"),this.notifyChange("minScaleLimit")}_getSliderIndexRange(e){const i=Math.floor(e);return{min:i,max:i+.99999}}_mapToRange(e,i,t,a,n){return a+(e-i)*(n-a)/(t-i)}_setMaxScaleOnSlider(e){const{scaleRanges:i,sliderViewModel:t}=this;if(e!==void 0){const a=this.mapScaleToSlider(this._constrainMaxScaleToLayer(i.clampMaxScale(e)));t.values=[t.values[0],a]}}_setMinScaleOnSlider(e){const{scaleRanges:i,sliderViewModel:t}=this;if(e!==void 0){const a=this.mapScaleToSlider(this._constrainMinScaleToLayer(i.clampMinScale(e)));t.values=[a,t.values[1]]}}_constrainMinScaleToLayer(e){const{scaleRanges:i}=this;if(this._hasTiledLayer()){const{firstRange:t}=i,a=this._getTiledLayerMinScale(),n=.85;e=this._mapToRange(e,t.maxScale,t.minScale,0,1)>n||e>a?a:e}return e}_constrainMaxScaleToLayer(e){if(this._hasTiledLayer()&&!this._getLayerResampling()){const i=this._getTiledLayerMaxScale();e=e<i?i:e}return e}_normalizeScale(e,i){const t=e==="max"?"maxScale":"minScale",a=this._hasTiledLayer()?e==="min"?this._getTiledLayerMinScale():this._getTiledLayerMaxScale():this.scaleRanges[t],n=this._hasTiledLayer()?e==="min"?this._getTiledLayerRealMinScale():this._getTiledLayerRealMaxScale():a,c=1e-6,u=i===0||n===i||Math.abs(n-i)<=c;return Number((u?0:i).toFixed(6))}_getLayerLODS(){var e,i,t,a;return!((e=this.layer)!=null&&e.loaded)||!("tileInfo"in this.layer)||((i=this.layer)==null?void 0:i.type)==="imagery-tile"&&((t=this.layer.raster)==null?void 0:t.tileType)==="Raster"?null:(a=this.layer.tileInfo)==null?void 0:a.lods}_getLayerResampling(){var e;return!!((e=this.layer)!=null&&e.loaded)&&(!("resampling"in this.layer)||this.layer.resampling)}_getTiledLayerMinScale(){const e=this._getLayerLODS();return this.scaleRanges.clampMinScale(e[0].scale)}_getTiledLayerMaxScale(){const e=this._getLayerLODS();return e[e.length-1].scale}_getTiledLayerRealMinScale(){var a,n;const e=this._getLayerLODS(),i=this.layer,t=i&&"sourceJSON"in i?((n=(a=i.sourceJSON)==null?void 0:a.tileInfo)==null?void 0:n.lods)??e:e;return this.scaleRanges.clampMinScale(t[0].scale)}_getTiledLayerRealMaxScale(){var a,n;const e=this._getLayerLODS(),i=this.layer,t=i&&"sourceJSON"in i?((n=(a=i.sourceJSON)==null?void 0:a.tileInfo)==null?void 0:n.lods)??e:e;return t[t.length-1].scale}_hasTiledLayer(){return!!this._getLayerLODS()}};s([r({readOnly:!0})],m.prototype,"effectiveMaxScale",null),s([r({readOnly:!0})],m.prototype,"effectiveMinScale",null),s([r()],m.prototype,"effectiveMaxScaleLimit",null),s([r()],m.prototype,"effectiveMinScaleLimit",null),s([r()],m.prototype,"layer",void 0),s([r()],m.prototype,"maxScale",null),s([r()],m.prototype,"maxScaleLimit",null),s([r()],m.prototype,"minScale",null),s([r()],m.prototype,"minScaleLimit",null),s([r()],m.prototype,"scaleRanges",void 0),s([r()],m.prototype,"sliderViewModel",void 0),s([r({readOnly:!0})],m.prototype,"state",null),s([r()],m.prototype,"view",null),m=s([$("esri.widgets.ScaleRangeSlider.ScaleRangeSliderViewModel")],m);const ne=m,T={preview:!0,scaleMenus:{maxScaleMenu:!0,minScaleMenu:!0}},se={maximumFractionDigits:0},E="1:",re=16;let o=class extends W{constructor(e,i){super(e,i),this._activeMenu=null,this._activeThumb=null,this._customInput=null,this._maxThumbNode=null,this._minThumbNode=null,this._previewAutoCloseTimeoutId=void 0,this._previewPopover=null,this._slider=new q({thumbCreatedFunction:(t,a,n)=>{t===0?this._minThumbNode=n:t===1&&(this._maxThumbNode=n),this.addHandles([V(n,"mouseenter",()=>{this._activeThumb=t,this.scheduleRender()}),V(n,"mouseleave",()=>{this._previewAutoCloseTimeoutId||(this._activeThumb=null,this.scheduleRender())})])}}),this.disabled=!1,this.messages=null,this.region="US",this.viewModel=new ne,this.visibleElements=T,this._afterInputNumberCreate=t=>{"value"in t&&t.value!=null&&"setNumberValue"in t&&t.setNumberValue({committing:!1,value:t.value,origin:"direct"}),this._customInput=t},this._handleCustomScaleInputChange=(t,a)=>{const{viewModel:{scaleRanges:n}}=this,c=Number.parseFloat(a.value);Number.isNaN(c)?a.value=t:this._setScale(n.clampScale(c))}}loadDependencies(){return G({button:()=>v(()=>import("./calcite-button-5457cec5.js"),["assets/calcite-button-5457cec5.js","assets/button-27a2f99e.js","assets/jsxFactory-92036771.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/uuid-709b6c67.js","assets/form-60623048.js","assets/interactive-39956fb6.js","assets/label2-0071fcd4.js","assets/loadable-7d42c3de.js","assets/locale-2cb18332.js","assets/key-c2c83cc7.js","assets/observers-9c654f26.js","assets/component-7281ffa6.js","assets/t9n-622f279b.js","assets/icon-c122f720.js","assets/loader-ea663d25.js","assets/guid-2347ca41.js"]),dropdown:()=>v(()=>import("./calcite-dropdown-772cccf6.js"),["assets/calcite-dropdown-772cccf6.js","assets/jsxFactory-92036771.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/uuid-709b6c67.js","assets/floating-ui-a6c9d5df.js","assets/debounce-7cc294e2.js","assets/guid-2347ca41.js","assets/interactive-39956fb6.js","assets/key-c2c83cc7.js","assets/loadable-7d42c3de.js","assets/observers-9c654f26.js","assets/openCloseComponent-3fbda1cf.js"]),"dropdown-group":()=>v(()=>import("./calcite-dropdown-group-67362aeb.js"),["assets/calcite-dropdown-group-67362aeb.js","assets/jsxFactory-92036771.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/uuid-709b6c67.js","assets/observers-9c654f26.js","assets/resources2-13ab706c.js"]),"dropdown-item":()=>v(()=>import("./calcite-dropdown-item-38ec91b4.js"),["assets/calcite-dropdown-item-38ec91b4.js","assets/jsxFactory-92036771.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/uuid-709b6c67.js","assets/resources2-13ab706c.js","assets/loadable-7d42c3de.js","assets/component-7281ffa6.js","assets/icon-c122f720.js","assets/observers-9c654f26.js"]),icon:()=>v(()=>import("./calcite-icon-39deb8ae.js"),["assets/calcite-icon-39deb8ae.js","assets/icon-c122f720.js","assets/jsxFactory-92036771.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/uuid-709b6c67.js","assets/observers-9c654f26.js"]),"input-number":()=>v(()=>import("./calcite-input-number-0916b1b5.js"),["assets/calcite-input-number-0916b1b5.js","assets/input-number-9c00b0ee.js","assets/jsxFactory-92036771.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/uuid-709b6c67.js","assets/form-60623048.js","assets/interactive-39956fb6.js","assets/key-c2c83cc7.js","assets/label2-0071fcd4.js","assets/loadable-7d42c3de.js","assets/locale-2cb18332.js","assets/observers-9c654f26.js","assets/t9n-622f279b.js","assets/component-7281ffa6.js","assets/icon-c122f720.js","assets/progress-2100df13.js"]),label:()=>v(()=>import("./calcite-label-4966fb24.js"),["assets/calcite-label-4966fb24.js","assets/label-fe92b4f9.js","assets/jsxFactory-92036771.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/uuid-709b6c67.js","assets/label2-0071fcd4.js"]),popover:()=>v(()=>import("./calcite-popover-c20a56ef.js"),["assets/calcite-popover-c20a56ef.js","assets/popover-33772892.js","assets/jsxFactory-92036771.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/uuid-709b6c67.js","assets/floating-ui-a6c9d5df.js","assets/debounce-7cc294e2.js","assets/Heading-2d7d203c.js","assets/guid-2347ca41.js","assets/openCloseComponent-3fbda1cf.js","assets/locale-2cb18332.js","assets/key-c2c83cc7.js","assets/observers-9c654f26.js","assets/t9n-622f279b.js","assets/loadable-7d42c3de.js","assets/FloatingArrow-9e5c8eb0.js","assets/component-7281ffa6.js","assets/action-79a6733c.js","assets/interactive-39956fb6.js","assets/icon-c122f720.js","assets/loader-ea663d25.js"])})}initialize(){this.addHandles([b(()=>this.viewModel,e=>this._slider.viewModel=(e==null?void 0:e.sliderViewModel)??null,I),b(()=>this._interactive,e=>{this._slider.disabled=!e,e||this._setActiveMenu(null)},I),this._slider.on("thumb-drag",({index:e})=>{this._activeThumb=e,clearTimeout(this._previewAutoCloseTimeoutId);const i=250;this._previewAutoCloseTimeoutId=setTimeout(()=>{this._previewAutoCloseTimeoutId=void 0,this._activeThumb=null},i)}),j(()=>{var e;return((e=this.view)==null?void 0:e.stationary)===!0},()=>this.scheduleRender())])}destroy(){this._slider=B(this._slider)}get _maxScaleMenuEnabled(){const{scaleMenus:e}=this.visibleElements;return e===!0||typeof e!="boolean"&&e.maxScaleMenu}get _minScaleMenuEnabled(){const{scaleMenus:e}=this.visibleElements;return e===!0||typeof e!="boolean"&&e.minScaleMenu}get _interactive(){var e;return((e=this.viewModel)==null?void 0:e.state)!=="disabled"&&!this.disabled}get effectiveMaxScale(){return this.viewModel.effectiveMaxScale}get effectiveMinScale(){return this.viewModel.effectiveMinScale}get effectiveMaxScaleLimit(){return this.viewModel.effectiveMaxScaleLimit}get effectiveMinScaleLimit(){return this.viewModel.effectiveMinScaleLimit}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}get maxScale(){return this.viewModel.maxScale}set maxScale(e){this.viewModel.maxScale=e}get maxScaleLimit(){return this.viewModel.maxScaleLimit}set maxScaleLimit(e){this.viewModel.maxScaleLimit=e}get minScale(){return this.viewModel.minScale}set minScale(e){this.viewModel.minScale=e}get minScaleLimit(){return this.viewModel.minScaleLimit}set minScaleLimit(e){this.viewModel.minScaleLimit=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}castVisibleElements(e){return{...T,...e,scaleMenus:typeof(e==null?void 0:e.scaleMenus)=="boolean"?e.scaleMenus:{...T.scaleMenus,...e==null?void 0:e.scaleMenus}}}formatScale(e){return`${E}${F(e,se)}`}render(){const{_interactive:e,_slider:i,label:t,messages:a,view:n,viewModel:{scaleRanges:c,state:u}}=this,S=a.scaleRangeLabels,g=S[c.findScaleRangeByIndex(i.values[0]).id],R=S[c.findScaleRangeByIndex(i.values[1]).id];return d("div",{"aria-label":t,class:this.classes(h.base,C.widget,e?null:C.disabled)},d("div",{class:h.scaleIndicatorWrapper,dir:"ltr"},u==="ready"&&n?this._renderCurrentScaleIndicator():null,i.render(),this._renderPreviewPopover()),d("div",{class:h.scaleMenuContainer},this._minScaleMenuEnabled?this._renderScaleMenuToggle("min",g):null,d("div",{class:h.scaleMenuSeparator}),this._maxScaleMenuEnabled?this._renderScaleMenuToggle("max",R):null))}_renderPreviewPopover(){const{_activeThumb:e}=this,i=e!=null&&this.visibleElements.preview,t=i?e===0?this._minThumbNode:this._maxThumbNode:"";return d("calcite-popover",{afterCreate:K,afterUpdate:()=>{var a;return(a=this._previewPopover)==null?void 0:a.reposition()},bind:this,"data-node-ref":"_previewPopover",label:this.messages.preview,offsetDistance:re,open:i,overlayPositioning:"fixed",placement:"top",referenceElement:t,triggerDisabled:!0},this._renderScalePreview())}_renderScalePreview(){const{_activeThumb:e,_slider:i,region:t,viewModel:{scaleRanges:a}}=this,n=e===0?i.values[0]:i.values[1],c=Object.keys(y.RecommendedScales).indexOf(a.findScaleRangeByIndex(n).id),u={backgroundImage:ie(t),backgroundPosition:te(c)};return d("div",{class:h.scalePreview},d("div",{class:h.scalePreviewThumbnail,styles:u}))}_renderScaleMenuToggle(e,i){const{_activeMenu:t,_interactive:a}=this,n=t===e;return[d("calcite-dropdown",{closeOnSelectDisabled:!0,open:n,overlayPositioning:"fixed",placement:e==="max"?"bottom-end":"bottom-start",scale:"s",onCalciteDropdownClose:({target:c})=>{this._activeMenu===e&&this._setActiveMenu(null),c.setFocus()},onCalciteDropdownOpen:()=>this._setActiveMenu(e)},d("calcite-button",{appearance:n?"outline":"transparent","aria-pressed":n.toString(),class:h.scaleMenuToggle,"data-type":e,disabled:!a,iconEnd:"chevron-down",scale:"s",slot:"trigger"},i),n&&e==="max"?this._renderMaxScaleMenu():null,n&&e==="min"?this._renderMinScaleMenu():null)]}_renderMinScaleMenu(){const{effectiveMaxScale:e,effectiveMinScaleLimit:i,view:t,viewModel:{scaleRanges:a}}=this,n=t?t.scale:void 0;return this._renderScaleMenu({type:"min",min:i,max:a.findScaleRange(e).minScale,viewScale:n})}_renderMaxScaleMenu(){const{effectiveMinScale:e,effectiveMaxScaleLimit:i,view:t,viewModel:{scaleRanges:a}}=this,n=t?t.scale:void 0;return this._renderScaleMenu({type:"max",min:a.findScaleRange(e).maxScale,max:i,viewScale:n})}_renderScaleMenu({viewScale:e,min:i,max:t,type:a}){const{effectiveMaxScale:n,effectiveMinScale:c,messages:u}=this,S=a==="max"?n:c,g=y.fromScaleRange({minScale:i,maxScale:t}),R=this.messages.featuredScaleLabels,x=y.RecommendedScales,D=Object.keys(x).filter(f=>g.contains(x[f])).map(f=>this._renderScaleMenuItem({scaleLabel:R[f],scaleValue:x[f],isSelected:S===x[f],valueVisible:f!=="world"}));return d("calcite-dropdown-group",{key:`${this.id}__scale-menu--${a}`},this._renderCustomScaleValue({currentScale:S}),e!=null?this._renderScaleMenuItem({scaleValue:e,scaleLabel:u.featuredScaleLabels.current,isSelected:S===e,valueVisible:!0}):null,D)}_renderCustomScaleValue({currentScale:e}){const{messages:i}=this,t=Math.round(e).toString();return d("calcite-dropdown-item",{afterCreate:a=>{a.setFocus()},key:"custom-scale",label:i.featuredScaleLabels.custom,onCalciteDropdownItemSelect:()=>{var a;(a=this._customInput)==null||a.setFocus()}},d("calcite-label",{scale:"s"},d("span",null,i.featuredScaleLabels.custom),d("calcite-input-number",{afterCreate:this._afterInputNumberCreate,groupSeparator:!0,inputMode:"numeric",max:y.RecommendedScales.world,min:0,numberButtonType:"none",placeholder:i.customScaleInputTooltip,prefixText:E,scale:"s",step:1,value:t,onCalciteInputNumberChange:({target:a})=>this._handleCustomScaleInputChange(t,a)})))}_renderScaleMenuItem(e){const{scaleValue:i,scaleLabel:t,valueVisible:a,isSelected:n}=e;return d("calcite-dropdown-item",{key:t,label:t,selected:n,onCalciteDropdownItemSelect:this._setScale.bind(this,i)},t,a?d("div",{class:h.scaleMenuSublabel},this.formatScale(i)):void 0)}_renderCurrentScaleIndicator(){const{_slider:e,messages:i,view:t,viewModel:{scaleRanges:a}}=this,n=a.clampScale(t.scale),c=this.viewModel.mapScaleToSlider(n),u=c/e.max,S=i.scaleRangeLabels[a.findScaleRangeByIndex(c).id],g=J(i.currentScaleTooltip,{scaleLabel:S});return d("div",{class:h.scaleIndicatorContainer,key:"scale-indicator"},d("div",{"aria-label":g,class:h.scaleIndicator,styles:{left:100*u+"%"},title:g},this.renderCurrentScaleIndicatorIcon()))}renderCurrentScaleIndicatorIcon(){return d("calcite-icon",{class:h.scaleIndicatorIcon,icon:"caret-up",scale:"s"})}_setScale(e){this._activeMenu==="max"?this.maxScale=Math.min(e,this.effectiveMinScale-1):this.minScale=Math.max(e,this.effectiveMaxScale+1),this._setActiveMenu(null)}_setActiveMenu(e){this._activeMenu=e}};s([r()],o.prototype,"_activeMenu",void 0),s([r()],o.prototype,"_activeThumb",void 0),s([r()],o.prototype,"_customInput",void 0),s([r()],o.prototype,"_maxScaleMenuEnabled",null),s([r()],o.prototype,"_minScaleMenuEnabled",null),s([r()],o.prototype,"_slider",void 0),s([r({readOnly:!0})],o.prototype,"_interactive",null),s([r()],o.prototype,"disabled",void 0),s([r()],o.prototype,"effectiveMaxScale",null),s([r()],o.prototype,"effectiveMinScale",null),s([r()],o.prototype,"effectiveMaxScaleLimit",null),s([r()],o.prototype,"effectiveMinScaleLimit",null),s([r()],o.prototype,"label",null),s([r()],o.prototype,"layer",null),s([r()],o.prototype,"maxScale",null),s([r()],o.prototype,"maxScaleLimit",null),s([r(),H("esri/widgets/ScaleRangeSlider/t9n/ScaleRangeSlider")],o.prototype,"messages",void 0),s([r()],o.prototype,"minScale",null),s([r()],o.prototype,"minScaleLimit",null),s([r()],o.prototype,"region",void 0),s([r()],o.prototype,"view",null),s([r()],o.prototype,"viewModel",void 0),s([r()],o.prototype,"visibleElements",void 0),s([z("visibleElements")],o.prototype,"castVisibleElements",null),o=s([$("esri.widgets.ScaleRangeSlider")],o);const Se=o;export{Se as default};
