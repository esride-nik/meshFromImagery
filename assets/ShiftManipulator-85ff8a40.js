import{gJ as G,mF as ye,k as Ze,fO as K,gH as Q,_ as Je,gE as we,fX as Ke,f5 as l,d8 as P,gA as We,fa as R,f6 as ee,d2 as m,d1 as f,nh as pe,i$ as j,gN as De,fK as F,f4 as Ge,fe as H,fC as C,fv as S,fk as w,ld as Qe,fY as le,f1 as et,lb as Fe,fw as tt,kH as rt,fM as st,k0 as it,fu as Ae,an as nt,cb as me,h3 as be,dA as E,db as M,kd as ot,kN as je,gO as at,gP as Ie,kK as X,aW as te,la as Ce,oA as Ee,fx as ce,iG as ve,mC as Me,oG as Pe}from"./index-b516d057.js";import{M as ct,$ as _e,D as dt,e as b,O as Be}from"./manipulatorUtils-9334c98f.js";import{F as lt,G as ut,q as gt,b as D,f as U,K as Re,L as ht}from"./RenderGeometry-5dbc1699.js";import{E as ft,d as $}from"./Material-5f4156ac.js";import{u as ie,t as _}from"./interfaces-0421c5e6.js";import{g as pt}from"./ImageMaterial-10c9471b.js";import{h as mt}from"./SlicePlane-40eedf78.js";import{H as bt,s as _t,W as qe,m as ue,d as $t,J as Tt}from"./boundedPlane-1da2f094.js";import{u as Ot,r as wt}from"./LineVisualElement-e3bb1937.js";import{a as At}from"./Object3DVisualElement-459b9b9c.js";import{o as It,d as Ct,z as Se,e as Et,i as vt,r as Mt,j as Pt,p as Rt,f as St,A as Nt,w as Lt}from"./DefaultTechniqueConfiguration-b4dbe32f.js";import{t as Ut}from"./ShaderTechniqueConfiguration-2502462e.js";import{o as Ne,n as xt}from"./interfaces-8918b36f.js";import{R as z,O as kt}from"./enums-bdecffa2.js";import{S as Ht,f as Vt,_ as yt}from"./OrderIndependentTransparency-755f7dcc.js";import{U as Xe}from"./RenderCoordsHelper-8f237859.js";import{p as Wt}from"./ray-8da55042.js";import{f as Y}from"./ColorMaterial-bdf1f62a.js";const Dt=G(0,0,0,.04);function Gt({accentColor:e}){return ye(e,.5)}function Ft({accentColor:e}){return ye(e,.7)}const Hr=Ze("mac")?"Meta":"Control",Vr="Shift",jt=2,Bt=1.15,qt=1.15,yr=2500,Wr=.02,Xt=Math.cos(K(45)),Le=Math.cos(K(5)),Dr=.95,Gr=.3,Fr=2,zt=1,Yt=3,ze=11,ge=22.5,J=40,Ue=48,Zt=2.25,Jt=4,xe=1,Kt=.3,Qt=6,er=4,ke=1600,tr=.4;function rr(e){const t=new It,{vertex:o,fragment:s,attributes:i,varyings:n}=t;return Ct(o,e),i.add(Q.POSITION,"vec3"),i.add(Q.UV0,"vec2"),n.add("vUV","vec2"),o.code.add(Ne`void main(void) {
vUV = uv0;
gl_Position = proj * view * vec4(position, 1.0);
}`),s.uniforms.add(new Se("backgroundColor",r=>r.backgroundColor),new Se("gridColor",r=>r.gridColor),new Et("gridWidth",r=>r.gridWidth)),s.code.add(Ne`void main() {
const float LINE_WIDTH = 1.0;
vec2 uvScaled = vUV * gridWidth;
vec2 gridUV = (fract(uvScaled + 0.5) - 0.5) / (LINE_WIDTH * fwidth(uvScaled));
vec2 grid = (1.0 - step(0.5, gridUV)) * step(-0.5, gridUV);
grid.x *= step(0.5, uvScaled.x) * step(uvScaled.x, gridWidth - 0.5);
grid.y *= step(0.5, uvScaled.y) * step(uvScaled.y, gridWidth - 0.5);
float gridFade = max(grid.x, grid.y);
float gridAlpha = gridColor.a * gridFade;
fragColor =
vec4(backgroundColor.rgb * backgroundColor.a, backgroundColor.a) * (1.0 - gridAlpha) +
vec4(gridColor.rgb, 1.0) * gridAlpha;
}`),t}const sr=Object.freeze(Object.defineProperty({__proto__:null,build:rr},Symbol.toStringTag,{value:"Module"}));class ir extends xt{constructor(){super(...arguments),this.backgroundColor=G(1,0,0,.5),this.gridColor=G(0,1,0,.5),this.gridWidth=4}}class ne extends Mt{initializeProgram(t){return new Pt(t.rctx,ne.shader.get().build(this.configuration),ft)}initializePipeline(){return Ht({blending:Vt(z.ONE,z.ONE,z.ONE_MINUS_SRC_ALPHA,z.ONE_MINUS_SRC_ALPHA),depthTest:{func:kt.LESS},colorWrite:yt})}}ne.shader=new vt(sr,()=>Je(()=>import("./SlicePlaneMaterial.glsl-1270aaf6.js"),["assets/SlicePlaneMaterial.glsl-1270aaf6.js","assets/index-b516d057.js","assets/index-b252abd2.css","assets/DefaultTechniqueConfiguration-b4dbe32f.js","assets/requestImageUtils-b142708c.js","assets/enums-bdecffa2.js","assets/Texture-bcb6d63f.js","assets/contextUtils-81fda295.js","assets/interfaces-8918b36f.js","assets/Material-5f4156ac.js","assets/ViewingMode-5d7d590b.js","assets/FramebufferObject-123b7c8d.js","assets/ShaderTechniqueConfiguration-2502462e.js","assets/manipulatorUtils-9334c98f.js","assets/interfaces-0421c5e6.js","assets/hydratedFeatures-2365c307.js","assets/dehydratedPoint-5a1dfed5.js","assets/ElevationProvider-abb53936.js","assets/ray-8da55042.js","assets/RenderGeometry-5dbc1699.js","assets/vec3f32-bac7ea57.js","assets/weather-2eb64924.js","assets/RenderState-1d6218ee.js","assets/NestedMap-1b5db22e.js","assets/frustum-f9d53cdf.js","assets/VertexElementDescriptor-2925c6af.js","assets/VertexArrayObject-d19dab8d.js","assets/Octree-7cea9440.js","assets/InterleavedLayout-d76b0d59.js","assets/types-1305598a.js","assets/OrderIndependentTransparency-755f7dcc.js","assets/floatRGBA-ca990bbb.js","assets/Intersector-2e1d9db3.js","assets/Intersector-fa865806.js","assets/boundedPlane-1da2f094.js","assets/verticalOffsetUtils-e5214af9.js","assets/orientedBoundingBox-67c5cd22.js","assets/glUtil-ce5ee52b.js","assets/Scheduler-ff5943a4.js","assets/signal-51ed66f5.js","assets/debugFlags-9a30f077.js","assets/ColorMaterial-bdf1f62a.js","assets/VerticalOffset.glsl-5743f98e.js","assets/ImageMaterial-10c9471b.js","assets/SlicePlane-40eedf78.js","assets/Cyclical-4c223a04.js","assets/persistable-a11ce298.js","assets/MD5-715f37cd.js","assets/multiOriginJSONSupportUtils-c978f4c3.js","assets/uuid-709b6c67.js","assets/resourceExtension-63924db9.js","assets/LineVisualElement-e3bb1937.js","assets/Object3DVisualElement-459b9b9c.js","assets/VisualElement-187372ae.js","assets/lineStippleUtils-0688e06c.js","assets/RenderCoordsHelper-8f237859.js","assets/projectVectorToDehydratedPoint-e30a7ff8.js","assets/projectVectorToPoint-fbaf5599.js","assets/projectVectorToVector-56c29b20.js","assets/coordinateSystem-38339d17.js"]));let nr=class extends lt{constructor(t){super(t,new ar),this._configuration=new Ut}createBufferWriter(){return new Rt(ut)}produces(t,o){return o===St.Color&&t===Nt.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL}createGLMaterial(t){return new or(t)}getConfiguration(){return this._configuration}};class or extends Lt{constructor(t){super(t),this.ensureTechnique(ne,null)}beginSlot(){return this.technique}}class ar extends ir{constructor(){super(...arguments),this.renderOccluded=$.Occlude,this.isDecoration=!1}}class cr extends At{constructor(t){super(t),this._material=null,this._renderOccluded=$.OccludeAndTransparent,this._gridWidth=1,this._gridColor=G(1,0,0,1),this._backgroundColor=G(1,0,0,1),this.applyProperties(t)}get renderOccluded(){return this._renderOccluded}set renderOccluded(t){t!==this._renderOccluded&&(this._renderOccluded=t,this._updateMaterial())}get gridWidth(){return this._gridWidth}set gridWidth(t){this._gridWidth!==t&&(this._gridWidth=t,this._updateMaterial())}get gridColor(){return this._gridColor}set gridColor(t){we(this._gridColor,t),this._updateMaterial()}get backgroundColor(){return this._backgroundColor}set backgroundColor(t){we(this._backgroundColor,t),this._updateMaterial()}createExternalResources(){this._material=new nr(this._materialParameters)}destroyExternalResources(){this._material=null}forEachExternalMaterial(t){this._material!=null&&t(this._material)}createGeometries(t){if(this._material!=null){const o=gt(this._material);t.addGeometry(o)}}get _materialParameters(){return{backgroundColor:this._backgroundColor,gridWidth:this._gridWidth,gridColor:this._gridColor,renderOccluded:this._renderOccluded,isDecoration:this.isDecoration}}_updateMaterial(){this._material!=null&&this._material.setParameters(this._materialParameters)}}function Br(e,t,o,s,i,n,r,a){return dr(t,r.worldUpAtPosition(e,l.get()),i,n,a.basis1,a.basis2),f(a.basis1,a.basis1,o),f(a.basis2,a.basis2,s),P(a.origin,e),Ge(a.basis2,a.basis1,a.origin,a.plane),a}function dr(e,t,o,s,i,n){const r=H(e,t),a=l.get(),u=l.get();switch(s===v.HORIZONTAL_OR_VERTICAL?Math.abs(r)>Xt?v.HORIZONTAL:v.VERTICAL:s){case v.VERTICAL:{const c=Math.abs(r)<=Le?e:o.viewUp;C(a,c,t),P(u,t);break}case v.HORIZONTAL:C(a,o.viewUp,t),C(u,t,a);break;case v.TILTED:{const c=Math.abs(r)<=Le?t:o.viewUp;C(a,c,e),C(u,e,a);break}}const d=C(l.get(),a,u);H(d,o.viewForward)>0&&f(u,u,-1),S(i,a),S(n,u)}function lr(e,t,o){const s=t.worldUpAtPosition(e.origin,l.get()),i=e.basis1,n=Oe(e,s),r=Math.round(n/V)*V;return ue(e,r-n,i,o)}function qr(e,t,o,s,i,n){const r=P(l.get(),i.origin);m(r,r,f(l.get(),i.basis1,e.direction[0]<0?1:-1)),m(r,r,f(l.get(),i.basis2,e.direction[1]<0?1:-1));const a=R(i.basis1),u=R(i.basis2),d=w(l.get(),o,r),c=w(l.get(),t,r);let g=0,h=0;if(Te(e)){const oe=he(i),y=he(n);g=a-.5*e.direction[0]*H(i.basis1,c)/a,h=u-.5*e.direction[1]*H(i.basis2,c)/u;const B=y/oe;g*=B,h*=B}const p=g+.5*e.direction[0]*H(i.basis1,d)/a,O=h+.5*e.direction[1]*H(i.basis2,d)/u,x=f(l.get(),i.basis1,p/a),N=f(l.get(),i.basis2,O/u);(p<=0||He(n.origin,x,s)<=ke)&&P(x,n.basis1),(O<=0||He(n.origin,N,s)<=ke)&&P(N,n.basis2);const T=P(l.get(),r);return m(T,T,f(l.get(),x,e.direction[0]<0?-1:1)),m(T,T,f(l.get(),N,e.direction[1]<0?-1:1)),bt(T,x,N,n)}function Xr(e,t){return tr*Math.min(t.width,t.height)*t.computeRenderPixelSizeAt(e)}function zr(e,t,o,s){const i=C(l.get(),t,o);return C(i,i,t),We(e,i,s)}function Yr(e,t){return ct(e.basis1,e.basis2,e.origin,t)}function Zr(e,t,o,s){const i=t.worldUpAtPosition(e.origin,l.get()),n=l.get();switch(o){case re.HEADING:P(n,i);break;case re.TILT:P(n,e.basis1)}return We(e.origin,n,s)}function Jr(e,t,o,s){const i=$e(o,A.NEGATIVE_X),n=j.get();Qe(n,t,i.edge*Math.PI/2);const r=S(l.get(),i.basis);let a=f(l.get(),r,i.direction*s.computeScreenPixelSizeAt(i.position)*J);m(a,a,i.position);const u=s.projectToRenderScreen(a,le(l.get())),d=ur(s,u);Wt(s,u,Z),S(Z.direction,Z.direction);const c=l.get();!d&&_t(o,Z,c)&&(a=c),n[12]=0,n[13]=0,n[14]=0,e.modelTransform=n,e.renderLocation=et(a),d?e.state|=se:e.state&=~se}function ur(e,t){const[o,s,i,n]=e.viewport,r=Math.min(i,n)/16;let a=!0;return t[0]<o+r?(t[0]=o+r,a=!1):t[0]>o+i-r&&(t[0]=o+i-r,a=!1),t[1]<s+r?(t[1]=s+r,a=!1):t[1]>s+n-r&&(t[1]=s+n-r,a=!1),a}function Kr(e,t,o,s){const i=R(s.basis1),n=R(s.basis2),r=Ye(s),a=he(s),u=ee(l.get(),0,0,0);m(u,f(l.get(),s.basis1,t.direction[0]),f(l.get(),s.basis2,t.direction[1])),m(u,s.origin,u);let d=0,c=1;if(Te(t))t.direction[0]===1&&t.direction[1]===-1?d=V:t.direction[0]===1&&t.direction[1]===1?d=Math.PI:t.direction[0]===-1&&t.direction[1]===1&&(d=3*Math.PI/2),c=a;else{const h=t.direction[0]!==0?1:2;d=h===1?V:0,c=(h===1?n:i)-r}const g=pe(j.get(),d);De(g,g,ee(l.get(),c,c,c)),F(g,o,g),g[12]=0,g[13]=0,g[14]=0,e.modelTransform=g,e.renderLocation=u}function Qr(e,t,o,s){const i=s.worldUpAtPosition(o.origin,l.get()),n=$e(o,A.POSITIVE_X),r=pe(j.get(),n.edge*Math.PI/2);Fe(r,r,-Oe(o,i)),F(r,t,r),r[12]=0,r[13]=0,r[14]=0,e.modelTransform=r,e.renderLocation=n.position}function es(e,t,o){const s=$e(o,A.POSITIVE_Y),i=pe(j.get(),s.edge*Math.PI/2);Fe(i,i,V),F(i,t,i),i[12]=0,i[13]=0,i[14]=0,e.modelTransform=i,e.renderLocation=s.position}var A;function $e(e,t){switch(t){case A.POSITIVE_X:return{basis:e.basis1,direction:1,position:m(l.get(),e.origin,e.basis1),edge:t};case A.POSITIVE_Y:return{basis:e.basis2,direction:1,position:m(l.get(),e.origin,e.basis2),edge:t};case A.NEGATIVE_X:return{basis:e.basis1,direction:-1,position:w(l.get(),e.origin,e.basis1),edge:t};case A.NEGATIVE_Y:return{basis:e.basis2,direction:-1,position:w(l.get(),e.origin,e.basis2),edge:t}}}function He(e,t,o){const s=o.projectToRenderScreen(m(l.get(),e,t),le(l.get())),i=o.projectToRenderScreen(w(l.get(),e,t),le(l.get()));return tt(w(s,s,i))}function Ye(e){const t=R(e.basis1),o=R(e.basis2);return Kt*Math.min(t,o)}function he(e){return Ye(e)}function Te(e){return e.direction[0]!==0&&e.direction[1]!==0}function ts(e){const t=[[-1,-1,0],[1,-1,0],[1,1,0],[-1,1,0],[-1,-1,0]];return new Ot({view:e,attached:!1,color:Ft(e.effectiveTheme),width:zt,renderOccluded:$.OccludeAndTransparent,geometry:[t],isDecoration:!0})}function rs(e){return new cr({view:e,attached:!1,backgroundColor:Dt,gridColor:Gt(e.effectiveTheme),gridWidth:4,renderOccluded:$.OccludeAndTransparent,isDecoration:!0})}function ss(e,t,o,s=new mt){if(e==null)return null;const{renderCoordsHelper:i}=t,n=i.fromRenderCoords(e.origin,t.spatialReference);if(n==null)return null;const r=rt(n,o);if(r==null)return null;s.position=r;const a=2*R(e.basis1),u=2*R(e.basis2),d=Xe.renderUnitScaleFactor(t.spatialReference,o);s.width=a*d,s.height=u*d;const c=i.worldUpAtPosition(e.origin,l.get());return s.tilt=st(Oe(e,c)),s.heading=i.headingAtPosition(e.origin,e.basis1)-90,s}function Oe(e,t){return it(t,e.basis2,e.basis1)+V}function gr(e,t,o,s,i,n,r=qe()){return n.toRenderCoords(e,r.origin)?(n.worldBasisAtPosition(r.origin,Ae.X,r.basis1),n.worldBasisAtPosition(r.origin,Ae.Y,r.basis2),Ge(r.basis2,r.basis1,r.origin,r.plane),ue(r,-K(t),$t(r),r),ue(r,K(o),r.basis1,r),f(r.basis1,r.basis1,s/2),f(r.basis2,r.basis2,i/2),Tt(r),r):(nt.getLogger("esri.views.3d.analysis.Slice.sliceToolUtils").error(`Failed to project slice plane position, projection from ${e.spatialReference.wkid} is not supported`),null)}function is(e,t){if((e==null?void 0:e.position)==null)return null;const o=wt(e.position,t.spatialReference,t.elevationProvider);if(o==null)return null;const s=Xe.renderUnitScaleFactor(e.position.spatialReference,t.spatialReference),i=e.width*s,n=e.height*s;return{position:o,heading:e.heading,tilt:e.tilt,renderWidth:i,renderHeight:n}}function ns(e,t,o,s=qe()){if(e==null)return null;const i=gr(e.position,e.heading,e.tilt,e.renderWidth,e.renderHeight,t.renderCoordsHelper,s);return o.tiltEnabled||i==null||lr(i,t.renderCoordsHelper,i),i}(function(e){e[e.POSITIVE_X=0]="POSITIVE_X",e[e.POSITIVE_Y=1]="POSITIVE_Y",e[e.NEGATIVE_X=2]="NEGATIVE_X",e[e.NEGATIVE_Y=3]="NEGATIVE_Y"})(A||(A={}));const I=ie.Custom1;var re,v;(function(e){e[e.HEADING=1]="HEADING",e[e.TILT=2]="TILT"})(re||(re={})),function(e){e[e.HORIZONTAL_OR_VERTICAL=0]="HORIZONTAL_OR_VERTICAL",e[e.HORIZONTAL=1]="HORIZONTAL",e[e.VERTICAL=2]="VERTICAL",e[e.TILTED=3]="TILTED"}(v||(v={}));const se=ie.Custom2,Z=Ke(),V=Math.PI/2,de=ie.Custom1,hr=ie.Custom2;function os(e){return(e.type==="building-scene-3d"?e:null)!=null}class as extends _e{constructor(t,o){const s=Te(o),i=s?Jt:xe,n=i*jt,r=xe,a={renderOccluded:$.OccludeAndTransparent,isDecoration:!0},u=new D({...a,width:i}),d=new D({...a,width:n}),c=new D({...a,width:r});super({view:t,...dt,...fr({isCorner:s,unfocusedMaterial:u,focusedMaterial:d,outlineMaterial:c})}),this._themeHandle=me(()=>t.effectiveTheme.accentColor,g=>{const h=E.toUnitRGBA(g);u.setParameters({color:h}),d.setParameters({color:h}),c.setParameters({color:h})},be)}destroy(){this._themeHandle.remove(),super.destroy()}}function fr({isCorner:e,unfocusedMaterial:t,focusedMaterial:o,outlineMaterial:s}){const i=e?[M(1,0,0),M(0,0,0),M(0,1,0)]:[M(1,0,0),M(-1,0,0)];return{renderObjects:[new b(U(t,i),_.Unfocused|de),new b(U(o,i),_.Focused|de),new b(U(s,i),hr)],collisionType:{type:"line",paths:[i]},radius:e?Qt:er,state:de}}class cs extends _e{constructor(t,o){const s=new pt({transparent:!0,writeDepth:!1,renderOccluded:$.Opaque,isDecoration:!0}),i=Be.calloutWidth,n=new D({width:i,renderOccluded:$.OccludeAndTransparent,isDecoration:!0});super({view:t,...pr({imageMaterial:s,calloutMaterial:n})}),this._currentTexture=null,this._themeHandle=me(()=>t.effectiveTheme.accentColor,r=>{const a=ot(r,.5),u=je(r),d=this._currentTexture,c=o(a,u);s.setParameters({textureId:c.texture.id}),n.setParameters({color:E.toUnitRGBA(r)}),this._currentTexture=c,d==null||d.release()},be)}destroy(){var t;this._themeHandle.remove(),(t=this._currentTexture)==null||t.release(),super.destroy()}}function pr({imageMaterial:e,calloutMaterial:t}){const{focusMultiplier:o,calloutLength:s,discRadius:i}=Be,n=i*o,r=(c,g)=>{const h=[0,1,2,2,3,0];return new at(g,[[Q.POSITION,new Ie([s-c,-c,0,s+c,-c,0,s+c,c,0,s-c,c,0],h,3,!0)],[Q.UV0,new Ie([0,0,1,0,1,1,0,1],h,2,!0)]])},a=U(t,[[0,0,0],[s-i,0,0]]),u=U(t,[[0,0,0],[s-n,0,0]]),d=I;return{autoScaleRenderObjects:!1,collisionPriority:1,collisionType:{type:"disc",direction:[0,0,1],offset:[s,0,0]},focusMultiplier:o,radius:i,renderObjects:[new b(r(i,e),_.Unfocused|d),new b(a,_.Unfocused|d),new b(r(n,e),_.Focused|d),new b(u,_.Focused|d)],state:d}}var fe;(function(e){e[e.CENTER_ON_CALLOUT=0]="CENTER_ON_CALLOUT",e[e.CENTER_ON_ARROW=1]="CENTER_ON_ARROW"})(fe||(fe={}));class ds extends _e{constructor(t,o){const s=new D({width:1,renderOccluded:$.OccludeAndTransparent,isDecoration:!0}),i=new Y({cullFace:X.Back,renderOccluded:$.Opaque,isDecoration:!0}),n=new Y({cullFace:X.Back,renderOccluded:$.Opaque,isDecoration:!0}),r=new Y({cullFace:X.Back,renderOccluded:$.Opaque,isDecoration:!0}),a=new Y({writeDepth:!1,cullFace:X.Front,renderOccluded:$.Transparent,isDecoration:!0});super({view:t,...mr({offsetMode:o,tubeMaterial:i,tipMaterial:n,capMaterial:r,outlineMaterial:a,calloutMaterial:s})}),this._themeHandle=me(()=>t.effectiveTheme.accentColor,u=>{const d=je(u),c=E.toUnitRGBA(u),g=E.toUnitRGBA(d),h=E.toUnitRGBA(E.blendColors(d,u,.4)),p=E.toUnitRGBA(E.blendColors(d,u,.14));s.setParameters({color:c}),i.setParameters({color:p}),n.setParameters({color:g}),r.setParameters({color:h}),a.setParameters({color:c})},be)}destroy(){this._themeHandle.remove(),super.destroy()}}function mr({offsetMode:e,tubeMaterial:t,tipMaterial:o,capMaterial:s,outlineMaterial:i,calloutMaterial:n}){const r=e===fe.CENTER_ON_CALLOUT?J:0,a=[M(r,0,-Ue/2),M(r,0,Ue/2)],u=_r(a,!0),d=Ve({vertices:a,padding:0,materials:{tube:t,tip:o,cap:s}}),c=Ve({vertices:a,padding:Zt,materials:{tube:i,tip:i,cap:i}}),g=U(n,[[r,0,0],[r-J,0,0]]),h=U(n,[[r,0,0],[r-J,0,0]]);return{renderObjects:[...d.normal.map(p=>new b(p,_.Unfocused|I)),...c.normal.map(p=>new b(p,_.Unfocused|I)),new b(g,_.Unfocused|I|se),...d.focused.map(p=>new b(p,_.Focused|I)),...c.focused.map(p=>new b(p,_.Focused|I)),new b(h,_.Focused|I|se)],autoScaleRenderObjects:!1,collisionType:{type:"line",paths:[u]},collisionPriority:1,radius:ze,state:I}}function Ve({vertices:e,padding:t,materials:o}){const s=i=>{const n=e.slice(0),r=w(l.get(),n[0],n[1]);S(r,r);const a=w(l.get(),n[n.length-1],n[n.length-2]);if(S(a,a),t>0){const W=f(te(),a,-t);n[n.length-1]=m(W,W,n[n.length-1]);const k=f(te(),r,-t);n[0]=m(k,k,n[0])}const u=i?qt:1,d=ge*u,c=ze*u,g=Ce(j.get());if(t>0){const W=d/4,k=ee(l.get(),0,W,0),q=1+t/W;Ee(g,g,k),De(g,g,ee(l.get(),q,q,q)),Ee(g,g,f(k,k,-1/q))}const h=Ce(ce()),p=M(0,1,0),O=ve(ce(),Me(Pe.get(),p,a));O[12]=n[n.length-1][0],O[13]=n[n.length-1][1],O[14]=n[n.length-1][2],F(O,O,g);const x=o.tube,N=br(Yt*(i?Bt:1)+t,n,x);N.transformation=h;const T=[N],oe=o.tip,y=Re(oe,d,c,24,!1,!1,!0);y.transformation=O,T.push(y);const B=o.cap,ae=Re(B,d,c,24,!1,!0,!1);ae.transformation=O,T.push(ae);const L=ve(ce(),Me(Pe.get(),p,r));return L[12]=n[0][0],L[13]=n[0][1],L[14]=n[0][2],F(L,L,g),T.push(y.instantiate({transformation:L})),T.push(ae.instantiate({transformation:L})),T};return{normal:s(!1),focused:s(!0)}}function br(e,t,o){const s=[];for(let n=0;n<12;n++){const r=n/12*2*Math.PI;s.push([Math.cos(r)*e,Math.sin(r)*e])}return ht(o,s,t,[],[],!1)}function _r(e,t){const o=w(te(),e[e.length-1],e[e.length-2]);if(S(o,o),f(o,o,ge),m(o,o,e[e.length-1]),t){const s=w(te(),e[0],e[1]);return S(s,s),f(s,s,ge),m(s,s,e[0]),[s,...e,o]}return[...e,o]}export{rs as A,Te as B,re as C,he as D,ts as E,hr as F,fe as H,ds as I,Fr as M,de as N,is as P,os as U,I as V,v as _,as as a,Hr as b,Zr as c,Br as d,Yr as e,Qr as f,cs as g,es as h,Kr as i,ss as j,Dt as k,Jr as l,yr as m,Ft as n,qr as o,zr as p,Dr as q,Vr as r,Xr as s,rr as t,Gr as u,ns as v,Wr as w,Gt as x,zt as y,se as z};
