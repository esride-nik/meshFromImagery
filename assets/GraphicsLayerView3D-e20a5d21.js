import{cc as n,b9 as l,s as c,a5 as o,a6 as s,a9 as h}from"./index-b516d057.js";import{n as u}from"./LayerView3D-c03d44fc.js";import{c as d,r as g}from"./queryForSymbologySnapping-caae9522.js";import{O as y}from"./GraphicsProcessor-c903d185.js";import{l as f}from"./projectExtentUtils-15e84132.js";import{C as b}from"./RenderGeometry-5dbc1699.js";import{u as v}from"./LayerView-060b46d4.js";import"./heightModelInfoUtils-0dd2b6e4.js";import"./HeightModelInfo-b816d32b.js";import"./projectPointToVectorWithEngine-f608a34a.js";import"./dehydratedPoint-5a1dfed5.js";import"./elevationInfoUtils-be36d866.js";import"./UpdatingHandles-7949a657.js";import"./hydratedFeatures-2365c307.js";import"./ElevationQuery-a3eaf0a0.js";import"./vec2f32-eaf29605.js";import"./InterleavedLayout-d76b0d59.js";import"./types-1305598a.js";import"./DefaultTechniqueConfiguration-b4dbe32f.js";import"./requestImageUtils-b142708c.js";import"./enums-bdecffa2.js";import"./Texture-bcb6d63f.js";import"./contextUtils-81fda295.js";import"./interfaces-8918b36f.js";import"./Material-5f4156ac.js";import"./ViewingMode-5d7d590b.js";import"./FramebufferObject-123b7c8d.js";import"./ShaderTechniqueConfiguration-2502462e.js";import"./ColorMaterial-bdf1f62a.js";import"./VerticalOffset.glsl-5743f98e.js";import"./OrderIndependentTransparency-755f7dcc.js";import"./dehydratedFeatures-2a3f0608.js";import"./quantizationUtils-17105106.js";import"./featureConversionUtils-09cf00ff.js";import"./OptimizedFeature-e90b69df.js";import"./OptimizedFeatureSet-1d1ac4b9.js";import"./OptimizedGeometry-196224d4.js";import"./edgeUtils-6e4a97fb.js";import"./SnappingCandidate-970faec6.js";import"./ElevationProvider-abb53936.js";import"./objectResourceUtils-003803db.js";import"./devEnvironmentUtils-4eab2a99.js";import"./DefaultMaterial_COLOR_GAMMA-101ea40c.js";import"./Version-1f969b2a.js";import"./resourceUtils-1d03d2fe.js";import"./mat3f32-6c416b1c.js";import"./NestedMap-1b5db22e.js";import"./verticalOffsetUtils-e5214af9.js";import"./orientedBoundingBox-67c5cd22.js";import"./symbolColorUtils-3ca646c8.js";import"./RenderState-1d6218ee.js";import"./callExpressionWithFeature-36423058.js";import"./lineStippleUtils-0688e06c.js";import"./projectVectorToDehydratedPoint-e30a7ff8.js";import"./interfaces-1a80c8eb.js";import"./frustum-f9d53cdf.js";import"./webStyleSymbolUtils-4761c8f2.js";import"./glUtil-ce5ee52b.js";import"./VertexElementDescriptor-2925c6af.js";import"./Intersector-fa865806.js";import"./boundedPlane-1da2f094.js";import"./Octree-7cea9440.js";import"./Intersector-a291e778.js";import"./Scheduler-ff5943a4.js";import"./signal-51ed66f5.js";import"./debugFlags-9a30f077.js";import"./fontUtils-56b88a2f.js";import"./projectVectorToVector-56c29b20.js";import"./Query-071039d7.js";import"./FullTextSearch-12e0754c.js";import"./QuantizationParameters-f983cf8d.js";import"./Graphics3DObjectStates-511adea3.js";import"./jsonUtils-52514725.js";import"./DictionaryLoader-e327eff9.js";import"./FieldsIndex-e8db657f.js";import"./UnknownTimeZone-a05df022.js";import"./HeatmapColorStop-3fff4333.js";import"./heatmapUtils-7f42325f.js";import"./rendererConversion-b2429202.js";import"./basemapUtils-6ec10a55.js";import"./Basemap-8d62c69e.js";import"./loadAll-5e767cfa.js";import"./writeUtils-e226a8aa.js";import"./defaults-4faa92e6.js";import"./defaultsJSON-59981e75.js";import"./optimizedFeatureQueryEngineAdapter-1fecea41.js";import"./PooledRBush-fa11eac4.js";import"./quickselect-bc0541de.js";import"./screenUtils-8dc4a7f9.js";import"./popupUtils-e4ebc84a.js";import"./layerViewUtils-6ebe90f4.js";import"./geometryServiceUtils-3e048225.js";import"./project-1bd91657.js";import"./vec3f32-bac7ea57.js";import"./weather-2eb64924.js";import"./VertexArrayObject-d19dab8d.js";import"./floatRGBA-ca990bbb.js";import"./Intersector-2e1d9db3.js";let e=class extends u(v){constructor(){super(...arguments),this.type="graphics-3d",this.symbologySnappingSupported=!0,this._slicePlaneEnabled=!1,this.fullExtentInLocalViewSpatialReference=null,this.ignoresMemoryFactor=!0}initialize(){this._set("processor",new y({owner:this,scaleVisibilityEnabled:!0,frustumVisibilityEnabled:!0})),this.addResolvingPromise(this.processor.initializePromise),this.addHandles(this.layer.on("graphic-update",r=>this.processor.graphicsCore.graphicUpdateHandler(r))),this.addResolvingPromise(f(this).then(r=>this.fullExtentInLocalViewSpatialReference=r)),this.layer.internal?this.notifyChange("updating"):this.addHandles(n(()=>{var r,i;return(i=(r=this.view)==null?void 0:r.basemapTerrain)==null?void 0:i.ready},()=>()=>this.notifyChange("updating"),{once:!0}))}destroy(){this._updatingHandles.removeAll(),this._set("processor",l(this.processor))}get loadedGraphics(){return this.layer.graphics}get legendEnabled(){var r;return this.canResume()&&!((r=this.processor)!=null&&r.frustumVisibilitySuspended)}get slicePlaneEnabled(){const r=this.layer.internal;return this._slicePlaneEnabled&&!r}set slicePlaneEnabled(r){this._slicePlaneEnabled=r}getSuspendInfo(){var i,t;const r=super.getSuspendInfo();return r.outsideScaleRange=((i=this.processor)==null?void 0:i.scaleVisibilitySuspended)??!1,r.outsideOfView=((t=this.processor)==null?void 0:t.frustumVisibilitySuspended)??!1,r}async fetchPopupFeatures(r,i){return(i==null?void 0:i.clientGraphics)??[]}getHit(r){return this.processor.getHit(r)}whenGraphicBounds(r,i){return this.processor.whenGraphicBounds(r,i)}computeAttachmentOrigin(r,i){var t;return(t=this.processor)==null?void 0:t.computeAttachmentOrigin(r,i)}getSymbolLayerSize(r,i){return this.processor.getSymbolLayerSize(r,i)}queryGraphics(){return Promise.resolve(this.loadedGraphics)}maskOccludee(r){return this.processor.maskOccludee(r)}highlight(r){return this.processor.highlight(r)}async elevationAlignPointsInFeatures(r,i){const{processor:t}=this;if((t==null?void 0:t.graphics3DGraphics)==null)throw new c("graphicslayerview3d:missing-processor","A Graphics3D processor is needed to resolve graphics elevation.");const{graphics3DGraphics:a}=t,m=p=>typeof p=="number"?a.get(p):void 0;return d(this.view,this.layer,m,r,i)}async queryForSymbologySnapping(r,i){return g(this.processor,r,i)}get updatePolicy(){var r;return((r=this.processor)==null?void 0:r.graphicsCore.effectiveUpdatePolicy)||b.SYNC}canResume(){var r;return super.canResume()&&!((r=this.processor)!=null&&r.scaleVisibilitySuspended)}isUpdating(){var r,i;return this.view&&this.layer&&!(!((r=this.processor)!=null&&r.updating)&&(this.layer.internal||(i=this.view.basemapTerrain)!=null&&i.ready))}get performanceInfo(){var r,i;return{displayedNumberOfFeatures:this.loadedGraphics.length,maximumNumberOfFeatures:-1,totalNumberOfFeatures:-1,nodes:0,core:null,updating:this.updating,elevationUpdating:((r=this.processor)==null?void 0:r.elevationAlignment.updating)??!1,visibilityFrustum:!((i=this.processor)!=null&&i.frustumVisibilitySuspended)}}get usedMemory(){var r,i;return((i=(r=this.processor)==null?void 0:r.graphicsCore)==null?void 0:i.usedMemory)??0}get unloadedMemory(){var r,i;return(i=(r=this.processor)==null?void 0:r.graphicsCore)==null?void 0:i.unprocessedMemoryEstimate}};o([s()],e.prototype,"loadedGraphics",null),o([s({readOnly:!0})],e.prototype,"legendEnabled",null),o([s()],e.prototype,"layer",void 0),o([s({readOnly:!0})],e.prototype,"processor",void 0),o([s()],e.prototype,"_slicePlaneEnabled",void 0),o([s({type:Boolean})],e.prototype,"slicePlaneEnabled",null),e=o([h("esri.views.3d.layers.GraphicsLayerView3D")],e);const li=e;export{li as default};
